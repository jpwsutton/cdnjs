!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.maquette={})}(this,function(e){"use strict";var v,r="http://www.w3.org/",x=r+"2000/svg",S=r+"1999/xlink",h=[],u=function(r,t){var n={};return Object.keys(r).forEach(function(e){n[e]=r[e]}),t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),n},m=function(e,r){return e.vnodeSelector===r.vnodeSelector&&(e.properties&&r.properties?e.properties.key===r.properties.key&&e.properties.bind===r.properties.bind:!e.properties&&!r.properties)},k=function(e){if("string"!=typeof e)throw Error("Style values must be strings")},g=function(e,r,t){if(""!==r.vnodeSelector)for(var n=t;n<e.length;n++)if(m(e[n],r))return n;return-1},y=function(e,r,t,n){var o=e[r];if(""!==o.vnodeSelector){var i=o.properties;if(!(i?void 0===i.key?i.bind:i.key:void 0))for(var d=0;d<e.length;d++)if(d!==r){var a=e[d];if(m(a,o))throw Error(t.vnodeSelector+" had a "+o.vnodeSelector+" child "+("added"===n?n:"removed")+", but there is now more than one. You must add unique key properties to make them distinguishable.")}}},N=function(e){if(e.properties){var r=e.properties.enterAnimation;r&&r(e.domNode,e.properties)}},t=[],n=!1,o=function(e){(e.children||[]).forEach(o),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.call(e.properties.bind||e.properties,e.domNode)},i=function(){n=!1,t.forEach(o),t.length=0},d=function(e){t.push(e),n||(n=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(i,{timeout:16}):setTimeout(i,16))},b=function(e){var r=e.domNode;if(e.properties){var t=e.properties.exitAnimation;if(t)return r.style.pointerEvents="none",void t(r,function(){r.parentNode&&(r.parentNode.removeChild(r),d(e))},e.properties)}r.parentNode&&(r.parentNode.removeChild(r),d(e))},l=function(e,r,t){!function(e,r,t){if(r)for(var n=0,o=r;n<o.length;n++){var i=o[n];A(i,e,void 0,t)}}(e,r.children,t),r.text&&(e.textContent=r.text),function(l,v,h){if(v)for(var m=h.eventHandlerInterceptor,g=Object.keys(v),e=g.length,r=function(e){var r,t=g[e],n=v[t];if("className"===t)throw Error('Property "className" is not supported, use "class".');if("class"===t)n.split(/\s+/).forEach(function(e){return l.classList.add(e)});else if("classes"===t)for(var o=Object.keys(n),i=o.length,d=0;d<i;d++){var a=o[d];n[a]&&l.classList.add(a)}else if("styles"===t){var s=Object.keys(n),p=s.length;for(d=0;d<p;d++){var c=s[d],f=n[c];f&&(k(f),h.styleApplyer(l,c,f))}}else if("key"!==t&&null!=n){var u=typeof n;"function"===u?0===t.lastIndexOf("on",0)&&(m&&(n=m(t,n,l,v)),"oninput"===t&&(r=n,n=function(e){r.call(this,e),e.target["oninput-value"]=e.target.value}),l[t]=n):h.namespace===x?"href"===t?l.setAttributeNS(S,t,n):l.setAttribute(t,n):"string"===u&&"value"!==t&&"innerHTML"!==t?l.setAttribute(t,n):l[t]=n}},t=0;t<e;t++)r(t)}(e,r.properties,t),r.properties&&r.properties.afterCreate&&r.properties.afterCreate.call(r.properties.bind||r.properties,e,t,r.vnodeSelector,r.properties,r.children)},A=function(e,r,t,n){var o,i=0,d=e.vnodeSelector,a=r.ownerDocument;if(""===d)o=e.domNode=a.createTextNode(e.text),void 0!==t?r.insertBefore(o,t):r.appendChild(o);else{for(var s=0;s<=d.length;++s){var p=d.charAt(s);if(s===d.length||"."===p||"#"===p){var c=d.charAt(i-1),f=d.slice(i,s);"."===c?o.classList.add(f):"#"===c?o.id=f:("svg"===f&&(n=u(n,{namespace:x})),void 0!==n.namespace?o=e.domNode=a.createElementNS(n.namespace,f):(o=e.domNode=e.domNode||a.createElement(f),"input"===f&&e.properties&&void 0!==e.properties.type&&o.setAttribute("type",e.properties.type)),void 0!==t?r.insertBefore(o,t):o.parentNode!==r&&r.appendChild(o)),i=s+1}}l(o,e,n)}},E=function(r,e,t){e&&e.split(" ").forEach(function(e){return r.classList.toggle(e,t)})};v=function(e,r,t){var n=e.domNode;if(e===r)return!1;var o=!1;if(""===r.vnodeSelector){if(r.text!==e.text){var i=n.ownerDocument.createTextNode(r.text);return n.parentNode.replaceChild(i,n),r.domNode=i,!0}r.domNode=n}else 0===r.vnodeSelector.lastIndexOf("svg",0)&&(t=u(t,{namespace:x})),e.text!==r.text&&(o=!0,void 0===r.text?n.removeChild(n.firstChild):n.textContent=r.text),r.domNode=n,o=function(e,r,t,n,o){if(t===n)return!1;n=n||h;for(var i,d=(t=t||h).length,a=n.length,s=0,p=0,c=!1;p<a;){var f=s<d?t[s]:void 0,u=n[p];if(void 0!==f&&m(f,u))c=v(f,u,o)||c,s++;else{var l=g(t,u,s+1);if(l<0)A(u,r,s<d?t[s].domNode:void 0,o),N(u),y(n,p,e,"added");else{for(i=s;i<l;i++)b(t[i]),y(t,i,e,"removed");c=v(t[l],u,o)||c,s=l+1}}p++}if(s<d)for(i=s;i<d;i++)b(t[i]),y(t,i,e,"removed");return c}(r,n,e.children,r.children,t)||o,o=function(e,r,t,n){if(t){for(var o=!1,i=Object.keys(t),d=i.length,a=0;a<d;a++){var s=i[a],p=t[s],c=r[s];if("class"===s)c!==p&&(E(e,c,!1),E(e,p,!0));else if("classes"===s)for(var f=e.classList,u=Object.keys(p),l=u.length,v=0;v<l;v++){var h=u[v],m=!!p[h];m!==!!c[h]&&(o=!0,m?f.add(h):f.remove(h))}else if("styles"===s){var g=Object.keys(p),y=g.length;for(v=0;v<y;v++){var N=g[v],b=p[N];b!==c[N]&&(o=!0,b?(k(b),n.styleApplyer(e,N,b)):n.styleApplyer(e,N,""))}}else if(p||"string"!=typeof c||(p=""),"value"===s){var A=e[s];A!==p&&(e["oninput-value"]?A===e["oninput-value"]:p!==c)&&(e[s]=p,e["oninput-value"]=void 0),p!==c&&(o=!0)}else if(p!==c){var w=typeof p;"function"===w&&n.eventHandlerInterceptor||(n.namespace===x?"href"===s?e.setAttributeNS(S,s,p):e.setAttribute(s,p):"string"===w&&"innerHTML"!==s?"role"===s&&""===p?e.removeAttribute(s):e.setAttribute(s,p):e[s]!==p&&(e[s]=p),o=!0)}}return o}}(n,e.properties,r.properties,t)||o,r.properties&&r.properties.afterUpdate&&r.properties.afterUpdate.call(r.properties.bind||r.properties,n,t,r.vnodeSelector,r.properties,r.children);return o&&r.properties&&r.properties.updateAnimation&&r.properties.updateAnimation(n,r.properties,e.properties),!1};var w,a=function(r,t){return{getLastRender:function(){return r},update:function(e){if(r.vnodeSelector!==e.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");v(r,r=e,t)},domNode:r.domNode}},s={namespace:void 0,performanceLogger:function(){},eventHandlerInterceptor:void 0,styleApplyer:function(e,r,t){e.style[r]=t}},p=function(e){return u(s,e)},C={create:function(e,r){return r=p(r),A(e,document.createElement("div"),void 0,r),a(e,r)},append:function(e,r,t){return t=p(t),A(r,e,void 0,t),a(r,t)},insertBefore:function(e,r,t){return t=p(t),A(r,e.parentNode,e,t),a(r,t)},merge:function(e,r,t){return t=p(t),r.domNode=e,l(e,r,t),a(r,t)},replace:function(e,r,t){return t=p(t),A(r,e.parentNode,e,t),e.parentNode.removeChild(e),a(r,t)}},c=function(e,r,t){for(var n=0,o=r.length;n<o;n++){var i=r[n];Array.isArray(i)?c(e,i,t):null!=i&&!1!==i&&("string"==typeof i&&(i={vnodeSelector:"",properties:void 0,children:void 0,text:i.toString(),domNode:null}),t.push(i))}};w=Array.prototype.find?function(e,r){return e.find(r)}:function(e,r){return e.filter(r)[0]},e.dom=C,e.h=function(e,r,t){if(Array.isArray(r))t=r,r=void 0;else if(r&&("string"==typeof r||r.hasOwnProperty("vnodeSelector"))||t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector")))throw Error("h called with invalid arguments");var n,o;return void 0!==t&&1===t.length&&"string"==typeof t[0]?n=t[0]:t&&(c(e,t,o=[]),0===o.length&&(o=void 0)),{vnodeSelector:e,properties:r,children:o,text:""===n?void 0:n,domNode:null}},e.createProjector=function(e){var i,t,d=p(e),c=d.performanceLogger,n=!0,r=!1,f=[],u=[],o=function(e,r,t){var n,a,s,p,o;d.eventHandlerInterceptor=(a=i,s=function(){return n},p=c,o=function(e){p("domEvent",e);var r=s(),t=function(e,r){for(var t=[];e!==r;)t.push(e),e=e.parentNode;return t}(e.currentTarget,r.domNode);t.reverse();var n,o,i,d=(n=r.getLastRender(),o=n,t.forEach(function(r){o=o&&o.children?w(o.children,function(e){return e.domNode===r}):void 0}),o);return a.scheduleRender(),d&&(i=d.properties["on"+e.type].apply(d.properties.bind||this,arguments)),p("domEventProcessed",e),i},function(e,r,t,n){return o}),n=e(r,t(),d),f.push(n),u.push(t)},a=function(){if(t=void 0,n){n=!1,c("renderStart",void 0);for(var e=0;e<f.length;e++){var r=u[e]();c("rendered",void 0),f[e].update(r),c("patched",void 0)}c("renderDone",void 0),n=!0}};return i={renderNow:a,scheduleRender:function(){t||r||(t=requestAnimationFrame(a))},stop:function(){t&&(cancelAnimationFrame(t),t=void 0),r=!0},resume:function(){n=!(r=!1),i.scheduleRender()},append:function(e,r){o(C.append,e,r)},insertBefore:function(e,r){o(C.insertBefore,e,r)},merge:function(e,r){o(C.merge,e,r)},replace:function(e,r){o(C.replace,e,r)},detach:function(e){for(var r=0;r<u.length;r++)if(u[r]===e)return u.splice(r,1),f.splice(r,1)[0];throw Error("renderFunction was not found")}}},e.createCache=function(){var n,o;return{invalidate:function(){n=o=void 0},result:function(e,r){if(n)for(var t=0;t<e.length;t++)n[t]!==e[t]&&(o=void 0);return o||(o=r(),n=e),o}}},e.createMapping=function(c,f,u){var l=[],v=[];return{results:v,map:function(e){for(var r=e.map(c),t=v.slice(),n=0,o=0;o<e.length;o++){var i=e[o],d=r[o];if(d===l[n])v[o]=t[n],u(i,t[n],o),n++;else{for(var a=!1,s=1;s<l.length+1;s++){var p=(n+s)%l.length;if(l[p]===d){v[o]=t[p],u(e[o],t[p],o),n=p+1,a=!0;break}}a||(v[o]=f(i,o))}}v.length=e.length,l=r}}},Object.defineProperty(e,"__esModule",{value:!0})});