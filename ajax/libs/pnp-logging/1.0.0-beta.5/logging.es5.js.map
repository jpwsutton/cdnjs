{"version":3,"file":"logging.es5.js","sources":["../../../../packages/logging/src/logger.ts","../../../../packages/logging/src/listeners.ts"],"sourcesContent":["import { LogLevel } from \"./loglevel\";\r\nimport { LogListener } from \"./listeners\";\r\nimport { LogEntry } from \"./logentry\";\r\n\r\n/**\r\n * Class used to subscribe ILogListener and log messages throughout an application\r\n *\r\n */\r\nexport class Logger {\r\n\r\n    private static _instance: LoggerImpl;\r\n\r\n    /**\r\n     * Gets or sets the active log level to apply for log filtering\r\n     */\r\n    public static get activeLogLevel(): LogLevel {\r\n        return Logger.instance.activeLogLevel;\r\n    }\r\n\r\n    public static set activeLogLevel(value: LogLevel) {\r\n        Logger.instance.activeLogLevel = value;\r\n    }\r\n\r\n    private static get instance(): LoggerImpl {\r\n        if (typeof Logger._instance === \"undefined\" || Logger._instance === null) {\r\n            Logger._instance = new LoggerImpl();\r\n        }\r\n        return Logger._instance;\r\n    }\r\n\r\n    /**\r\n     * Adds ILogListener instances to the set of subscribed listeners\r\n     *\r\n     * @param listeners One or more listeners to subscribe to this log\r\n     */\r\n    public static subscribe(...listeners: LogListener[]): void {\r\n        listeners.map(listener => Logger.instance.subscribe(listener));\r\n    }\r\n\r\n    /**\r\n     * Clears the subscribers collection, returning the collection before modifiction\r\n     */\r\n    public static clearSubscribers(): LogListener[] {\r\n        return Logger.instance.clearSubscribers();\r\n    }\r\n\r\n    /**\r\n     * Gets the current subscriber count\r\n     */\r\n    public static get count(): number {\r\n        return Logger.instance.count;\r\n    }\r\n\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param message The message to write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    public static write(message: string, level: LogLevel = LogLevel.Verbose) {\r\n        Logger.instance.log({ level: level, message: message });\r\n    }\r\n\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param json The json object to stringify and write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    public static writeJSON(json: any, level: LogLevel = LogLevel.Verbose) {\r\n        Logger.instance.log({ level: level, message: JSON.stringify(json) });\r\n    }\r\n\r\n    /**\r\n     * Logs the supplied entry to the subscribed listeners\r\n     *\r\n     * @param entry The message to log\r\n     */\r\n    public static log(entry: LogEntry) {\r\n        Logger.instance.log(entry);\r\n    }\r\n}\r\n\r\nclass LoggerImpl {\r\n\r\n    constructor(public activeLogLevel: LogLevel = LogLevel.Warning, private subscribers: LogListener[] = []) { }\r\n\r\n    public subscribe(listener: LogListener): void {\r\n        this.subscribers.push(listener);\r\n    }\r\n\r\n    public clearSubscribers(): LogListener[] {\r\n        const s = this.subscribers.slice(0);\r\n        this.subscribers.length = 0;\r\n        return s;\r\n    }\r\n\r\n    public get count(): number {\r\n        return this.subscribers.length;\r\n    }\r\n\r\n    public write(message: string, level: LogLevel = LogLevel.Verbose) {\r\n        this.log({ level: level, message: message });\r\n    }\r\n\r\n    public log(entry: LogEntry) {\r\n        if (typeof entry !== \"undefined\" && this.activeLogLevel <= entry.level) {\r\n            this.subscribers.map(subscriber => subscriber.log(entry));\r\n        }\r\n    }\r\n}\r\n","import { LogEntry } from \"./logentry\";\r\nimport { LogLevel } from \"./loglevel\";\r\n\r\n/**\r\n * Interface that defines a log listner\r\n *\r\n */\r\nexport interface LogListener {\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    log(entry: LogEntry): void;\r\n}\r\n\r\n/**\r\n * Implementation of LogListener which logs to the console\r\n *\r\n */\r\nexport class ConsoleListener implements LogListener {\r\n\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    public log(entry: LogEntry): void {\r\n\r\n        const msg = this.format(entry);\r\n\r\n        switch (entry.level) {\r\n            case LogLevel.Verbose:\r\n            case LogLevel.Info:\r\n                console.log(msg);\r\n                break;\r\n            case LogLevel.Warning:\r\n                console.warn(msg);\r\n                break;\r\n            case LogLevel.Error:\r\n                console.error(msg);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Formats the message\r\n     *\r\n     * @param entry The information to format into a string\r\n     */\r\n    private format(entry: LogEntry): string {\r\n        const msg = [];\r\n        msg.push(\"Message: \" + entry.message);\r\n        if (typeof entry.data !== \"undefined\") {\r\n            msg.push(\" Data: \" + JSON.stringify(entry.data));\r\n        }\r\n\r\n        return msg.join(\"\");\r\n    }\r\n}\r\n\r\n/**\r\n * Implementation of LogListener which logs to the supplied function\r\n *\r\n */\r\nexport class FunctionListener implements LogListener {\r\n\r\n    /**\r\n     * Creates a new instance of the FunctionListener class\r\n     *\r\n     * @constructor\r\n     * @param  method The method to which any logging data will be passed\r\n     */\r\n    constructor(private method: (entry: LogEntry) => void) { }\r\n\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    public log(entry: LogEntry): void {\r\n        this.method(entry);\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAIA;;;;AAIA;IAAA;KAyEC;IAlEG,sBAAkB,wBAAc;;;;aAAhC;YACI,OAAO,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC;SACzC;aAED,UAAiC,KAAe;YAC5C,MAAM,CAAC,QAAQ,CAAC,cAAc,GAAG,KAAK,CAAC;SAC1C;;;OAJA;IAMD,sBAAmB,kBAAQ;aAA3B;YACI,IAAI,OAAO,MAAM,CAAC,SAAS,KAAK,WAAW,IAAI,MAAM,CAAC,SAAS,KAAK,IAAI,EAAE;gBACtE,MAAM,CAAC,SAAS,GAAG,IAAI,UAAU,EAAE,CAAC;aACvC;YACD,OAAO,MAAM,CAAC,SAAS,CAAC;SAC3B;;;OAAA;;;;;;IAOa,gBAAS,GAAvB;QAAwB,mBAA2B;aAA3B,UAA2B,EAA3B,qBAA2B,EAA3B,IAA2B;YAA3B,8BAA2B;;QAC/C,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAA,CAAC,CAAC;KAClE;;;;IAKa,uBAAgB,GAA9B;QACI,OAAO,MAAM,CAAC,QAAQ,CAAC,gBAAgB,EAAE,CAAC;KAC7C;IAKD,sBAAkB,eAAK;;;;aAAvB;YACI,OAAO,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;SAChC;;;OAAA;;;;;;;IAQa,YAAK,GAAnB,UAAoB,OAAe,EAAE,KAAkC;QAAlC,sBAAA,EAAA;QACjC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;KAC3D;;;;;;;IAQa,gBAAS,GAAvB,UAAwB,IAAS,EAAE,KAAkC;QAAlC,sBAAA,EAAA;QAC/B,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACxE;;;;;;IAOa,UAAG,GAAjB,UAAkB,KAAe;QAC7B,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KAC9B;IACL,aAAC;CAAA,IAAA;AAED;IAEI,oBAAmB,cAA2C,EAAU,WAA+B;QAApF,+BAAA,EAAA;QAAqD,4BAAA,EAAA,gBAA+B;QAApF,mBAAc,GAAd,cAAc,CAA6B;QAAU,gBAAW,GAAX,WAAW,CAAoB;KAAK;IAErG,8BAAS,GAAhB,UAAiB,QAAqB;QAClC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACnC;IAEM,qCAAgB,GAAvB;QACI,IAAM,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACpC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;QAC5B,OAAO,CAAC,CAAC;KACZ;IAED,sBAAW,6BAAK;aAAhB;YACI,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;SAClC;;;OAAA;IAEM,0BAAK,GAAZ,UAAa,OAAe,EAAE,KAAkC;QAAlC,sBAAA,EAAA;QAC1B,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;KAChD;IAEM,wBAAG,GAAV,UAAW,KAAe;QACtB,IAAI,OAAO,KAAK,KAAK,WAAW,IAAI,IAAI,CAAC,cAAc,IAAI,KAAK,CAAC,KAAK,EAAE;YACpE,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;SAC7D;KACJ;IACL,iBAAC;CAAA;;AC9FD;;;;AAIA;IAAA;KAuCC;;;;;;IAhCU,6BAAG,GAAV,UAAW,KAAe;QAEtB,IAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAE/B,QAAQ,KAAK,CAAC,KAAK;YACf,qBAAsB;YACtB;gBACI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBACjB,MAAM;YACV;gBACI,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAClB,MAAM;YACV;gBACI,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACnB,MAAM;SACb;KACJ;;;;;;IAOO,gCAAM,GAAd,UAAe,KAAe;QAC1B,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,GAAG,CAAC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC;QACtC,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,WAAW,EAAE;YACnC,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;SACpD;QAED,OAAO,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACvB;IACL,sBAAC;CAAA,IAAA;AAED;;;;AAIA;;;;;;;IAQI,0BAAoB,MAAiC;QAAjC,WAAM,GAAN,MAAM,CAA2B;KAAK;;;;;;IAOnD,8BAAG,GAAV,UAAW,KAAe;QACtB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;KACtB;IACL,uBAAC;CAAA;;;;"}