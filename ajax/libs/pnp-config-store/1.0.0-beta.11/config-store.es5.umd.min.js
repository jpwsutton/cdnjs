!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("tslib"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","tslib","@pnp/logging"],t):t((e.pnp=e.pnp||{},e.pnp["config-store"]={}),e.common,e.tslib_1,e.logging)}(this,function(e,t,i,n){"use strict";var o=function(){function e(){this._settings=new t.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(i,n){try{t._settings.merge(e),i()}catch(e){n(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(i,n){e.getConfiguration().then(function(e){t._settings.merge(e),i()}).catch(function(e){n(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)},e}(),r=function(e){i.__extends(t,e);function t(t){void 0===t&&(t="Cannot create a caching configuration provider since cache is not available.");var i=e.call(this,t)||this;return i.name="NoCacheAvailableException",n.Logger.log({data:{},level:3,message:"["+i.name+"]::"+i.message}),i}return t}(Error),s=function(){function e(e,t,i){this.wrappedProvider=e,this.store=i||this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e){e(t)});var i=this.wrappedProvider.getConfiguration();return i.then(function(t){e.store.put(e.cacheKey,t)}),i},e.prototype.selectPnPCache=function(){var e=new t.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new r},e}(),a=function(){function e(e,t,i,n){void 0===t&&(t="config"),void 0===i&&(i="Title"),void 0===n&&(n="Value"),this.sourceWeb=e,this.sourceListTitle=t,this.keyFieldName=i,this.valueFieldName=n}return Object.defineProperty(e.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),e.prototype.getConfiguration=function(){var e=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName).get().then(function(t){return t.reduce(function(t,i){return Object.defineProperty(t,i[e.keyFieldName],{configurable:!1,enumerable:!1,value:i[e.valueFieldName],writable:!1})},{})})},e.prototype.asCaching=function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new s(this,e)},e}();e.Settings=o,e.CachingConfigurationProvider=s,e.SPListConfigurationProvider=a,e.NoCacheAvailableException=r,Object.defineProperty(e,"__esModule",{value:!0})});