!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@pnp/common"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/logging"],e):e(t.pnp={},t.common,t.logging)}(this,function(t,e,n){"use strict";var o=function(){function t(){this._settings=new e.Dictionary}return t.prototype.add=function(t,e){this._settings.add(t,e)},t.prototype.addJSON=function(t,e){this._settings.add(t,JSON.stringify(e))},t.prototype.apply=function(t){var e=this;return new Promise(function(n,o){try{e._settings.merge(t),n()}catch(t){o(t)}})},t.prototype.load=function(t){var e=this;return new Promise(function(n,o){t.getConfiguration().then(function(t){e._settings.merge(t),n()}).catch(function(t){o(t)})})},t.prototype.get=function(t){return this._settings.get(t)},t.prototype.getJSON=function(t){var e=this.get(t);return void 0===e||null===e?e:JSON.parse(e)},t}(),i=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=function(t){function e(e){void 0===e&&(e="Cannot create a caching configuration provider since cache is not available.");var o=t.call(this,e)||this;return o.name="NoCacheAvailableException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+o.name+"]::"+o.message}),o}return i(e,t),e}(Error),s=function(){function t(t,e,n){this.wrappedProvider=t,this.store=n||this.selectPnPCache(),this.cacheKey="_configcache_"+e}return t.prototype.getWrappedProvider=function(){return this.wrappedProvider},t.prototype.getConfiguration=function(){var t=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var e=this.store.get(this.cacheKey);if(e)return new Promise(function(t){t(e)});var n=this.wrappedProvider.getConfiguration();return n.then(function(e){t.store.put(t.cacheKey,e)}),n},t.prototype.selectPnPCache=function(){var t=new e.PnPClientStorage;if(t.local&&t.local.enabled)return t.local;if(t.session&&t.session.enabled)return t.session;throw new r},t}(),c=function(){function t(t,e){void 0===e&&(e="config"),this.sourceWeb=t,this.sourceListTitle=e}return Object.defineProperty(t.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),t.prototype.getConfiguration=function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(t){return t.reduce(function(t,e){return Object.defineProperty(t,e.Title,{configurable:!1,enumerable:!1,value:e.Value,writable:!1})},{})})},t.prototype.asCaching=function(){var t="splist_"+this.web.toUrl()+"+"+this.listTitle;return new s(this,t)},t}();t.Settings=o,t.CachingConfigurationProvider=s,t.SPListConfigurationProvider=c,Object.defineProperty(t,"__esModule",{value:!0})});