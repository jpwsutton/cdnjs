/**
@license
 * @pnp/config-store v1.0.5 - pnp - provides a way to manage configuration within your application
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https:github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("tslib"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","tslib","@pnp/logging"],t):t((e.pnp=e.pnp||{},e.pnp["config-store"]={}),e.pnp.common,e.tslib_1,e.pnp.logging)}(this,function(e,t,i,o){"use strict";var n=function(){function e(){this._settings=new t.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(n){var i=this;return new Promise(function(e,t){try{i._settings.merge(n),e()}catch(e){t(e)}})},e.prototype.load=function(n){var i=this;return new Promise(function(t,e){n.getConfiguration().then(function(e){i._settings.merge(e),t()}).catch(e)})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return null==t?t:JSON.parse(t)},e}(),r=function(n){function e(e){void 0===e&&(e="Cannot create a caching configuration provider since cache is not available.");var t=n.call(this,e)||this;return t.name="NoCacheAvailableException",o.Logger.log({data:{},level:3,message:"["+t.name+"]::"+t.message}),t}return i.__extends(e,n),e}(Error),s=function(){function e(e,t,n){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=n||this.selectPnPCache()}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var t=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,function(){return t.wrappedProvider.getConfiguration().then(function(e){return t.store.put(t.cacheKey,e),e})}):this.wrappedProvider.getConfiguration()},e.prototype.selectPnPCache=function(){var e=new t.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new r},e}(),a=function(){function e(e,t,n,i){void 0===t&&(t="config"),void 0===n&&(n="Title"),void 0===i&&(i="Value"),this.web=e,this.listTitle=t,this.keyFieldName=n,this.valueFieldName=i}return e.prototype.getConfiguration=function(){var n=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName).get().then(function(e){return e.reduce(function(e,t){return e[t[n.keyFieldName]]=t[n.valueFieldName],e},{})})},e.prototype.asCaching=function(e){return void 0===e&&(e="pnp_configcache_splist_"+this.web.toUrl()+"+"+this.listTitle),new s(this,e)},e}();e.Settings=n,e.CachingConfigurationProvider=s,e.SPListConfigurationProvider=a,e.NoCacheAvailableException=r,Object.defineProperty(e,"__esModule",{value:!0})});