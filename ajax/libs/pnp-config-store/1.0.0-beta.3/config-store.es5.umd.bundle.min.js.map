{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///config-store.es5.umd.bundle.min.js","webpack:///webpack/bootstrap 2089adffc6f376e0c2ba","webpack:///./dist/packages/common/dist/common.es5.js","webpack:///./dist/packages/logging/dist/logging.es5.js","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./build/packages/config-store/es5/src/providers/cachingConfigurationProvider.js","webpack:///./build/packages/config-store/es5/src/exceptions.js","webpack:///./build/packages/config-store/es5/src/configuration.js","webpack:///./build/packages/config-store/es5/src/providers/spListConfigurationProvider.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","Dictionary","PnPClientStorage","__WEBPACK_IMPORTED_MODULE_0__pnp_logging__","__WEBPACK_IMPORTED_MODULE_1_tslib__","keys","values","key","index","indexOf","add","remove","push","merge","source","_this","sourceAsDictionary_1","getKeys","map","sourceAsHash","val","splice","getValues","clear","count","length","Util","getCtxCallback","context","method","params","_i","arguments","apply","urlParamExists","replace","RegExp","test","location","search","getUrlParamByName","regex","results","exec","decodeURIComponent","getUrlParamBoolByName","stringInsert","target","substring","dateAdd","date","interval","units","ret","Date","toLowerCase","setFullYear","getFullYear","setMonth","getMonth","setDate","getDate","setTime","getTime","undefined","loadStylesheet","path","avoidCache","encodeURIComponent","toString","head","document","getElementsByTagName","e","createElement","appendChild","setAttribute","combinePaths","paths","filter","stringIsNullOrEmpty","join","getRandomString","chars","text","Array","possible","charAt","Math","floor","random","getGUID","r","isFunction","candidateFunction","objectDefinedNotNull","obj","isArray","array","constructor","extend","noOverwrite","check","getOwnPropertyNames","v","reduce","t","isUrlAbsolute","url","CommonRuntimeConfigKeys","_super","FunctionExpectedException","msg","log","data","level","Error","message","UrlException","defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","RuntimeConfigImpl","_v","config","forEach","_runtimeConfig","RuntimeConfig","PnPClientStorageWrapper","store","defaultTimeoutMinutes","enabled","write","Info","cacheExpirationHandler","getItem","persistable","JSON","parse","expiration","delete","value","put","expire","setItem","createPersistable","removeItem","getOrPut","Promise","resolve","then","deleteExpired","reject","defaultTimeout","stringify","pnp","Verbose","_","setTimeout","catch","MemoryStorage","_store","_local","_session","localStorage","sessionStorage","Logger","LogLevel","instance","activeLogLevel","set","_instance","LoggerImpl","subscribe","listeners","listener","clearSubscribers","writeJSON","json","entry","measure","f","subscribers","Warning","slice","subscriber","console","profile","profileEnd","ConsoleListener","format","warn","error","FunctionListener","__extends","b","__","extendStatics","create","setPrototypeOf","__proto__","assign","__WEBPACK_IMPORTED_MODULE_0__pnp_common__","__WEBPACK_IMPORTED_MODULE_1__exceptions__","CachingConfigurationProvider","wrappedProvider","cacheKey","cacheStore","selectPnPCache","getWrappedProvider","getConfiguration","cachedConfig","providerPromise","providedConfig","pnpCache","local","session","NoCacheAvailableException","__WEBPACK_IMPORTED_MODULE_0_tslib__","__WEBPACK_IMPORTED_MODULE_1__pnp_logging__","__WEBPACK_IMPORTED_MODULE_0__src_configstore__","__WEBPACK_IMPORTED_MODULE_0__configuration__","__WEBPACK_IMPORTED_MODULE_1__providers_index__","__WEBPACK_IMPORTED_MODULE_2__exceptions__","Settings","_settings","addJSON","hash","load","provider","reason","getJSON","__WEBPACK_IMPORTED_MODULE_0__cachingConfigurationProvider__","__WEBPACK_IMPORTED_MODULE_1__spListConfigurationProvider__","SPListConfigurationProvider","sourceWeb","sourceListTitle","web","lists","getByTitle","listTitle","items","select","getAs","configuration","item","Title","Value","writable","asCaching","toUrl"],"mappings":"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","file":"config-store.es5.umd.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pnp\"] = factory();\n\telse\n\t\troot[\"pnp\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","// TODO:: banner\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pnp\"] = factory();\n\telse\n\t\troot[\"pnp\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export Util */\n/* unused harmony export readBlobAsText */\n/* unused harmony export readBlobAsArrayBuffer */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Dictionary; });\n/* unused harmony export mergeOptions */\n/* unused harmony export deprecated */\n/* unused harmony export beta */\n/* unused harmony export FunctionExpectedException */\n/* unused harmony export UrlException */\n/* unused harmony export CommonRuntimeConfigKeys */\n/* unused harmony export RuntimeConfigImpl */\n/* unused harmony export RuntimeConfig */\n/* unused harmony export mergeHeaders */\n/* unused harmony export PnPClientStorageWrapper */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return PnPClientStorage; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__pnp_logging__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tslib__ = __webpack_require__(2);\n\n\n\n/**\r\n * Reads a blob as text\r\n *\r\n * @param blob The data to read\r\n */\r\nfunction readBlobAsText(blob) {\r\n    return readBlobAs(blob, \"string\");\r\n}\r\n/**\r\n * Reads a blob into an array buffer\r\n *\r\n * @param blob The data to read\r\n */\r\nfunction readBlobAsArrayBuffer(blob) {\r\n    return readBlobAs(blob, \"buffer\");\r\n}\r\n/**\r\n * Generic method to read blob's content\r\n *\r\n * @param blob The data to read\r\n * @param mode The read mode\r\n */\r\nfunction readBlobAs(blob, mode) {\r\n    return new Promise(function (resolve, reject) {\r\n        try {\r\n            var reader = new FileReader();\r\n            reader.onload = function (e) {\r\n                resolve(e.target.result);\r\n            };\r\n            switch (mode) {\r\n                case \"string\":\r\n                    reader.readAsText(blob);\r\n                    break;\r\n                case \"buffer\":\r\n                    reader.readAsArrayBuffer(blob);\r\n                    break;\r\n            }\r\n        }\r\n        catch (e) {\r\n            reject(e);\r\n        }\r\n    });\r\n}\n\n/**\r\n * Generic dictionary\r\n */\r\nvar Dictionary = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the Dictionary<T> class\r\n     *\r\n     * @constructor\r\n     */\r\n    function Dictionary(keys, values) {\r\n        if (keys === void 0) { keys = []; }\r\n        if (values === void 0) { values = []; }\r\n        this.keys = keys;\r\n        this.values = values;\r\n    }\r\n    /**\r\n     * Gets a value from the collection using the specified key\r\n     *\r\n     * @param key The key whose value we want to return, returns null if the key does not exist\r\n     */\r\n    Dictionary.prototype.get = function (key) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index < 0) {\r\n            return null;\r\n        }\r\n        return this.values[index];\r\n    };\r\n    /**\r\n     * Adds the supplied key and value to the dictionary\r\n     *\r\n     * @param key The key to add\r\n     * @param o The value to add\r\n     */\r\n    Dictionary.prototype.add = function (key, o) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index > -1) {\r\n            if (o === null) {\r\n                this.remove(key);\r\n            }\r\n            else {\r\n                this.values[index] = o;\r\n            }\r\n        }\r\n        else {\r\n            if (o !== null) {\r\n                this.keys.push(key);\r\n                this.values.push(o);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Merges the supplied typed hash into this dictionary instance. Existing values are updated and new ones are created as appropriate.\r\n     */\r\n    Dictionary.prototype.merge = function (source) {\r\n        var _this = this;\r\n        if (\"getKeys\" in source) {\r\n            var sourceAsDictionary_1 = source;\r\n            sourceAsDictionary_1.getKeys().map(function (key) {\r\n                _this.add(key, sourceAsDictionary_1.get(key));\r\n            });\r\n        }\r\n        else {\r\n            var sourceAsHash = source;\r\n            for (var key in sourceAsHash) {\r\n                if (sourceAsHash.hasOwnProperty(key)) {\r\n                    this.add(key, sourceAsHash[key]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Removes a value from the dictionary\r\n     *\r\n     * @param key The key of the key/value pair to remove. Returns null if the key was not found.\r\n     */\r\n    Dictionary.prototype.remove = function (key) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index < 0) {\r\n            return null;\r\n        }\r\n        var val = this.values[index];\r\n        this.keys.splice(index, 1);\r\n        this.values.splice(index, 1);\r\n        return val;\r\n    };\r\n    /**\r\n     * Returns all the keys currently in the dictionary as an array\r\n     */\r\n    Dictionary.prototype.getKeys = function () {\r\n        return this.keys;\r\n    };\r\n    /**\r\n     * Returns all the values currently in the dictionary as an array\r\n     */\r\n    Dictionary.prototype.getValues = function () {\r\n        return this.values;\r\n    };\r\n    /**\r\n     * Clears the current dictionary\r\n     */\r\n    Dictionary.prototype.clear = function () {\r\n        this.keys = [];\r\n        this.values = [];\r\n    };\r\n    /**\r\n     * Gets a count of the items currently in the dictionary\r\n     */\r\n    Dictionary.prototype.count = function () {\r\n        return this.keys.length;\r\n    };\r\n    return Dictionary;\r\n}());\n\nvar Util = /** @class */ (function () {\r\n    function Util() {\r\n    }\r\n    /**\r\n     * Gets a callback function which will maintain context across async calls.\r\n     * Allows for the calling pattern getCtxCallback(thisobj, method, methodarg1, methodarg2, ...)\r\n     *\r\n     * @param context The object that will be the 'this' value in the callback\r\n     * @param method The method to which we will apply the context and parameters\r\n     * @param params Optional, additional arguments to supply to the wrapped method when it is invoked\r\n     */\r\n    Util.getCtxCallback = function (context, method) {\r\n        var params = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            params[_i - 2] = arguments[_i];\r\n        }\r\n        return function () {\r\n            method.apply(context, params);\r\n        };\r\n    };\r\n    /**\r\n     * Tests if a url param exists\r\n     *\r\n     * @param name The name of the url paramter to check\r\n     */\r\n    Util.urlParamExists = function (name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\r\n        return regex.test(location.search);\r\n    };\r\n    /**\r\n     * Gets a url param value by name\r\n     *\r\n     * @param name The name of the paramter for which we want the value\r\n     */\r\n    Util.getUrlParamByName = function (name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\r\n        var results = regex.exec(location.search);\r\n        return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n    };\r\n    /**\r\n     * Gets a url param by name and attempts to parse a bool value\r\n     *\r\n     * @param name The name of the paramter for which we want the boolean value\r\n     */\r\n    Util.getUrlParamBoolByName = function (name) {\r\n        var p = this.getUrlParamByName(name);\r\n        var isFalse = (p === \"\" || /false|0/i.test(p));\r\n        return !isFalse;\r\n    };\r\n    /**\r\n     * Inserts the string s into the string target as the index specified by index\r\n     *\r\n     * @param target The string into which we will insert s\r\n     * @param index The location in target to insert s (zero based)\r\n     * @param s The string to insert into target at position index\r\n     */\r\n    Util.stringInsert = function (target, index, s) {\r\n        if (index > 0) {\r\n            return target.substring(0, index) + s + target.substring(index, target.length);\r\n        }\r\n        return s + target;\r\n    };\r\n    /**\r\n     * Adds a value to a date\r\n     *\r\n     * @param date The date to which we will add units, done in local time\r\n     * @param interval The name of the interval to add, one of: ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second']\r\n     * @param units The amount to add to date of the given interval\r\n     *\r\n     * http://stackoverflow.com/questions/1197928/how-to-add-30-minutes-to-a-javascript-date-object\r\n     */\r\n    Util.dateAdd = function (date, interval, units) {\r\n        var ret = new Date(date); // don't change original date\r\n        switch (interval.toLowerCase()) {\r\n            case \"year\":\r\n                ret.setFullYear(ret.getFullYear() + units);\r\n                break;\r\n            case \"quarter\":\r\n                ret.setMonth(ret.getMonth() + 3 * units);\r\n                break;\r\n            case \"month\":\r\n                ret.setMonth(ret.getMonth() + units);\r\n                break;\r\n            case \"week\":\r\n                ret.setDate(ret.getDate() + 7 * units);\r\n                break;\r\n            case \"day\":\r\n                ret.setDate(ret.getDate() + units);\r\n                break;\r\n            case \"hour\":\r\n                ret.setTime(ret.getTime() + units * 3600000);\r\n                break;\r\n            case \"minute\":\r\n                ret.setTime(ret.getTime() + units * 60000);\r\n                break;\r\n            case \"second\":\r\n                ret.setTime(ret.getTime() + units * 1000);\r\n                break;\r\n            default:\r\n                ret = undefined;\r\n                break;\r\n        }\r\n        return ret;\r\n    };\r\n    /**\r\n     * Loads a stylesheet into the current page\r\n     *\r\n     * @param path The url to the stylesheet\r\n     * @param avoidCache If true a value will be appended as a query string to avoid browser caching issues\r\n     */\r\n    Util.loadStylesheet = function (path, avoidCache) {\r\n        if (avoidCache) {\r\n            path += \"?\" + encodeURIComponent((new Date()).getTime().toString());\r\n        }\r\n        var head = document.getElementsByTagName(\"head\");\r\n        if (head.length > 0) {\r\n            var e = document.createElement(\"link\");\r\n            head[0].appendChild(e);\r\n            e.setAttribute(\"type\", \"text/css\");\r\n            e.setAttribute(\"rel\", \"stylesheet\");\r\n            e.setAttribute(\"href\", path);\r\n        }\r\n    };\r\n    /**\r\n     * Combines an arbitrary set of paths ensuring that the slashes are normalized\r\n     *\r\n     * @param paths 0 to n path parts to combine\r\n     */\r\n    Util.combinePaths = function () {\r\n        var paths = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            paths[_i] = arguments[_i];\r\n        }\r\n        return paths\r\n            .filter(function (path) { return !Util.stringIsNullOrEmpty(path); })\r\n            .map(function (path) { return path.replace(/^[\\\\|\\/]/, \"\").replace(/[\\\\|\\/]$/, \"\"); })\r\n            .join(\"/\")\r\n            .replace(/\\\\/g, \"/\");\r\n    };\r\n    /**\r\n     * Gets a random string of chars length\r\n     *\r\n     * @param chars The length of the random string to generate\r\n     */\r\n    Util.getRandomString = function (chars) {\r\n        var text = new Array(chars);\r\n        var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n        for (var i = 0; i < chars; i++) {\r\n            text[i] = possible.charAt(Math.floor(Math.random() * possible.length));\r\n        }\r\n        return text.join(\"\");\r\n    };\r\n    /**\r\n     * Gets a random GUID value\r\n     *\r\n     * http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\r\n     */\r\n    /* tslint:disable no-bitwise */\r\n    Util.getGUID = function () {\r\n        var d = new Date().getTime();\r\n        var guid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\r\n            var r = (d + Math.random() * 16) % 16 | 0;\r\n            d = Math.floor(d / 16);\r\n            return (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\r\n        });\r\n        return guid;\r\n    };\r\n    /* tslint:enable */\r\n    /**\r\n     * Determines if a given value is a function\r\n     *\r\n     * @param candidateFunction The thing to test for being a function\r\n     */\r\n    Util.isFunction = function (candidateFunction) {\r\n        return typeof candidateFunction === \"function\";\r\n    };\r\n    /**\r\n     * Determines if an object is both defined and not null\r\n     * @param obj Object to test\r\n     */\r\n    Util.objectDefinedNotNull = function (obj) {\r\n        return typeof obj !== \"undefined\" && obj !== null;\r\n    };\r\n    /**\r\n     * @returns whether the provided parameter is a JavaScript Array or not.\r\n    */\r\n    Util.isArray = function (array) {\r\n        if (Array.isArray) {\r\n            return Array.isArray(array);\r\n        }\r\n        return array && typeof array.length === \"number\" && array.constructor === Array;\r\n    };\r\n    /**\r\n     * Determines if a string is null or empty or undefined\r\n     *\r\n     * @param s The string to test\r\n     */\r\n    Util.stringIsNullOrEmpty = function (s) {\r\n        return typeof s === \"undefined\" || s === null || s.length < 1;\r\n    };\r\n    /**\r\n     * Provides functionality to extend the given object by doing a shallow copy\r\n     *\r\n     * @param target The object to which properties will be copied\r\n     * @param source The source object from which properties will be copied\r\n     * @param noOverwrite If true existing properties on the target are not overwritten from the source\r\n     *\r\n     */\r\n    Util.extend = function (target, source, noOverwrite) {\r\n        if (noOverwrite === void 0) { noOverwrite = false; }\r\n        if (!Util.objectDefinedNotNull(source)) {\r\n            return target;\r\n        }\r\n        // ensure we don't overwrite things we don't want overwritten\r\n        var check = noOverwrite ? function (o, i) { return !(i in o); } : function () { return true; };\r\n        return Object.getOwnPropertyNames(source)\r\n            .filter(function (v) { return check(target, v); })\r\n            .reduce(function (t, v) {\r\n            t[v] = source[v];\r\n            return t;\r\n        }, target);\r\n    };\r\n    /**\r\n     * Determines if a given url is absolute\r\n     *\r\n     * @param url The url to check to see if it is absolute\r\n     */\r\n    Util.isUrlAbsolute = function (url) {\r\n        return /^https?:\\/\\/|^\\/\\//i.test(url);\r\n    };\r\n    return Util;\r\n}());\n\nfunction mergeOptions(target, source) {\r\n    if (Util.objectDefinedNotNull(source)) {\r\n        var headers = Util.extend(target.headers || {}, source.headers);\r\n        target = Util.extend(target, source);\r\n        target.headers = headers;\r\n    }\r\n}\n\nfunction deprecated(deprecationVersion, message) {\r\n    return function (target, propertyKey, descriptor) {\r\n        var method = descriptor.value;\r\n        descriptor.value = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].log({\r\n                data: {\r\n                    descriptor: descriptor,\r\n                    propertyKey: propertyKey,\r\n                    target: target,\r\n                },\r\n                level: __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Warning,\r\n                message: \"(\" + deprecationVersion + \") \" + message,\r\n            });\r\n            return method.apply(this, args);\r\n        };\r\n    };\r\n}\r\nfunction beta(message) {\r\n    if (message === void 0) { message = \"This feature is flagged as beta and is subject to change.\"; }\r\n    return function (target, propertyKey, descriptor) {\r\n        var method = descriptor.value;\r\n        descriptor.value = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].log({\r\n                data: {\r\n                    descriptor: descriptor,\r\n                    propertyKey: propertyKey,\r\n                    target: target,\r\n                },\r\n                level: __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Warning,\r\n                message: message,\r\n            });\r\n            return method.apply(this, args);\r\n        };\r\n    };\r\n}\n\nvar FunctionExpectedException = /** @class */ (function (_super) {\r\n    Object(__WEBPACK_IMPORTED_MODULE_1_tslib__[\"a\" /* __extends */])(FunctionExpectedException, _super);\r\n    function FunctionExpectedException(msg) {\r\n        if (msg === void 0) { msg = \"Expected a function.\"; }\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"FunctionExpectedException\";\r\n        __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].log({ data: {}, level: __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return FunctionExpectedException;\r\n}(Error));\r\nvar UrlException = /** @class */ (function (_super) {\r\n    Object(__WEBPACK_IMPORTED_MODULE_1_tslib__[\"a\" /* __extends */])(UrlException, _super);\r\n    function UrlException(msg) {\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"UrlException\";\r\n        __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].log({ data: {}, level: __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return UrlException;\r\n}(Error));\n\nvar CommonRuntimeConfigKeys = /** @class */ (function () {\r\n    function CommonRuntimeConfigKeys() {\r\n    }\r\n    CommonRuntimeConfigKeys.defaultCachingStore = \"defaultCachingStore\";\r\n    CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds = \"defaultCachingTimeoutSeconds\";\r\n    CommonRuntimeConfigKeys.globalCacheDisable = \"globalCacheDisable\";\r\n    CommonRuntimeConfigKeys.enableCacheExpiration = \"enableCacheExpiration\";\r\n    CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds = \"cacheExpirationIntervalMilliseconds\";\r\n    CommonRuntimeConfigKeys.spfxContext = \"spfxContext\";\r\n    return CommonRuntimeConfigKeys;\r\n}());\r\nvar RuntimeConfigImpl = /** @class */ (function () {\r\n    function RuntimeConfigImpl() {\r\n        this._v = new Dictionary();\r\n        // setup defaults\r\n        this._v.add(CommonRuntimeConfigKeys.defaultCachingStore, \"session\");\r\n        this._v.add(CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds, 60);\r\n        this._v.add(CommonRuntimeConfigKeys.globalCacheDisable, false);\r\n        this._v.add(CommonRuntimeConfigKeys.enableCacheExpiration, false);\r\n        this._v.add(CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds, 750);\r\n        this._v.add(CommonRuntimeConfigKeys.spfxContext, null);\r\n    }\r\n    /**\r\n     *\r\n     * @param config The set of properties to add to the globa configuration instance\r\n     */\r\n    RuntimeConfigImpl.prototype.extend = function (config) {\r\n        var _this = this;\r\n        Object.keys(config).forEach(function (key) {\r\n            _this._v.add(key, config[key]);\r\n        });\r\n    };\r\n    RuntimeConfigImpl.prototype.get = function (key) {\r\n        return this._v.get(key);\r\n    };\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingStore\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.defaultCachingStore);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingTimeoutSeconds\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"globalCacheDisable\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.globalCacheDisable);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"enableCacheExpiration\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.enableCacheExpiration);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"cacheExpirationIntervalMilliseconds\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"spfxContext\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.spfxContext);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return RuntimeConfigImpl;\r\n}());\r\nvar _runtimeConfig = new RuntimeConfigImpl();\r\nvar RuntimeConfig = _runtimeConfig;\n\nfunction mergeHeaders(target, source) {\r\n    if (typeof source !== \"undefined\" && source !== null) {\r\n        var temp = new Request(\"\", { headers: source });\r\n        temp.headers.forEach(function (value, name) {\r\n            target.append(name, value);\r\n        });\r\n    }\r\n}\n\n/**\r\n * A wrapper class to provide a consistent interface to browser based storage\r\n *\r\n */\r\nvar PnPClientStorageWrapper = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the PnPClientStorageWrapper class\r\n     *\r\n     * @constructor\r\n     */\r\n    function PnPClientStorageWrapper(store, defaultTimeoutMinutes) {\r\n        if (defaultTimeoutMinutes === void 0) { defaultTimeoutMinutes = -1; }\r\n        this.store = store;\r\n        this.defaultTimeoutMinutes = defaultTimeoutMinutes;\r\n        this.enabled = this.test();\r\n        // if the cache timeout is enabled call the handler\r\n        // this will clear any expired items and set the timeout function\r\n        if (RuntimeConfig.enableCacheExpiration) {\r\n            __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].write(\"Enabling cache expiration.\", __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Info);\r\n            this.cacheExpirationHandler();\r\n        }\r\n    }\r\n    /**\r\n     * Get a value from storage, or null if that value does not exist\r\n     *\r\n     * @param key The key whose value we want to retrieve\r\n     */\r\n    PnPClientStorageWrapper.prototype.get = function (key) {\r\n        if (!this.enabled) {\r\n            return null;\r\n        }\r\n        var o = this.store.getItem(key);\r\n        if (o == null) {\r\n            return null;\r\n        }\r\n        var persistable = JSON.parse(o);\r\n        if (new Date(persistable.expiration) <= new Date()) {\r\n            __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].write(\"Removing item with key '\" + key + \"' from cache due to expiration.\", __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Info);\r\n            this.delete(key);\r\n            return null;\r\n        }\r\n        else {\r\n            return persistable.value;\r\n        }\r\n    };\r\n    /**\r\n     * Adds a value to the underlying storage\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param o The value to store\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    PnPClientStorageWrapper.prototype.put = function (key, o, expire) {\r\n        if (this.enabled) {\r\n            this.store.setItem(key, this.createPersistable(o, expire));\r\n        }\r\n    };\r\n    /**\r\n     * Deletes a value from the underlying storage\r\n     *\r\n     * @param key The key of the pair we want to remove from storage\r\n     */\r\n    PnPClientStorageWrapper.prototype.delete = function (key) {\r\n        if (this.enabled) {\r\n            this.store.removeItem(key);\r\n        }\r\n    };\r\n    /**\r\n     * Gets an item from the underlying storage, or adds it if it does not exist using the supplied getter function\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param getter A function which will upon execution provide the desired value\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    PnPClientStorageWrapper.prototype.getOrPut = function (key, getter, expire) {\r\n        var _this = this;\r\n        if (!this.enabled) {\r\n            return getter();\r\n        }\r\n        return new Promise(function (resolve) {\r\n            var o = _this.get(key);\r\n            if (o == null) {\r\n                getter().then(function (d) {\r\n                    _this.put(key, d, expire);\r\n                    resolve(d);\r\n                });\r\n            }\r\n            else {\r\n                resolve(o);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Deletes any expired items placed in the store by the pnp library, leaves other items untouched\r\n     */\r\n    PnPClientStorageWrapper.prototype.deleteExpired = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this.enabled) {\r\n                resolve();\r\n            }\r\n            try {\r\n                for (var i = 0; i < _this.store.length; i++) {\r\n                    var key = _this.store.key(i);\r\n                    if (key !== null) {\r\n                        // test the stored item to see if we stored it\r\n                        if (/[\"|']?pnp[\"|']? ?: ?1/i.test(_this.store.getItem(key))) {\r\n                            // get those items as get will delete from cache if they are expired\r\n                            _this.get(key);\r\n                        }\r\n                    }\r\n                }\r\n                resolve();\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Used to determine if the wrapped storage is available currently\r\n     */\r\n    PnPClientStorageWrapper.prototype.test = function () {\r\n        var str = \"test\";\r\n        try {\r\n            this.store.setItem(str, str);\r\n            this.store.removeItem(str);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Creates the persistable to store\r\n     */\r\n    PnPClientStorageWrapper.prototype.createPersistable = function (o, expire) {\r\n        if (typeof expire === \"undefined\") {\r\n            // ensure we are by default inline with the global library setting\r\n            var defaultTimeout = RuntimeConfig.defaultCachingTimeoutSeconds;\r\n            if (this.defaultTimeoutMinutes > 0) {\r\n                defaultTimeout = this.defaultTimeoutMinutes * 60;\r\n            }\r\n            expire = Util.dateAdd(new Date(), \"second\", defaultTimeout);\r\n        }\r\n        return JSON.stringify({ pnp: 1, expiration: expire, value: o });\r\n    };\r\n    /**\r\n     * Deletes expired items added by this library in this.store and sets a timeout to call itself\r\n     */\r\n    PnPClientStorageWrapper.prototype.cacheExpirationHandler = function () {\r\n        var _this = this;\r\n        __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].write(\"Called cache expiration handler.\", __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Verbose);\r\n        this.deleteExpired().then(function (_) {\r\n            // call ourself in the future\r\n            setTimeout(Util.getCtxCallback(_this, _this.cacheExpirationHandler), RuntimeConfig.cacheExpirationIntervalMilliseconds);\r\n        }).catch(function (e) {\r\n            // we've got some error - so just stop the loop and report the error\r\n            __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"b\" /* Logger */].log({\r\n                data: e,\r\n                level: __WEBPACK_IMPORTED_MODULE_0__pnp_logging__[\"a\" /* LogLevel */].Error,\r\n                message: \"Error deleting expired cache entries, see data for details. Timeout not reset.\",\r\n            });\r\n        });\r\n    };\r\n    return PnPClientStorageWrapper;\r\n}());\r\n/**\r\n * A thin implementation of in-memory storage for use in nodejs\r\n */\r\nvar MemoryStorage = /** @class */ (function () {\r\n    function MemoryStorage(_store) {\r\n        if (_store === void 0) { _store = new Dictionary(); }\r\n        this._store = _store;\r\n    }\r\n    Object.defineProperty(MemoryStorage.prototype, \"length\", {\r\n        get: function () {\r\n            return this._store.count();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MemoryStorage.prototype.clear = function () {\r\n        this._store.clear();\r\n    };\r\n    MemoryStorage.prototype.getItem = function (key) {\r\n        return this._store.get(key);\r\n    };\r\n    MemoryStorage.prototype.key = function (index) {\r\n        return this._store.getKeys()[index];\r\n    };\r\n    MemoryStorage.prototype.removeItem = function (key) {\r\n        this._store.remove(key);\r\n    };\r\n    MemoryStorage.prototype.setItem = function (key, data) {\r\n        this._store.add(key, data);\r\n    };\r\n    return MemoryStorage;\r\n}());\r\n/**\r\n * A class that will establish wrappers for both local and session storage\r\n */\r\nvar PnPClientStorage = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the PnPClientStorage class\r\n     *\r\n     * @constructor\r\n     */\r\n    function PnPClientStorage(_local, _session) {\r\n        if (_local === void 0) { _local = null; }\r\n        if (_session === void 0) { _session = null; }\r\n        this._local = _local;\r\n        this._session = _session;\r\n    }\r\n    Object.defineProperty(PnPClientStorage.prototype, \"local\", {\r\n        /**\r\n         * Provides access to the local storage of the browser\r\n         */\r\n        get: function () {\r\n            if (this._local === null) {\r\n                this._local = typeof localStorage !== \"undefined\" ? new PnPClientStorageWrapper(localStorage) : new PnPClientStorageWrapper(new MemoryStorage());\r\n            }\r\n            return this._local;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PnPClientStorage.prototype, \"session\", {\r\n        /**\r\n         * Provides access to the session storage of the browser\r\n         */\r\n        get: function () {\r\n            if (this._session === null) {\r\n                this._session = typeof sessionStorage !== \"undefined\" ? new PnPClientStorageWrapper(sessionStorage) : new PnPClientStorageWrapper(new MemoryStorage());\r\n            }\r\n            return this._session;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return PnPClientStorage;\r\n}());\n\n\n//# sourceMappingURL=common.es5.js.map\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Logger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return LogLevel; });\n/* unused harmony export ConsoleListener */\n/* unused harmony export FunctionListener */\n/**\r\n * A set of logging levels\r\n *\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warning\"] = 2] = \"Warning\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Off\"] = 99] = \"Off\";\r\n})(LogLevel || (LogLevel = {}));\n\n/**\r\n * Class used to subscribe ILogListener and log messages throughout an application\r\n *\r\n */\r\nvar Logger = /** @class */ (function () {\r\n    function Logger() {\r\n    }\r\n    Object.defineProperty(Logger, \"activeLogLevel\", {\r\n        /**\r\n         * Gets or sets the active log level to apply for log filtering\r\n         */\r\n        get: function () {\r\n            return Logger.instance.activeLogLevel;\r\n        },\r\n        set: function (value) {\r\n            Logger.instance.activeLogLevel = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Logger, \"instance\", {\r\n        get: function () {\r\n            if (typeof Logger._instance === \"undefined\" || Logger._instance === null) {\r\n                Logger._instance = new LoggerImpl();\r\n            }\r\n            return Logger._instance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Adds ILogListener instances to the set of subscribed listeners\r\n     *\r\n     * @param listeners One or more listeners to subscribe to this log\r\n     */\r\n    Logger.subscribe = function () {\r\n        var listeners = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            listeners[_i] = arguments[_i];\r\n        }\r\n        listeners.map(function (listener) { return Logger.instance.subscribe(listener); });\r\n    };\r\n    /**\r\n     * Clears the subscribers collection, returning the collection before modifiction\r\n     */\r\n    Logger.clearSubscribers = function () {\r\n        return Logger.instance.clearSubscribers();\r\n    };\r\n    Object.defineProperty(Logger, \"count\", {\r\n        /**\r\n         * Gets the current subscriber count\r\n         */\r\n        get: function () {\r\n            return Logger.instance.count;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param message The message to write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    Logger.write = function (message, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        Logger.instance.log({ level: level, message: message });\r\n    };\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param json The json object to stringify and write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    Logger.writeJSON = function (json, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        Logger.instance.log({ level: level, message: JSON.stringify(json) });\r\n    };\r\n    /**\r\n     * Logs the supplied entry to the subscribed listeners\r\n     *\r\n     * @param entry The message to log\r\n     */\r\n    Logger.log = function (entry) {\r\n        Logger.instance.log(entry);\r\n    };\r\n    /**\r\n     * Logs performance tracking data for the the execution duration of the supplied function using console.profile\r\n     *\r\n     * @param name The name of this profile boundary\r\n     * @param f The function to execute and track within this performance boundary\r\n     */\r\n    Logger.measure = function (name, f) {\r\n        return Logger.instance.measure(name, f);\r\n    };\r\n    return Logger;\r\n}());\r\nvar LoggerImpl = /** @class */ (function () {\r\n    function LoggerImpl(activeLogLevel, subscribers) {\r\n        if (activeLogLevel === void 0) { activeLogLevel = LogLevel.Warning; }\r\n        if (subscribers === void 0) { subscribers = []; }\r\n        this.activeLogLevel = activeLogLevel;\r\n        this.subscribers = subscribers;\r\n    }\r\n    LoggerImpl.prototype.subscribe = function (listener) {\r\n        this.subscribers.push(listener);\r\n    };\r\n    LoggerImpl.prototype.clearSubscribers = function () {\r\n        var s = this.subscribers.slice(0);\r\n        this.subscribers.length = 0;\r\n        return s;\r\n    };\r\n    Object.defineProperty(LoggerImpl.prototype, \"count\", {\r\n        get: function () {\r\n            return this.subscribers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LoggerImpl.prototype.write = function (message, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        this.log({ level: level, message: message });\r\n    };\r\n    LoggerImpl.prototype.log = function (entry) {\r\n        if (typeof entry === \"undefined\" || entry.level < this.activeLogLevel) {\r\n            return;\r\n        }\r\n        this.subscribers.map(function (subscriber) { return subscriber.log(entry); });\r\n    };\r\n    LoggerImpl.prototype.measure = function (name, f) {\r\n        console.profile(name);\r\n        try {\r\n            return f();\r\n        }\r\n        finally {\r\n            console.profileEnd();\r\n        }\r\n    };\r\n    return LoggerImpl;\r\n}());\n\n/**\r\n * Implementation of ILogListener which logs to the browser console\r\n *\r\n */\r\nvar ConsoleListener = /** @class */ (function () {\r\n    function ConsoleListener() {\r\n    }\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    ConsoleListener.prototype.log = function (entry) {\r\n        var msg = this.format(entry);\r\n        switch (entry.level) {\r\n            case LogLevel.Verbose:\r\n            case LogLevel.Info:\r\n                console.log(msg);\r\n                break;\r\n            case LogLevel.Warning:\r\n                console.warn(msg);\r\n                break;\r\n            case LogLevel.Error:\r\n                console.error(msg);\r\n                break;\r\n        }\r\n    };\r\n    /**\r\n     * Formats the message\r\n     *\r\n     * @param entry The information to format into a string\r\n     */\r\n    ConsoleListener.prototype.format = function (entry) {\r\n        var msg = [];\r\n        msg.push(\"Message: \" + entry.message);\r\n        if (typeof entry.data !== \"undefined\") {\r\n            msg.push(\" Data: \" + JSON.stringify(entry.data));\r\n        }\r\n        return msg.join(\"\");\r\n    };\r\n    return ConsoleListener;\r\n}());\r\n/**\r\n * Implementation of ILogListener which logs to the supplied function\r\n *\r\n */\r\nvar FunctionListener = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the FunctionListener class\r\n     *\r\n     * @constructor\r\n     * @param  method The method to which any logging data will be passed\r\n     */\r\n    function FunctionListener(method) {\r\n        this.method = method;\r\n    }\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    FunctionListener.prototype.log = function (entry) {\r\n        this.method(entry);\r\n    };\r\n    return FunctionListener;\r\n}());\n\n\n//# sourceMappingURL=logging.es5.js.map\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = __extends;\n/* unused harmony export __assign */\n/* unused harmony export __rest */\n/* unused harmony export __decorate */\n/* unused harmony export __param */\n/* unused harmony export __metadata */\n/* unused harmony export __awaiter */\n/* unused harmony export __generator */\n/* unused harmony export __exportStar */\n/* unused harmony export __values */\n/* unused harmony export __read */\n/* unused harmony export __spread */\n/* unused harmony export __await */\n/* unused harmony export __asyncGenerator */\n/* unused harmony export __asyncDelegator */\n/* unused harmony export __asyncValues */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nfunction __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator.throw(value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nfunction __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nfunction __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nfunction __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nfunction __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nfunction __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__pnp_common__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__exceptions__ = __webpack_require__(4);\n\r\n\r\n/**\r\n * A caching provider which can wrap other non-caching providers\r\n *\r\n */\r\nvar CachingConfigurationProvider = /** @class */ (function () {\r\n    /**\r\n     * Creates a new caching configuration provider\r\n     * @constructor\r\n     * @param {IConfigurationProvider} wrappedProvider Provider which will be used to fetch the configuration\r\n     * @param {string} cacheKey Key that will be used to store cached items to the cache\r\n     * @param {IPnPClientStore} cacheStore OPTIONAL storage, which will be used to store cached settings.\r\n     */\r\n    function CachingConfigurationProvider(wrappedProvider, cacheKey, cacheStore) {\r\n        this.wrappedProvider = wrappedProvider;\r\n        this.store = (cacheStore) ? cacheStore : this.selectPnPCache();\r\n        this.cacheKey = \"_configcache_\" + cacheKey;\r\n    }\r\n    /**\r\n     * Gets the wrapped configuration providers\r\n     *\r\n     * @return {IConfigurationProvider} Wrapped configuration provider\r\n     */\r\n    CachingConfigurationProvider.prototype.getWrappedProvider = function () {\r\n        return this.wrappedProvider;\r\n    };\r\n    /**\r\n     * Loads the configuration values either from the cache or from the wrapped provider\r\n     *\r\n     * @return {Promise<TypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    CachingConfigurationProvider.prototype.getConfiguration = function () {\r\n        var _this = this;\r\n        // Cache not available, pass control to  the wrapped provider\r\n        if ((!this.store) || (!this.store.enabled)) {\r\n            return this.wrappedProvider.getConfiguration();\r\n        }\r\n        // Value is found in cache, return it directly\r\n        var cachedConfig = this.store.get(this.cacheKey);\r\n        if (cachedConfig) {\r\n            return new Promise(function (resolve) {\r\n                resolve(cachedConfig);\r\n            });\r\n        }\r\n        // Get and cache value from the wrapped provider\r\n        var providerPromise = this.wrappedProvider.getConfiguration();\r\n        providerPromise.then(function (providedConfig) {\r\n            _this.store.put(_this.cacheKey, providedConfig);\r\n        });\r\n        return providerPromise;\r\n    };\r\n    CachingConfigurationProvider.prototype.selectPnPCache = function () {\r\n        var pnpCache = new __WEBPACK_IMPORTED_MODULE_0__pnp_common__[\"b\" /* PnPClientStorage */]();\r\n        if ((pnpCache.local) && (pnpCache.local.enabled)) {\r\n            return pnpCache.local;\r\n        }\r\n        if ((pnpCache.session) && (pnpCache.session.enabled)) {\r\n            return pnpCache.session;\r\n        }\r\n        throw new __WEBPACK_IMPORTED_MODULE_1__exceptions__[\"a\" /* NoCacheAvailableException */]();\r\n    };\r\n    return CachingConfigurationProvider;\r\n}());\r\n/* harmony default export */ __webpack_exports__[\"a\"] = (CachingConfigurationProvider);\r\n//# sourceMappingURL=cachingConfigurationProvider.js.map\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return NoCacheAvailableException; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__pnp_logging__ = __webpack_require__(1);\n\r\n\r\nvar NoCacheAvailableException = /** @class */ (function (_super) {\r\n    __WEBPACK_IMPORTED_MODULE_0_tslib__[\"a\" /* __extends */](NoCacheAvailableException, _super);\r\n    function NoCacheAvailableException(msg) {\r\n        if (msg === void 0) { msg = \"Cannot create a caching configuration provider since cache is not available.\"; }\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"NoCacheAvailableException\";\r\n        __WEBPACK_IMPORTED_MODULE_1__pnp_logging__[\"b\" /* Logger */].log({ data: {}, level: __WEBPACK_IMPORTED_MODULE_1__pnp_logging__[\"a\" /* LogLevel */].Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return NoCacheAvailableException;\r\n}(Error));\r\n\r\n//# sourceMappingURL=exceptions.js.map\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__src_configstore__ = __webpack_require__(6);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Settings\", function() { return __WEBPACK_IMPORTED_MODULE_0__src_configstore__[\"d\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"CachingConfigurationProvider\", function() { return __WEBPACK_IMPORTED_MODULE_0__src_configstore__[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"SPListConfigurationProvider\", function() { return __WEBPACK_IMPORTED_MODULE_0__src_configstore__[\"c\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"NoCacheAvailableException\", function() { return __WEBPACK_IMPORTED_MODULE_0__src_configstore__[\"b\"]; });\n\r\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__configuration__ = __webpack_require__(7);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return __WEBPACK_IMPORTED_MODULE_0__configuration__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_index__ = __webpack_require__(8);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_1__providers_index__[\"a\"]; });\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return __WEBPACK_IMPORTED_MODULE_1__providers_index__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__exceptions__ = __webpack_require__(4);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_2__exceptions__[\"a\"]; });\n\r\n\r\n\r\n//# sourceMappingURL=configstore.js.map\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Settings; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__pnp_common__ = __webpack_require__(0);\n\r\n/**\r\n * Class used to manage the current application settings\r\n *\r\n */\r\nvar Settings = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the settings class\r\n     *\r\n     * @constructor\r\n     */\r\n    function Settings() {\r\n        this._settings = new __WEBPACK_IMPORTED_MODULE_0__pnp_common__[\"a\" /* Dictionary */]();\r\n    }\r\n    /**\r\n     * Adds a new single setting, or overwrites a previous setting with the same key\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {string} value The setting value to store\r\n     */\r\n    Settings.prototype.add = function (key, value) {\r\n        this._settings.add(key, value);\r\n    };\r\n    /**\r\n     * Adds a JSON value to the collection as a string, you must use getJSON to rehydrate the object when read\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {any} value The setting value to store\r\n     */\r\n    Settings.prototype.addJSON = function (key, value) {\r\n        this._settings.add(key, JSON.stringify(value));\r\n    };\r\n    /**\r\n     * Applies the supplied hash to the setting collection overwriting any existing value, or created new values\r\n     *\r\n     * @param {TypedHash<any>} hash The set of values to add\r\n     */\r\n    Settings.prototype.apply = function (hash) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            try {\r\n                _this._settings.merge(hash);\r\n                resolve();\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Loads configuration settings into the collection from the supplied provider and returns a Promise\r\n     *\r\n     * @param {IConfigurationProvider} provider The provider from which we will load the settings\r\n     */\r\n    Settings.prototype.load = function (provider) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            provider.getConfiguration().then(function (value) {\r\n                _this._settings.merge(value);\r\n                resolve();\r\n            }).catch(function (reason) {\r\n                reject(reason);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Gets a value from the configuration\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {string} string value from the configuration\r\n     */\r\n    Settings.prototype.get = function (key) {\r\n        return this._settings.get(key);\r\n    };\r\n    /**\r\n     * Gets a JSON value, rehydrating the stored string to the original object\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {any} object from the configuration\r\n     */\r\n    Settings.prototype.getJSON = function (key) {\r\n        var o = this.get(key);\r\n        if (typeof o === \"undefined\" || o === null) {\r\n            return o;\r\n        }\r\n        return JSON.parse(o);\r\n    };\r\n    return Settings;\r\n}());\r\n\r\n//# sourceMappingURL=configuration.js.map\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__cachingConfigurationProvider__ = __webpack_require__(3);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_0__cachingConfigurationProvider__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__spListConfigurationProvider__ = __webpack_require__(9);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__spListConfigurationProvider__[\"a\"]; });\n\r\n\r\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__cachingConfigurationProvider__ = __webpack_require__(3);\n\r\n/**\r\n * A configuration provider which loads configuration values from a SharePoint list\r\n *\r\n */\r\nvar SPListConfigurationProvider = /** @class */ (function () {\r\n    /**\r\n     * Creates a new SharePoint list based configuration provider\r\n     * @constructor\r\n     * @param {string} webUrl Url of the SharePoint site, where the configuration list is located\r\n     * @param {string} listTitle Title of the SharePoint list, which contains the configuration settings (optional, default = \"config\")\r\n     */\r\n    function SPListConfigurationProvider(sourceWeb, sourceListTitle) {\r\n        if (sourceListTitle === void 0) { sourceListTitle = \"config\"; }\r\n        this.sourceWeb = sourceWeb;\r\n        this.sourceListTitle = sourceListTitle;\r\n    }\r\n    Object.defineProperty(SPListConfigurationProvider.prototype, \"web\", {\r\n        /**\r\n         * Gets the url of the SharePoint site, where the configuration list is located\r\n         *\r\n         * @return {string} Url address of the site\r\n         */\r\n        get: function () {\r\n            return this.sourceWeb;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SPListConfigurationProvider.prototype, \"listTitle\", {\r\n        /**\r\n         * Gets the title of the SharePoint list, which contains the configuration settings\r\n         *\r\n         * @return {string} List title\r\n         */\r\n        get: function () {\r\n            return this.sourceListTitle;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Loads the configuration values from the SharePoint list\r\n     *\r\n     * @return {Promise<TypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    SPListConfigurationProvider.prototype.getConfiguration = function () {\r\n        return this.web.lists.getByTitle(this.listTitle).items.select(\"Title\", \"Value\")\r\n            .getAs().then(function (data) {\r\n            return data.reduce(function (configuration, item) {\r\n                return Object.defineProperty(configuration, item.Title, {\r\n                    configurable: false,\r\n                    enumerable: false,\r\n                    value: item.Value,\r\n                    writable: false,\r\n                });\r\n            }, {});\r\n        });\r\n    };\r\n    /**\r\n     * Wraps the current provider in a cache enabled provider\r\n     *\r\n     * @return {CachingConfigurationProvider} Caching providers which wraps the current provider\r\n     */\r\n    SPListConfigurationProvider.prototype.asCaching = function () {\r\n        var cacheKey = \"splist_\" + this.web.toUrl() + \"+\" + this.listTitle;\r\n        return new __WEBPACK_IMPORTED_MODULE_0__cachingConfigurationProvider__[\"a\" /* default */](this, cacheKey);\r\n    };\r\n    return SPListConfigurationProvider;\r\n}());\r\n/* harmony default export */ __webpack_exports__[\"a\"] = (SPListConfigurationProvider);\r\n//# sourceMappingURL=spListConfigurationProvider.js.map\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// config-store.es5.umd.bundle.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2089adffc6f376e0c2ba","import { LogLevel, Logger } from '@pnp/logging';\nimport { __extends } from 'tslib';\n\n/**\r\n * Reads a blob as text\r\n *\r\n * @param blob The data to read\r\n */\r\nfunction readBlobAsText(blob) {\r\n    return readBlobAs(blob, \"string\");\r\n}\r\n/**\r\n * Reads a blob into an array buffer\r\n *\r\n * @param blob The data to read\r\n */\r\nfunction readBlobAsArrayBuffer(blob) {\r\n    return readBlobAs(blob, \"buffer\");\r\n}\r\n/**\r\n * Generic method to read blob's content\r\n *\r\n * @param blob The data to read\r\n * @param mode The read mode\r\n */\r\nfunction readBlobAs(blob, mode) {\r\n    return new Promise(function (resolve, reject) {\r\n        try {\r\n            var reader = new FileReader();\r\n            reader.onload = function (e) {\r\n                resolve(e.target.result);\r\n            };\r\n            switch (mode) {\r\n                case \"string\":\r\n                    reader.readAsText(blob);\r\n                    break;\r\n                case \"buffer\":\r\n                    reader.readAsArrayBuffer(blob);\r\n                    break;\r\n            }\r\n        }\r\n        catch (e) {\r\n            reject(e);\r\n        }\r\n    });\r\n}\n\n/**\r\n * Generic dictionary\r\n */\r\nvar Dictionary = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the Dictionary<T> class\r\n     *\r\n     * @constructor\r\n     */\r\n    function Dictionary(keys, values) {\r\n        if (keys === void 0) { keys = []; }\r\n        if (values === void 0) { values = []; }\r\n        this.keys = keys;\r\n        this.values = values;\r\n    }\r\n    /**\r\n     * Gets a value from the collection using the specified key\r\n     *\r\n     * @param key The key whose value we want to return, returns null if the key does not exist\r\n     */\r\n    Dictionary.prototype.get = function (key) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index < 0) {\r\n            return null;\r\n        }\r\n        return this.values[index];\r\n    };\r\n    /**\r\n     * Adds the supplied key and value to the dictionary\r\n     *\r\n     * @param key The key to add\r\n     * @param o The value to add\r\n     */\r\n    Dictionary.prototype.add = function (key, o) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index > -1) {\r\n            if (o === null) {\r\n                this.remove(key);\r\n            }\r\n            else {\r\n                this.values[index] = o;\r\n            }\r\n        }\r\n        else {\r\n            if (o !== null) {\r\n                this.keys.push(key);\r\n                this.values.push(o);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Merges the supplied typed hash into this dictionary instance. Existing values are updated and new ones are created as appropriate.\r\n     */\r\n    Dictionary.prototype.merge = function (source) {\r\n        var _this = this;\r\n        if (\"getKeys\" in source) {\r\n            var sourceAsDictionary_1 = source;\r\n            sourceAsDictionary_1.getKeys().map(function (key) {\r\n                _this.add(key, sourceAsDictionary_1.get(key));\r\n            });\r\n        }\r\n        else {\r\n            var sourceAsHash = source;\r\n            for (var key in sourceAsHash) {\r\n                if (sourceAsHash.hasOwnProperty(key)) {\r\n                    this.add(key, sourceAsHash[key]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Removes a value from the dictionary\r\n     *\r\n     * @param key The key of the key/value pair to remove. Returns null if the key was not found.\r\n     */\r\n    Dictionary.prototype.remove = function (key) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index < 0) {\r\n            return null;\r\n        }\r\n        var val = this.values[index];\r\n        this.keys.splice(index, 1);\r\n        this.values.splice(index, 1);\r\n        return val;\r\n    };\r\n    /**\r\n     * Returns all the keys currently in the dictionary as an array\r\n     */\r\n    Dictionary.prototype.getKeys = function () {\r\n        return this.keys;\r\n    };\r\n    /**\r\n     * Returns all the values currently in the dictionary as an array\r\n     */\r\n    Dictionary.prototype.getValues = function () {\r\n        return this.values;\r\n    };\r\n    /**\r\n     * Clears the current dictionary\r\n     */\r\n    Dictionary.prototype.clear = function () {\r\n        this.keys = [];\r\n        this.values = [];\r\n    };\r\n    /**\r\n     * Gets a count of the items currently in the dictionary\r\n     */\r\n    Dictionary.prototype.count = function () {\r\n        return this.keys.length;\r\n    };\r\n    return Dictionary;\r\n}());\n\nvar Util = /** @class */ (function () {\r\n    function Util() {\r\n    }\r\n    /**\r\n     * Gets a callback function which will maintain context across async calls.\r\n     * Allows for the calling pattern getCtxCallback(thisobj, method, methodarg1, methodarg2, ...)\r\n     *\r\n     * @param context The object that will be the 'this' value in the callback\r\n     * @param method The method to which we will apply the context and parameters\r\n     * @param params Optional, additional arguments to supply to the wrapped method when it is invoked\r\n     */\r\n    Util.getCtxCallback = function (context, method) {\r\n        var params = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            params[_i - 2] = arguments[_i];\r\n        }\r\n        return function () {\r\n            method.apply(context, params);\r\n        };\r\n    };\r\n    /**\r\n     * Tests if a url param exists\r\n     *\r\n     * @param name The name of the url paramter to check\r\n     */\r\n    Util.urlParamExists = function (name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\r\n        return regex.test(location.search);\r\n    };\r\n    /**\r\n     * Gets a url param value by name\r\n     *\r\n     * @param name The name of the paramter for which we want the value\r\n     */\r\n    Util.getUrlParamByName = function (name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\r\n        var results = regex.exec(location.search);\r\n        return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n    };\r\n    /**\r\n     * Gets a url param by name and attempts to parse a bool value\r\n     *\r\n     * @param name The name of the paramter for which we want the boolean value\r\n     */\r\n    Util.getUrlParamBoolByName = function (name) {\r\n        var p = this.getUrlParamByName(name);\r\n        var isFalse = (p === \"\" || /false|0/i.test(p));\r\n        return !isFalse;\r\n    };\r\n    /**\r\n     * Inserts the string s into the string target as the index specified by index\r\n     *\r\n     * @param target The string into which we will insert s\r\n     * @param index The location in target to insert s (zero based)\r\n     * @param s The string to insert into target at position index\r\n     */\r\n    Util.stringInsert = function (target, index, s) {\r\n        if (index > 0) {\r\n            return target.substring(0, index) + s + target.substring(index, target.length);\r\n        }\r\n        return s + target;\r\n    };\r\n    /**\r\n     * Adds a value to a date\r\n     *\r\n     * @param date The date to which we will add units, done in local time\r\n     * @param interval The name of the interval to add, one of: ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second']\r\n     * @param units The amount to add to date of the given interval\r\n     *\r\n     * http://stackoverflow.com/questions/1197928/how-to-add-30-minutes-to-a-javascript-date-object\r\n     */\r\n    Util.dateAdd = function (date, interval, units) {\r\n        var ret = new Date(date); // don't change original date\r\n        switch (interval.toLowerCase()) {\r\n            case \"year\":\r\n                ret.setFullYear(ret.getFullYear() + units);\r\n                break;\r\n            case \"quarter\":\r\n                ret.setMonth(ret.getMonth() + 3 * units);\r\n                break;\r\n            case \"month\":\r\n                ret.setMonth(ret.getMonth() + units);\r\n                break;\r\n            case \"week\":\r\n                ret.setDate(ret.getDate() + 7 * units);\r\n                break;\r\n            case \"day\":\r\n                ret.setDate(ret.getDate() + units);\r\n                break;\r\n            case \"hour\":\r\n                ret.setTime(ret.getTime() + units * 3600000);\r\n                break;\r\n            case \"minute\":\r\n                ret.setTime(ret.getTime() + units * 60000);\r\n                break;\r\n            case \"second\":\r\n                ret.setTime(ret.getTime() + units * 1000);\r\n                break;\r\n            default:\r\n                ret = undefined;\r\n                break;\r\n        }\r\n        return ret;\r\n    };\r\n    /**\r\n     * Loads a stylesheet into the current page\r\n     *\r\n     * @param path The url to the stylesheet\r\n     * @param avoidCache If true a value will be appended as a query string to avoid browser caching issues\r\n     */\r\n    Util.loadStylesheet = function (path, avoidCache) {\r\n        if (avoidCache) {\r\n            path += \"?\" + encodeURIComponent((new Date()).getTime().toString());\r\n        }\r\n        var head = document.getElementsByTagName(\"head\");\r\n        if (head.length > 0) {\r\n            var e = document.createElement(\"link\");\r\n            head[0].appendChild(e);\r\n            e.setAttribute(\"type\", \"text/css\");\r\n            e.setAttribute(\"rel\", \"stylesheet\");\r\n            e.setAttribute(\"href\", path);\r\n        }\r\n    };\r\n    /**\r\n     * Combines an arbitrary set of paths ensuring that the slashes are normalized\r\n     *\r\n     * @param paths 0 to n path parts to combine\r\n     */\r\n    Util.combinePaths = function () {\r\n        var paths = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            paths[_i] = arguments[_i];\r\n        }\r\n        return paths\r\n            .filter(function (path) { return !Util.stringIsNullOrEmpty(path); })\r\n            .map(function (path) { return path.replace(/^[\\\\|\\/]/, \"\").replace(/[\\\\|\\/]$/, \"\"); })\r\n            .join(\"/\")\r\n            .replace(/\\\\/g, \"/\");\r\n    };\r\n    /**\r\n     * Gets a random string of chars length\r\n     *\r\n     * @param chars The length of the random string to generate\r\n     */\r\n    Util.getRandomString = function (chars) {\r\n        var text = new Array(chars);\r\n        var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n        for (var i = 0; i < chars; i++) {\r\n            text[i] = possible.charAt(Math.floor(Math.random() * possible.length));\r\n        }\r\n        return text.join(\"\");\r\n    };\r\n    /**\r\n     * Gets a random GUID value\r\n     *\r\n     * http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\r\n     */\r\n    /* tslint:disable no-bitwise */\r\n    Util.getGUID = function () {\r\n        var d = new Date().getTime();\r\n        var guid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\r\n            var r = (d + Math.random() * 16) % 16 | 0;\r\n            d = Math.floor(d / 16);\r\n            return (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\r\n        });\r\n        return guid;\r\n    };\r\n    /* tslint:enable */\r\n    /**\r\n     * Determines if a given value is a function\r\n     *\r\n     * @param candidateFunction The thing to test for being a function\r\n     */\r\n    Util.isFunction = function (candidateFunction) {\r\n        return typeof candidateFunction === \"function\";\r\n    };\r\n    /**\r\n     * Determines if an object is both defined and not null\r\n     * @param obj Object to test\r\n     */\r\n    Util.objectDefinedNotNull = function (obj) {\r\n        return typeof obj !== \"undefined\" && obj !== null;\r\n    };\r\n    /**\r\n     * @returns whether the provided parameter is a JavaScript Array or not.\r\n    */\r\n    Util.isArray = function (array) {\r\n        if (Array.isArray) {\r\n            return Array.isArray(array);\r\n        }\r\n        return array && typeof array.length === \"number\" && array.constructor === Array;\r\n    };\r\n    /**\r\n     * Determines if a string is null or empty or undefined\r\n     *\r\n     * @param s The string to test\r\n     */\r\n    Util.stringIsNullOrEmpty = function (s) {\r\n        return typeof s === \"undefined\" || s === null || s.length < 1;\r\n    };\r\n    /**\r\n     * Provides functionality to extend the given object by doing a shallow copy\r\n     *\r\n     * @param target The object to which properties will be copied\r\n     * @param source The source object from which properties will be copied\r\n     * @param noOverwrite If true existing properties on the target are not overwritten from the source\r\n     *\r\n     */\r\n    Util.extend = function (target, source, noOverwrite) {\r\n        if (noOverwrite === void 0) { noOverwrite = false; }\r\n        if (!Util.objectDefinedNotNull(source)) {\r\n            return target;\r\n        }\r\n        // ensure we don't overwrite things we don't want overwritten\r\n        var check = noOverwrite ? function (o, i) { return !(i in o); } : function () { return true; };\r\n        return Object.getOwnPropertyNames(source)\r\n            .filter(function (v) { return check(target, v); })\r\n            .reduce(function (t, v) {\r\n            t[v] = source[v];\r\n            return t;\r\n        }, target);\r\n    };\r\n    /**\r\n     * Determines if a given url is absolute\r\n     *\r\n     * @param url The url to check to see if it is absolute\r\n     */\r\n    Util.isUrlAbsolute = function (url) {\r\n        return /^https?:\\/\\/|^\\/\\//i.test(url);\r\n    };\r\n    return Util;\r\n}());\n\nfunction mergeOptions(target, source) {\r\n    if (Util.objectDefinedNotNull(source)) {\r\n        var headers = Util.extend(target.headers || {}, source.headers);\r\n        target = Util.extend(target, source);\r\n        target.headers = headers;\r\n    }\r\n}\n\nfunction deprecated(deprecationVersion, message) {\r\n    return function (target, propertyKey, descriptor) {\r\n        var method = descriptor.value;\r\n        descriptor.value = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            Logger.log({\r\n                data: {\r\n                    descriptor: descriptor,\r\n                    propertyKey: propertyKey,\r\n                    target: target,\r\n                },\r\n                level: LogLevel.Warning,\r\n                message: \"(\" + deprecationVersion + \") \" + message,\r\n            });\r\n            return method.apply(this, args);\r\n        };\r\n    };\r\n}\r\nfunction beta(message) {\r\n    if (message === void 0) { message = \"This feature is flagged as beta and is subject to change.\"; }\r\n    return function (target, propertyKey, descriptor) {\r\n        var method = descriptor.value;\r\n        descriptor.value = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            Logger.log({\r\n                data: {\r\n                    descriptor: descriptor,\r\n                    propertyKey: propertyKey,\r\n                    target: target,\r\n                },\r\n                level: LogLevel.Warning,\r\n                message: message,\r\n            });\r\n            return method.apply(this, args);\r\n        };\r\n    };\r\n}\n\nvar FunctionExpectedException = /** @class */ (function (_super) {\r\n    __extends(FunctionExpectedException, _super);\r\n    function FunctionExpectedException(msg) {\r\n        if (msg === void 0) { msg = \"Expected a function.\"; }\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"FunctionExpectedException\";\r\n        Logger.log({ data: {}, level: LogLevel.Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return FunctionExpectedException;\r\n}(Error));\r\nvar UrlException = /** @class */ (function (_super) {\r\n    __extends(UrlException, _super);\r\n    function UrlException(msg) {\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"UrlException\";\r\n        Logger.log({ data: {}, level: LogLevel.Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return UrlException;\r\n}(Error));\n\nvar CommonRuntimeConfigKeys = /** @class */ (function () {\r\n    function CommonRuntimeConfigKeys() {\r\n    }\r\n    CommonRuntimeConfigKeys.defaultCachingStore = \"defaultCachingStore\";\r\n    CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds = \"defaultCachingTimeoutSeconds\";\r\n    CommonRuntimeConfigKeys.globalCacheDisable = \"globalCacheDisable\";\r\n    CommonRuntimeConfigKeys.enableCacheExpiration = \"enableCacheExpiration\";\r\n    CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds = \"cacheExpirationIntervalMilliseconds\";\r\n    CommonRuntimeConfigKeys.spfxContext = \"spfxContext\";\r\n    return CommonRuntimeConfigKeys;\r\n}());\r\nvar RuntimeConfigImpl = /** @class */ (function () {\r\n    function RuntimeConfigImpl() {\r\n        this._v = new Dictionary();\r\n        // setup defaults\r\n        this._v.add(CommonRuntimeConfigKeys.defaultCachingStore, \"session\");\r\n        this._v.add(CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds, 60);\r\n        this._v.add(CommonRuntimeConfigKeys.globalCacheDisable, false);\r\n        this._v.add(CommonRuntimeConfigKeys.enableCacheExpiration, false);\r\n        this._v.add(CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds, 750);\r\n        this._v.add(CommonRuntimeConfigKeys.spfxContext, null);\r\n    }\r\n    /**\r\n     *\r\n     * @param config The set of properties to add to the globa configuration instance\r\n     */\r\n    RuntimeConfigImpl.prototype.extend = function (config) {\r\n        var _this = this;\r\n        Object.keys(config).forEach(function (key) {\r\n            _this._v.add(key, config[key]);\r\n        });\r\n    };\r\n    RuntimeConfigImpl.prototype.get = function (key) {\r\n        return this._v.get(key);\r\n    };\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingStore\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.defaultCachingStore);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingTimeoutSeconds\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.defaultCachingTimeoutSeconds);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"globalCacheDisable\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.globalCacheDisable);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"enableCacheExpiration\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.enableCacheExpiration);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"cacheExpirationIntervalMilliseconds\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.cacheExpirationIntervalMilliseconds);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RuntimeConfigImpl.prototype, \"spfxContext\", {\r\n        get: function () {\r\n            return this.get(CommonRuntimeConfigKeys.spfxContext);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return RuntimeConfigImpl;\r\n}());\r\nvar _runtimeConfig = new RuntimeConfigImpl();\r\nvar RuntimeConfig = _runtimeConfig;\n\nfunction mergeHeaders(target, source) {\r\n    if (typeof source !== \"undefined\" && source !== null) {\r\n        var temp = new Request(\"\", { headers: source });\r\n        temp.headers.forEach(function (value, name) {\r\n            target.append(name, value);\r\n        });\r\n    }\r\n}\n\n/**\r\n * A wrapper class to provide a consistent interface to browser based storage\r\n *\r\n */\r\nvar PnPClientStorageWrapper = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the PnPClientStorageWrapper class\r\n     *\r\n     * @constructor\r\n     */\r\n    function PnPClientStorageWrapper(store, defaultTimeoutMinutes) {\r\n        if (defaultTimeoutMinutes === void 0) { defaultTimeoutMinutes = -1; }\r\n        this.store = store;\r\n        this.defaultTimeoutMinutes = defaultTimeoutMinutes;\r\n        this.enabled = this.test();\r\n        // if the cache timeout is enabled call the handler\r\n        // this will clear any expired items and set the timeout function\r\n        if (RuntimeConfig.enableCacheExpiration) {\r\n            Logger.write(\"Enabling cache expiration.\", LogLevel.Info);\r\n            this.cacheExpirationHandler();\r\n        }\r\n    }\r\n    /**\r\n     * Get a value from storage, or null if that value does not exist\r\n     *\r\n     * @param key The key whose value we want to retrieve\r\n     */\r\n    PnPClientStorageWrapper.prototype.get = function (key) {\r\n        if (!this.enabled) {\r\n            return null;\r\n        }\r\n        var o = this.store.getItem(key);\r\n        if (o == null) {\r\n            return null;\r\n        }\r\n        var persistable = JSON.parse(o);\r\n        if (new Date(persistable.expiration) <= new Date()) {\r\n            Logger.write(\"Removing item with key '\" + key + \"' from cache due to expiration.\", LogLevel.Info);\r\n            this.delete(key);\r\n            return null;\r\n        }\r\n        else {\r\n            return persistable.value;\r\n        }\r\n    };\r\n    /**\r\n     * Adds a value to the underlying storage\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param o The value to store\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    PnPClientStorageWrapper.prototype.put = function (key, o, expire) {\r\n        if (this.enabled) {\r\n            this.store.setItem(key, this.createPersistable(o, expire));\r\n        }\r\n    };\r\n    /**\r\n     * Deletes a value from the underlying storage\r\n     *\r\n     * @param key The key of the pair we want to remove from storage\r\n     */\r\n    PnPClientStorageWrapper.prototype.delete = function (key) {\r\n        if (this.enabled) {\r\n            this.store.removeItem(key);\r\n        }\r\n    };\r\n    /**\r\n     * Gets an item from the underlying storage, or adds it if it does not exist using the supplied getter function\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param getter A function which will upon execution provide the desired value\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    PnPClientStorageWrapper.prototype.getOrPut = function (key, getter, expire) {\r\n        var _this = this;\r\n        if (!this.enabled) {\r\n            return getter();\r\n        }\r\n        return new Promise(function (resolve) {\r\n            var o = _this.get(key);\r\n            if (o == null) {\r\n                getter().then(function (d) {\r\n                    _this.put(key, d, expire);\r\n                    resolve(d);\r\n                });\r\n            }\r\n            else {\r\n                resolve(o);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Deletes any expired items placed in the store by the pnp library, leaves other items untouched\r\n     */\r\n    PnPClientStorageWrapper.prototype.deleteExpired = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this.enabled) {\r\n                resolve();\r\n            }\r\n            try {\r\n                for (var i = 0; i < _this.store.length; i++) {\r\n                    var key = _this.store.key(i);\r\n                    if (key !== null) {\r\n                        // test the stored item to see if we stored it\r\n                        if (/[\"|']?pnp[\"|']? ?: ?1/i.test(_this.store.getItem(key))) {\r\n                            // get those items as get will delete from cache if they are expired\r\n                            _this.get(key);\r\n                        }\r\n                    }\r\n                }\r\n                resolve();\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Used to determine if the wrapped storage is available currently\r\n     */\r\n    PnPClientStorageWrapper.prototype.test = function () {\r\n        var str = \"test\";\r\n        try {\r\n            this.store.setItem(str, str);\r\n            this.store.removeItem(str);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Creates the persistable to store\r\n     */\r\n    PnPClientStorageWrapper.prototype.createPersistable = function (o, expire) {\r\n        if (typeof expire === \"undefined\") {\r\n            // ensure we are by default inline with the global library setting\r\n            var defaultTimeout = RuntimeConfig.defaultCachingTimeoutSeconds;\r\n            if (this.defaultTimeoutMinutes > 0) {\r\n                defaultTimeout = this.defaultTimeoutMinutes * 60;\r\n            }\r\n            expire = Util.dateAdd(new Date(), \"second\", defaultTimeout);\r\n        }\r\n        return JSON.stringify({ pnp: 1, expiration: expire, value: o });\r\n    };\r\n    /**\r\n     * Deletes expired items added by this library in this.store and sets a timeout to call itself\r\n     */\r\n    PnPClientStorageWrapper.prototype.cacheExpirationHandler = function () {\r\n        var _this = this;\r\n        Logger.write(\"Called cache expiration handler.\", LogLevel.Verbose);\r\n        this.deleteExpired().then(function (_) {\r\n            // call ourself in the future\r\n            setTimeout(Util.getCtxCallback(_this, _this.cacheExpirationHandler), RuntimeConfig.cacheExpirationIntervalMilliseconds);\r\n        }).catch(function (e) {\r\n            // we've got some error - so just stop the loop and report the error\r\n            Logger.log({\r\n                data: e,\r\n                level: LogLevel.Error,\r\n                message: \"Error deleting expired cache entries, see data for details. Timeout not reset.\",\r\n            });\r\n        });\r\n    };\r\n    return PnPClientStorageWrapper;\r\n}());\r\n/**\r\n * A thin implementation of in-memory storage for use in nodejs\r\n */\r\nvar MemoryStorage = /** @class */ (function () {\r\n    function MemoryStorage(_store) {\r\n        if (_store === void 0) { _store = new Dictionary(); }\r\n        this._store = _store;\r\n    }\r\n    Object.defineProperty(MemoryStorage.prototype, \"length\", {\r\n        get: function () {\r\n            return this._store.count();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MemoryStorage.prototype.clear = function () {\r\n        this._store.clear();\r\n    };\r\n    MemoryStorage.prototype.getItem = function (key) {\r\n        return this._store.get(key);\r\n    };\r\n    MemoryStorage.prototype.key = function (index) {\r\n        return this._store.getKeys()[index];\r\n    };\r\n    MemoryStorage.prototype.removeItem = function (key) {\r\n        this._store.remove(key);\r\n    };\r\n    MemoryStorage.prototype.setItem = function (key, data) {\r\n        this._store.add(key, data);\r\n    };\r\n    return MemoryStorage;\r\n}());\r\n/**\r\n * A class that will establish wrappers for both local and session storage\r\n */\r\nvar PnPClientStorage = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the PnPClientStorage class\r\n     *\r\n     * @constructor\r\n     */\r\n    function PnPClientStorage(_local, _session) {\r\n        if (_local === void 0) { _local = null; }\r\n        if (_session === void 0) { _session = null; }\r\n        this._local = _local;\r\n        this._session = _session;\r\n    }\r\n    Object.defineProperty(PnPClientStorage.prototype, \"local\", {\r\n        /**\r\n         * Provides access to the local storage of the browser\r\n         */\r\n        get: function () {\r\n            if (this._local === null) {\r\n                this._local = typeof localStorage !== \"undefined\" ? new PnPClientStorageWrapper(localStorage) : new PnPClientStorageWrapper(new MemoryStorage());\r\n            }\r\n            return this._local;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PnPClientStorage.prototype, \"session\", {\r\n        /**\r\n         * Provides access to the session storage of the browser\r\n         */\r\n        get: function () {\r\n            if (this._session === null) {\r\n                this._session = typeof sessionStorage !== \"undefined\" ? new PnPClientStorageWrapper(sessionStorage) : new PnPClientStorageWrapper(new MemoryStorage());\r\n            }\r\n            return this._session;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return PnPClientStorage;\r\n}());\n\nexport { Util, readBlobAsText, readBlobAsArrayBuffer, Dictionary, mergeOptions, deprecated, beta, FunctionExpectedException, UrlException, CommonRuntimeConfigKeys, RuntimeConfigImpl, RuntimeConfig, mergeHeaders, PnPClientStorageWrapper, PnPClientStorage };\n//# sourceMappingURL=common.es5.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./dist/packages/common/dist/common.es5.js\n// module id = 0\n// module chunks = 0","/**\r\n * A set of logging levels\r\n *\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warning\"] = 2] = \"Warning\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Off\"] = 99] = \"Off\";\r\n})(LogLevel || (LogLevel = {}));\n\n/**\r\n * Class used to subscribe ILogListener and log messages throughout an application\r\n *\r\n */\r\nvar Logger = /** @class */ (function () {\r\n    function Logger() {\r\n    }\r\n    Object.defineProperty(Logger, \"activeLogLevel\", {\r\n        /**\r\n         * Gets or sets the active log level to apply for log filtering\r\n         */\r\n        get: function () {\r\n            return Logger.instance.activeLogLevel;\r\n        },\r\n        set: function (value) {\r\n            Logger.instance.activeLogLevel = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Logger, \"instance\", {\r\n        get: function () {\r\n            if (typeof Logger._instance === \"undefined\" || Logger._instance === null) {\r\n                Logger._instance = new LoggerImpl();\r\n            }\r\n            return Logger._instance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Adds ILogListener instances to the set of subscribed listeners\r\n     *\r\n     * @param listeners One or more listeners to subscribe to this log\r\n     */\r\n    Logger.subscribe = function () {\r\n        var listeners = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            listeners[_i] = arguments[_i];\r\n        }\r\n        listeners.map(function (listener) { return Logger.instance.subscribe(listener); });\r\n    };\r\n    /**\r\n     * Clears the subscribers collection, returning the collection before modifiction\r\n     */\r\n    Logger.clearSubscribers = function () {\r\n        return Logger.instance.clearSubscribers();\r\n    };\r\n    Object.defineProperty(Logger, \"count\", {\r\n        /**\r\n         * Gets the current subscriber count\r\n         */\r\n        get: function () {\r\n            return Logger.instance.count;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param message The message to write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    Logger.write = function (message, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        Logger.instance.log({ level: level, message: message });\r\n    };\r\n    /**\r\n     * Writes the supplied string to the subscribed listeners\r\n     *\r\n     * @param json The json object to stringify and write\r\n     * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Verbose)\r\n     */\r\n    Logger.writeJSON = function (json, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        Logger.instance.log({ level: level, message: JSON.stringify(json) });\r\n    };\r\n    /**\r\n     * Logs the supplied entry to the subscribed listeners\r\n     *\r\n     * @param entry The message to log\r\n     */\r\n    Logger.log = function (entry) {\r\n        Logger.instance.log(entry);\r\n    };\r\n    /**\r\n     * Logs performance tracking data for the the execution duration of the supplied function using console.profile\r\n     *\r\n     * @param name The name of this profile boundary\r\n     * @param f The function to execute and track within this performance boundary\r\n     */\r\n    Logger.measure = function (name, f) {\r\n        return Logger.instance.measure(name, f);\r\n    };\r\n    return Logger;\r\n}());\r\nvar LoggerImpl = /** @class */ (function () {\r\n    function LoggerImpl(activeLogLevel, subscribers) {\r\n        if (activeLogLevel === void 0) { activeLogLevel = LogLevel.Warning; }\r\n        if (subscribers === void 0) { subscribers = []; }\r\n        this.activeLogLevel = activeLogLevel;\r\n        this.subscribers = subscribers;\r\n    }\r\n    LoggerImpl.prototype.subscribe = function (listener) {\r\n        this.subscribers.push(listener);\r\n    };\r\n    LoggerImpl.prototype.clearSubscribers = function () {\r\n        var s = this.subscribers.slice(0);\r\n        this.subscribers.length = 0;\r\n        return s;\r\n    };\r\n    Object.defineProperty(LoggerImpl.prototype, \"count\", {\r\n        get: function () {\r\n            return this.subscribers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LoggerImpl.prototype.write = function (message, level) {\r\n        if (level === void 0) { level = LogLevel.Verbose; }\r\n        this.log({ level: level, message: message });\r\n    };\r\n    LoggerImpl.prototype.log = function (entry) {\r\n        if (typeof entry === \"undefined\" || entry.level < this.activeLogLevel) {\r\n            return;\r\n        }\r\n        this.subscribers.map(function (subscriber) { return subscriber.log(entry); });\r\n    };\r\n    LoggerImpl.prototype.measure = function (name, f) {\r\n        console.profile(name);\r\n        try {\r\n            return f();\r\n        }\r\n        finally {\r\n            console.profileEnd();\r\n        }\r\n    };\r\n    return LoggerImpl;\r\n}());\n\n/**\r\n * Implementation of ILogListener which logs to the browser console\r\n *\r\n */\r\nvar ConsoleListener = /** @class */ (function () {\r\n    function ConsoleListener() {\r\n    }\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    ConsoleListener.prototype.log = function (entry) {\r\n        var msg = this.format(entry);\r\n        switch (entry.level) {\r\n            case LogLevel.Verbose:\r\n            case LogLevel.Info:\r\n                console.log(msg);\r\n                break;\r\n            case LogLevel.Warning:\r\n                console.warn(msg);\r\n                break;\r\n            case LogLevel.Error:\r\n                console.error(msg);\r\n                break;\r\n        }\r\n    };\r\n    /**\r\n     * Formats the message\r\n     *\r\n     * @param entry The information to format into a string\r\n     */\r\n    ConsoleListener.prototype.format = function (entry) {\r\n        var msg = [];\r\n        msg.push(\"Message: \" + entry.message);\r\n        if (typeof entry.data !== \"undefined\") {\r\n            msg.push(\" Data: \" + JSON.stringify(entry.data));\r\n        }\r\n        return msg.join(\"\");\r\n    };\r\n    return ConsoleListener;\r\n}());\r\n/**\r\n * Implementation of ILogListener which logs to the supplied function\r\n *\r\n */\r\nvar FunctionListener = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the FunctionListener class\r\n     *\r\n     * @constructor\r\n     * @param  method The method to which any logging data will be passed\r\n     */\r\n    function FunctionListener(method) {\r\n        this.method = method;\r\n    }\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    FunctionListener.prototype.log = function (entry) {\r\n        this.method(entry);\r\n    };\r\n    return FunctionListener;\r\n}());\n\nexport { Logger, LogLevel, ConsoleListener, FunctionListener };\n//# sourceMappingURL=logging.es5.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./dist/packages/logging/dist/logging.es5.js\n// module id = 1\n// module chunks = 0","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator.throw(value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/tslib/tslib.es6.js\n// module id = 2\n// module chunks = 0","import { PnPClientStorage } from \"@pnp/common\";\r\nimport { NoCacheAvailableException } from \"../exceptions\";\r\n/**\r\n * A caching provider which can wrap other non-caching providers\r\n *\r\n */\r\nvar CachingConfigurationProvider = /** @class */ (function () {\r\n    /**\r\n     * Creates a new caching configuration provider\r\n     * @constructor\r\n     * @param {IConfigurationProvider} wrappedProvider Provider which will be used to fetch the configuration\r\n     * @param {string} cacheKey Key that will be used to store cached items to the cache\r\n     * @param {IPnPClientStore} cacheStore OPTIONAL storage, which will be used to store cached settings.\r\n     */\r\n    function CachingConfigurationProvider(wrappedProvider, cacheKey, cacheStore) {\r\n        this.wrappedProvider = wrappedProvider;\r\n        this.store = (cacheStore) ? cacheStore : this.selectPnPCache();\r\n        this.cacheKey = \"_configcache_\" + cacheKey;\r\n    }\r\n    /**\r\n     * Gets the wrapped configuration providers\r\n     *\r\n     * @return {IConfigurationProvider} Wrapped configuration provider\r\n     */\r\n    CachingConfigurationProvider.prototype.getWrappedProvider = function () {\r\n        return this.wrappedProvider;\r\n    };\r\n    /**\r\n     * Loads the configuration values either from the cache or from the wrapped provider\r\n     *\r\n     * @return {Promise<TypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    CachingConfigurationProvider.prototype.getConfiguration = function () {\r\n        var _this = this;\r\n        // Cache not available, pass control to  the wrapped provider\r\n        if ((!this.store) || (!this.store.enabled)) {\r\n            return this.wrappedProvider.getConfiguration();\r\n        }\r\n        // Value is found in cache, return it directly\r\n        var cachedConfig = this.store.get(this.cacheKey);\r\n        if (cachedConfig) {\r\n            return new Promise(function (resolve) {\r\n                resolve(cachedConfig);\r\n            });\r\n        }\r\n        // Get and cache value from the wrapped provider\r\n        var providerPromise = this.wrappedProvider.getConfiguration();\r\n        providerPromise.then(function (providedConfig) {\r\n            _this.store.put(_this.cacheKey, providedConfig);\r\n        });\r\n        return providerPromise;\r\n    };\r\n    CachingConfigurationProvider.prototype.selectPnPCache = function () {\r\n        var pnpCache = new PnPClientStorage();\r\n        if ((pnpCache.local) && (pnpCache.local.enabled)) {\r\n            return pnpCache.local;\r\n        }\r\n        if ((pnpCache.session) && (pnpCache.session.enabled)) {\r\n            return pnpCache.session;\r\n        }\r\n        throw new NoCacheAvailableException();\r\n    };\r\n    return CachingConfigurationProvider;\r\n}());\r\nexport default CachingConfigurationProvider;\r\n//# sourceMappingURL=cachingConfigurationProvider.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./build/packages/config-store/es5/src/providers/cachingConfigurationProvider.js\n// module id = 3\n// module chunks = 0","import * as tslib_1 from \"tslib\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nvar NoCacheAvailableException = /** @class */ (function (_super) {\r\n    tslib_1.__extends(NoCacheAvailableException, _super);\r\n    function NoCacheAvailableException(msg) {\r\n        if (msg === void 0) { msg = \"Cannot create a caching configuration provider since cache is not available.\"; }\r\n        var _this = _super.call(this, msg) || this;\r\n        _this.name = \"NoCacheAvailableException\";\r\n        Logger.log({ data: {}, level: LogLevel.Error, message: \"[\" + _this.name + \"]::\" + _this.message });\r\n        return _this;\r\n    }\r\n    return NoCacheAvailableException;\r\n}(Error));\r\nexport { NoCacheAvailableException };\r\n//# sourceMappingURL=exceptions.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./build/packages/config-store/es5/src/exceptions.js\n// module id = 4\n// module chunks = 0","import { Dictionary } from \"@pnp/common\";\r\n/**\r\n * Class used to manage the current application settings\r\n *\r\n */\r\nvar Settings = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of the settings class\r\n     *\r\n     * @constructor\r\n     */\r\n    function Settings() {\r\n        this._settings = new Dictionary();\r\n    }\r\n    /**\r\n     * Adds a new single setting, or overwrites a previous setting with the same key\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {string} value The setting value to store\r\n     */\r\n    Settings.prototype.add = function (key, value) {\r\n        this._settings.add(key, value);\r\n    };\r\n    /**\r\n     * Adds a JSON value to the collection as a string, you must use getJSON to rehydrate the object when read\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {any} value The setting value to store\r\n     */\r\n    Settings.prototype.addJSON = function (key, value) {\r\n        this._settings.add(key, JSON.stringify(value));\r\n    };\r\n    /**\r\n     * Applies the supplied hash to the setting collection overwriting any existing value, or created new values\r\n     *\r\n     * @param {TypedHash<any>} hash The set of values to add\r\n     */\r\n    Settings.prototype.apply = function (hash) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            try {\r\n                _this._settings.merge(hash);\r\n                resolve();\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Loads configuration settings into the collection from the supplied provider and returns a Promise\r\n     *\r\n     * @param {IConfigurationProvider} provider The provider from which we will load the settings\r\n     */\r\n    Settings.prototype.load = function (provider) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            provider.getConfiguration().then(function (value) {\r\n                _this._settings.merge(value);\r\n                resolve();\r\n            }).catch(function (reason) {\r\n                reject(reason);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Gets a value from the configuration\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {string} string value from the configuration\r\n     */\r\n    Settings.prototype.get = function (key) {\r\n        return this._settings.get(key);\r\n    };\r\n    /**\r\n     * Gets a JSON value, rehydrating the stored string to the original object\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {any} object from the configuration\r\n     */\r\n    Settings.prototype.getJSON = function (key) {\r\n        var o = this.get(key);\r\n        if (typeof o === \"undefined\" || o === null) {\r\n            return o;\r\n        }\r\n        return JSON.parse(o);\r\n    };\r\n    return Settings;\r\n}());\r\nexport { Settings };\r\n//# sourceMappingURL=configuration.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./build/packages/config-store/es5/src/configuration.js\n// module id = 7\n// module chunks = 0","import { default as CachingConfigurationProvider } from \"./cachingConfigurationProvider\";\r\n/**\r\n * A configuration provider which loads configuration values from a SharePoint list\r\n *\r\n */\r\nvar SPListConfigurationProvider = /** @class */ (function () {\r\n    /**\r\n     * Creates a new SharePoint list based configuration provider\r\n     * @constructor\r\n     * @param {string} webUrl Url of the SharePoint site, where the configuration list is located\r\n     * @param {string} listTitle Title of the SharePoint list, which contains the configuration settings (optional, default = \"config\")\r\n     */\r\n    function SPListConfigurationProvider(sourceWeb, sourceListTitle) {\r\n        if (sourceListTitle === void 0) { sourceListTitle = \"config\"; }\r\n        this.sourceWeb = sourceWeb;\r\n        this.sourceListTitle = sourceListTitle;\r\n    }\r\n    Object.defineProperty(SPListConfigurationProvider.prototype, \"web\", {\r\n        /**\r\n         * Gets the url of the SharePoint site, where the configuration list is located\r\n         *\r\n         * @return {string} Url address of the site\r\n         */\r\n        get: function () {\r\n            return this.sourceWeb;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SPListConfigurationProvider.prototype, \"listTitle\", {\r\n        /**\r\n         * Gets the title of the SharePoint list, which contains the configuration settings\r\n         *\r\n         * @return {string} List title\r\n         */\r\n        get: function () {\r\n            return this.sourceListTitle;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Loads the configuration values from the SharePoint list\r\n     *\r\n     * @return {Promise<TypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    SPListConfigurationProvider.prototype.getConfiguration = function () {\r\n        return this.web.lists.getByTitle(this.listTitle).items.select(\"Title\", \"Value\")\r\n            .getAs().then(function (data) {\r\n            return data.reduce(function (configuration, item) {\r\n                return Object.defineProperty(configuration, item.Title, {\r\n                    configurable: false,\r\n                    enumerable: false,\r\n                    value: item.Value,\r\n                    writable: false,\r\n                });\r\n            }, {});\r\n        });\r\n    };\r\n    /**\r\n     * Wraps the current provider in a cache enabled provider\r\n     *\r\n     * @return {CachingConfigurationProvider} Caching providers which wraps the current provider\r\n     */\r\n    SPListConfigurationProvider.prototype.asCaching = function () {\r\n        var cacheKey = \"splist_\" + this.web.toUrl() + \"+\" + this.listTitle;\r\n        return new CachingConfigurationProvider(this, cacheKey);\r\n    };\r\n    return SPListConfigurationProvider;\r\n}());\r\nexport default SPListConfigurationProvider;\r\n//# sourceMappingURL=spListConfigurationProvider.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./build/packages/config-store/es5/src/providers/spListConfigurationProvider.js\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}