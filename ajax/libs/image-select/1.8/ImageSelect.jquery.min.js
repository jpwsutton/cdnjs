!function(l){var d='<img class="{class_name}" src="{url}" />';function p(n,e,t,o,i,s){var r=l(e).data("img-src");null!=r&&""<r&&(n=l(n),text=l(e).text(),i=null==i||i,s=s||(i?"chose-image":"chose-image-small"),s=o?s+" rtl":s,t=t.replace("{url}",r).replace("{class_name}",s).replace("{text}",text),n.empty(),o&&i?n.append(t):n.prepend(t))}var n=l.fn.chosen;l.fn.extend({chosen:function(h){h=h||{};n.apply(this,arguments);this.each(function(){var t=l(this),n=t.data("chosen");t.on("chosen:hiding_dropdown",function(n,e){for(var t=function(n){for(var e=[],t=l(n.form_field).find("option:selected")||[],o=n.is_multiple?l(n.container).find(".chosen-choices span"):l(n.container).find(".chosen-single span"),i=0;i<t.length;i++)for(var s=0;s<o.length;s++)l(o[s]).text()==l(t[i]).text()&&e.push({span:o[s],option:t[i]});return e}(e.chosen),o=e.chosen.is_rtl,i=e.chosen.is_multiple,s=h.html_template||(o&&i?"{text}"+d:d+"{text}"),r=0;r<t.length;r++)p(t[r].span,t[r].option,s,o,i)}),t.on("chosen:showing_dropdown",function(n,e){for(var t=(e=e.chosen).form_field.options||[],o=e.is_rtl,i=h.html_template||o?"{text}"+d:d+"{text}",s=l(e.container).find(".chosen-drop ul li:not(:has(img))"),r=0;r<s.length;r++){var c=s[r],a=(l(t[r]),l(c).attr("data-option-array-index"));a&&p(c,t[e.results_data[a].options_index],i,o,!0,"chose-image-list")}}),t.on("chosen:ready",function(n,e){t.trigger("chosen:hiding_dropdown",e)}),t.on("chosen:filter",function(n,e){t.trigger("chosen:showing_dropdown",{chosen:e.chosen})}),t.trigger("chosen:hiding_dropdown",{chosen:n})})}})}(jQuery);