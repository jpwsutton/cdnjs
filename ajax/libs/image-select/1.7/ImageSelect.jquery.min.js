!function(d){var p='<img class="{class_name}" src="{url}" />';function f(n,e,t,o,i,s){var r=d(e).data("img-src");null!=r&&""<r&&(n=d(n),text=d(e).text(),i=null==i||i,s=s||(i?"chose-image":"chose-image-small"),s=o?s+" rtl":s,t=t.replace("{url}",r).replace("{class_name}",s).replace("{text}",text),n.empty(),o&&i?n.append(t):n.prepend(t))}var n=d.fn.chosen;d.fn.extend({chosen:function(l){l=l||{};n.apply(this,arguments);this.each(function(){var t=d(this),n=t.data("chosen");t.on("chosen:hiding_dropdown",function(n,e){for(var t=function(n){for(var e=[],t=d(n.form_field).find("option:selected")||[],o=n.is_multiple?d(n.container).find(".chosen-choices span"):d(n.container).find(".chosen-single span"),i=0;i<t.length;i++)for(var s=0;s<o.length;s++)d(o[s]).text()==d(t[i]).text()&&e.push({span:o[s],option:t[i]});return e}(e.chosen),o=e.chosen.is_rtl,i=e.chosen.is_multiple,s=l.html_template||(o&&i?"{text}"+p:p+"{text}"),r=0;r<t.length;r++)f(t[r].span,t[r].option,s,o,i)}),t.on("chosen:showing_dropdown",function(n,e){for(var t=(e=e.chosen).form_field.options||[],o=e.is_rtl,i=l.html_template||o?"{text}"+p:p+"{text}",s=d(e.container).find(".chosen-drop ul li:not(:has(img))"),r=0;r<s.length;r++){var c=s[r],a=d(t[r]),h=d(c).attr("data-option-array-index");h&&(a=t[e.results_data[h].options_index]),f(c,a,i,o,!0,"chose-image-list")}}),t.on("chosen:ready",function(n,e){t.trigger("chosen:hiding_dropdown",e)}),t.on("chosen:filter",function(n,e){t.trigger("chosen:showing_dropdown",{chosen:e.chosen})}),t.trigger("chosen:hiding_dropdown",{chosen:n})})}})}(jQuery);