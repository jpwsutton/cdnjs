!function(h){function l(n,o,e,i,s,t){null!=(src=h(o).data("img-src"))&&(n=h(n),s=null==s||s,t=t||(s?"chose-image":"chose-image-small"),t=i?t+" rtl":t,e=e.replace("{url}",src).replace("{class_name}",t),n.find("img").remove(),i&&s?n.append(e):n.prepend(e))}var o=h.fn.chosen;h.fn.extend({chosen:function(n){var a=(n=n||{}).html_template||'<img class="{class_name}" src="{url}" />';o.apply(this,arguments);this.each(function(){var e=h(this),n=e.data("chosen");e.on("chosen:hiding_dropdown",function(n,o){for(var e=function(n){for(var o=[],e=h(n.form_field).find("option:selected")||[],i=n.is_multiple?h(n.container).find(".chosen-choices span"):h(n.container).find(".chosen-single span"),s=0;s<e.length;s++)for(var t=0;t<i.length;t++)h(i[t]).text()==h(e[s]).text()&&o.push({span:i[t],option:e[s]});return o}(o.chosen),i=0;i<e.length;i++)l(e[i].span,e[i].option,a,o.chosen.is_rtl,o.chosen.is_multiple)}),e.on("chosen:showing_dropdown",function(n,o){for(var e=(o=o.chosen).form_field.options||[],i=h(o.container).find(".chosen-drop ul li:not(:has(img))"),s=0;s<i.length;s++){var t=i[s],r=h(e[s]),c=h(t).attr("data-option-array-index");c&&(r=e[o.results_data[c].options_index]),l(t,r,a,o.is_rtl,!0,"chose-image-list")}}),e.on("chosen:ready",function(n,o){e.trigger("chosen:hiding_dropdown",o)}),e.on("chosen:filter",function(n,o){e.trigger("chosen:showing_dropdown",{chosen:o.chosen})}),e.trigger("chosen:hiding_dropdown",{chosen:n})})}})}(jQuery);