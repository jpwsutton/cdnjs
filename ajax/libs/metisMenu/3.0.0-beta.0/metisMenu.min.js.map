{"version":3,"sources":["modules/constant.js","modules/index.js"],"names":["Default","parentTrigger","subMenu","toggle","triggerElement","ClassNames","MetisMenu","element","options","this","document","querySelector","cacheEl","config","_objectSpread","cacheConfig","disposed","ulArr","listenerOb","init","update","dispose","_iterator","_isArray","Array","isArray","_i","Symbol","iterator","_ref","length","next","done","value","lo","key","hasOwnProperty","el","removeEventListener","on","event","fn","addEventListener","off","emit","eventDetail","shouldBubble","evt","CustomEvent","bubbles","detail","createEvent","initCustomEvent","dispatchEvent","slice","call","querySelectorAll","_iterator2","_isArray2","_i2","_ref2","ul","li","parentNode","classList","add","contains","show","hide","a","getAttribute","setAttribute","aClick","clickEvent","bind","listener","push","ev","currentTarget","tagName","preventDefault","target","_this","isTransitioning","style","height","remove","eleParentSiblins","children","filter","c","_iterator3","_isArray3","_i3","_ref3","sibUl","setTransitioning","scrollHeight","showElement","complete","shownElement","_this2","hideElement","getBoundingClientRect","offsetHeight","hiddenElement"],"mappings":"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","sourcesContent":["export const Default = {\n    parentTrigger: \"li\",\n    subMenu: \"ul\",\n    toggle: true,\n    triggerElement: \"a\"\n};\nexport const ClassNames = {\n    activeClass: \"active\",\n    collapseClass: \"collapse\",\n    collapseInClass: \"in\",\n    collapsingClass: \"collapsing\"\n};\n","import { ClassNames, Default } from \"./constant\";\nclass MetisMenu {\n    constructor(element, options) {\n        this.element =\n            typeof element === \"string\" ? document.querySelector(element) : element;\n        this.cacheEl = this.element;\n        this.config = { ...Default, ...options };\n        this.cacheConfig = this.config;\n        this.disposed = false;\n        this.ulArr = [];\n        this.listenerOb = [];\n        this.init();\n    }\n    update() {\n        this.disposed = false;\n        this.element = this.cacheEl;\n        this.config = this.cacheConfig;\n        this.init();\n    }\n    dispose() {\n        for (const lo of this.listenerOb) {\n            for (const key in lo) {\n                if (lo.hasOwnProperty(key)) {\n                    const el = lo[key];\n                    el[1].removeEventListener(el[0], el[2]);\n                }\n            }\n        }\n        this.ulArr = [];\n        this.listenerOb = [];\n        this.config = null;\n        this.element = null;\n        this.disposed = true;\n    }\n    on(event, fn) {\n        this.element.addEventListener(event, fn, false);\n        return this;\n    }\n    off(event, fn) {\n        this.element.removeEventListener(event, fn);\n        return this;\n    }\n    emit(event, eventDetail, shouldBubble = false) {\n        let evt;\n        if (typeof CustomEvent === \"function\") {\n            evt = new CustomEvent(event, {\n                bubbles: shouldBubble,\n                detail: eventDetail\n            });\n        }\n        else {\n            evt = document.createEvent(\"CustomEvent\");\n            evt.initCustomEvent(event, shouldBubble, false, eventDetail);\n        }\n        this.element.dispatchEvent(evt);\n        return this;\n    }\n    init() {\n        this.ulArr = [].slice.call(this.element.querySelectorAll(this.config.subMenu));\n        for (const ul of this.ulArr) {\n            const li = ul.parentNode;\n            ul.classList.add(ClassNames.collapseClass);\n            if (li.classList.contains(ClassNames.activeClass)) {\n                this.show(ul);\n            }\n            else {\n                this.hide(ul);\n            }\n            const a = li.querySelector(this.config.triggerElement);\n            if (a.getAttribute(\"aria-disabled\") === \"true\") {\n                return;\n            }\n            a.setAttribute(\"aria-expanded\", \"false\");\n            const listenerOb = {\n                aClick: [\"click\", a, this.clickEvent.bind(this)]\n            };\n            for (const key in listenerOb) {\n                if (listenerOb.hasOwnProperty(key)) {\n                    const listener = listenerOb[key];\n                    listener[1].addEventListener(listener[0], listener[2]);\n                }\n            }\n            this.listenerOb.push(listenerOb);\n        }\n    }\n    clickEvent(ev) {\n        if (!this.disposed) {\n            if (ev.currentTarget.tagName === \"A\") {\n                ev.preventDefault();\n            }\n            const li = ev.target.parentNode;\n            const ul = li.querySelector(this.config.subMenu);\n            this.toggle(ul);\n        }\n    }\n    toggle(ul) {\n        if (ul.parentNode.classList.contains(ClassNames.activeClass)) {\n            this.hide(ul);\n        }\n        else {\n            this.show(ul);\n        }\n    }\n    show(ul) {\n        if (this.isTransitioning ||\n            ul.classList.contains(ClassNames.collapseInClass)) {\n            return;\n        }\n        const complete = () => {\n            ul.classList.remove(ClassNames.collapsingClass);\n            ul.style.height = \"\";\n            ul.removeEventListener(\"transitionend\", complete);\n            this.setTransitioning(false);\n            this.emit(\"shown.metisMenu\", {\n                shownElement: ul\n            });\n        };\n        const li = ul.parentNode;\n        li.classList.add(ClassNames.activeClass);\n        const a = li.querySelector(this.config.triggerElement);\n        a.setAttribute(\"aria-expanded\", \"true\");\n        ul.style.height = \"0px\";\n        ul.classList.remove(ClassNames.collapseClass);\n        ul.classList.remove(ClassNames.collapseInClass);\n        ul.classList.add(ClassNames.collapsingClass);\n        const eleParentSiblins = [].slice\n            .call(li.parentNode.children)\n            .filter(c => c !== li);\n        if (this.config.toggle && eleParentSiblins.length > 0) {\n            for (const sibli of eleParentSiblins) {\n                const sibUl = sibli.querySelector(this.config.subMenu);\n                if (sibUl !== null) {\n                    this.hide(sibUl);\n                }\n            }\n        }\n        this.setTransitioning(true);\n        ul.classList.add(ClassNames.collapseClass);\n        ul.classList.add(ClassNames.collapseInClass);\n        ul.style.height = ul.scrollHeight + \"px\";\n        this.emit(\"show.metisMenu\", {\n            showElement: ul\n        });\n        ul.addEventListener(\"transitionend\", complete);\n    }\n    hide(ul) {\n        if (this.isTransitioning ||\n            !ul.classList.contains(ClassNames.collapseInClass)) {\n            return;\n        }\n        this.emit(\"hide.metisMenu\", {\n            hideElement: ul\n        });\n        const li = ul.parentNode;\n        li.classList.remove(ClassNames.activeClass);\n        const complete = () => {\n            ul.classList.remove(ClassNames.collapsingClass);\n            ul.classList.add(ClassNames.collapseClass);\n            ul.removeEventListener(\"transitionend\", complete);\n            this.setTransitioning(false);\n            this.emit(\"hidden.metisMenu\", {\n                hiddenElement: ul\n            });\n        };\n        ul.style.height = ul.getBoundingClientRect().height + \"px\";\n        ul.style.height = ul.offsetHeight + \"px\";\n        ul.classList.add(ClassNames.collapsingClass);\n        ul.classList.remove(ClassNames.collapseClass);\n        ul.classList.remove(ClassNames.collapseInClass);\n        this.setTransitioning(true);\n        ul.addEventListener(\"transitionend\", complete);\n        ul.style.height = \"0px\";\n        const a = li.querySelector(this.config.triggerElement);\n        a.setAttribute(\"aria-expanded\", \"false\");\n    }\n    setTransitioning(isTransitioning) {\n        this.isTransitioning = isTransitioning;\n    }\n}\nexport default MetisMenu;\n"]}