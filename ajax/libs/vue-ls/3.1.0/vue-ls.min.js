!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.VueStorage=n()}(this,function(){"use strict";var n=function(){function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();var t={},i=new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"length",{get:function(){return Object.keys(t).length}})}return n(e,[{key:"getItem",value:function(e){return e in t?t[e]:null}},{key:"setItem",value:function(e,n){return t[e]=n,!0}},{key:"removeItem",value:function(e){return!!(e in t)&&delete t[e]}},{key:"clear",value:function(){return t={},!0}},{key:"key",value:function(e){var n=Object.keys(t);return void 0!==n[e]?n[e]:null}}]),e}()),o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},e=function(){function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();var a=function(){function t(e){if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=e,this.options={namespace:"",events:["storage"]},Object.defineProperty(this,"length",{get:function(){return this.storage.length}}),"undefined"!=typeof window)for(var n in this.options.events)window.addEventListener?window.addEventListener(this.options.events[n],u.emit,!1):window.attachEvent?window.attachEvent("on"+this.options.events[n],u.emit):window["on"+this.options.events[n]]=u.emit}return e(t,[{key:"setOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.options=o(this.options,e)}},{key:"set",value:function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=JSON.stringify({value:n,expire:null!==t?(new Date).getTime()+t:null});this.storage.setItem(this.options.namespace+e,o)}},{key:"get",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=this.storage.getItem(this.options.namespace+e);if(null!==t)try{var o=JSON.parse(t);if(null===o.expire)return o.value;if(o.expire>=(new Date).getTime())return o.value;this.remove(e)}catch(e){return n}return n}},{key:"key",value:function(e){return this.storage.key(e)}},{key:"remove",value:function(e){return this.storage.removeItem(this.options.namespace+e)}},{key:"clear",value:function(){if(0!==this.length){for(var e=[],n=0;n<this.length;n++){var t=this.storage.key(n);!1!==new RegExp("^"+this.options.namespace+".+","i").test(t)&&e.push(t)}for(var o in e)this.storage.removeItem(e[o])}}},{key:"on",value:function(e,n){u.on(this.options.namespace+e,n)}},{key:"off",value:function(e,n){u.off(this.options.namespace+e,n)}}]),t}(),r=function(){function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();var s={},u=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"on",value:function(e,n){void 0===s[e]&&(s[e]=[]),s[e].push(n)}},{key:"off",value:function(e,n){s[e].length?s[e].splice(s[e].indexOf(n),1):s[e]=[]}},{key:"emit",value:function(e){var n=e||window.event,t=function(n){try{return JSON.parse(n).value}catch(e){return n}};if(void 0!==n&&void 0!==n.key){var o=s[n.key];void 0!==o&&o.forEach(function(e){e(t(n.newValue),t(n.oldValue),n.url||n.uri)})}}}]),e}(),l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},c="undefined"!=typeof window?window:global||{},f={install:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=l({},n,{storage:n.storage||"local",name:n.name||"ls"});if(t.storage&&-1===["memory","local","session"].indexOf(t.storage))throw new Error('Vue-ls: Storage "'+t.storage+'" is not supported');var o=null;switch(t.storage){case"local":o="localStorage"in c?c.localStorage:null;break;case"session":o="sessionStorage"in c?c.sessionStorage:null;break;case"memory":o=i}o||(o=i,console.error('Vue-ls: Storage "'+t.storage+'" is not supported your system, use memory storage'));var r=new a(o);r.setOptions(l(r.options,{namespace:""},t||{})),e[t.name]=r,Object.defineProperty(e.prototype,"$"+t.name,{get:function(){return r}})}};return c.VueStorage=f});
