!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/logging"],t):t(e.pnp={},e.common,e.logging)}(this,function(e,t,n){"use strict";var o=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=function(e){function t(){var t=this,o=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return t=e.call(this,o)||this,t.name="SPRequestExecutorUndefinedException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+t.name+"]::"+t.message}),t}return o(t,e),t}(Error),s=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var o=204===e.statusCode?null:e.body;return new Response(o,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,n){var o=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new r;var s,i,u=e.substring(0,e.indexOf("/_api")),a=new SP.RequestExecutor(u),c={};if(n.headers&&n.headers instanceof Headers)for(i=(s=n.headers.entries()).next();!i.done;)c[i.value[0]]=i.value[1],i=s.next();else c=n.headers;return new Promise(function(r,s){var i={error:function(e){s(o.convertToResponse(e))},headers:c,method:n.method,success:function(e){r(o.convertToResponse(e))},url:e};i=n.body?t.Util.extend(i,{body:n.body}):t.Util.extend(i,{binaryStringRequestBody:!0}),a.executeAsync(i)})},e}();e.SPRequestExecutorClient=s,Object.defineProperty(e,"__esModule",{value:!0})});