/**
@license
 * @pnp/sp-addinhelpers v1.0.0-beta.11 - pnp - provides functionality for working within SharePoint add-ins
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("tslib"),require("@pnp/logging"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","tslib","@pnp/logging","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-addinhelpers"]={}),e.common,e.tslib_1,e.logging,e.sp)}(this,function(e,t,n,r,o){"use strict";var s=function(e){n.__extends(t,e);function t(){var t=this,n=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return(t=e.call(this,n)||this).name="SPRequestExecutorUndefinedException",r.Logger.error(t),t}return t}(Error),i=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,n){var r=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new s;var o,i,u=e.substring(0,e.indexOf("/_api")),p=new SP.RequestExecutor(u),d={};if(n.headers&&n.headers instanceof Headers)for(i=(o=n.headers.entries()).next();!i.done;)d[i.value[0]]=i.value[1],i=o.next();else d=n.headers;return new Promise(function(o,s){var i={error:function(e){s(r.convertToResponse(e))},headers:d,method:n.method,success:function(e){o(r.convertToResponse(e))},url:e};i=n.body?t.Util.extend(i,{body:n.body}):t.Util.extend(i,{binaryStringRequestBody:!0}),p.executeAsync(i)})},e}(),u=function(e){n.__extends(r,e);function r(){return null!==e&&e.apply(this,arguments)||this}return r.prototype.crossDomainSite=function(e,t){return this._cdImpl(o.Site,e,t,"site")},r.prototype.crossDomainWeb=function(e,t){return this._cdImpl(o.Web,e,t,"web")},r.prototype._cdImpl=function(e,n,r,o){if(!t.Util.isUrlAbsolute(n))throw new t.UrlException("The addInWebUrl parameter must be an absolute url.");if(!t.Util.isUrlAbsolute(r))throw new t.UrlException("The hostWebUrl parameter must be an absolute url.");var s=new e(t.Util.combinePaths(n,"_api/SP.AppContextSite(@target)"),o);return s.query.add("@target","'"+encodeURIComponent(r)+"'"),s.configure(this._options)},r}(o.SPRest),p=new u;e.SPRequestExecutorClient=i,e.SPRequestExecutorUndefinedException=s,e.SPRestAddIn=u,e.sp=p,Object.defineProperty(e,"__esModule",{value:!0})});