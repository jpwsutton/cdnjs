/**
@license
 * @pnp/sp-addinhelpers v1.0.5-0 - pnp - provides functionality for working within SharePoint add-ins
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https:github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/logging"),require("@pnp/common"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/logging","@pnp/common","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-addinhelpers"]={}),e.tslib_1,e.logging,e.pnp.common,e.pnp.sp)}(this,function(e,r,o,p,n){"use strict";var d=function(n){function e(){var e=this,t=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return(e=n.call(this,t)||this).name="SPRequestExecutorUndefinedException",o.Logger.error(e),e}return r.__extends(e,n),e}(Error),t=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(r,o){var s=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new d;var e,t,n=r.substring(0,r.indexOf("/_api")),i=new SP.RequestExecutor(n),u={};if(o.headers&&o.headers instanceof Headers)for(t=(e=o.headers.entries()).next();!t.done;)u[t.value[0]]=t.value[1],t=e.next();else u=o.headers;return new Promise(function(t,n){var e={error:function(e){n(s.convertToResponse(e))},headers:u,method:o.method,success:function(e){t(s.convertToResponse(e))},url:r};e=o.body?p.extend(e,{body:o.body}):p.extend(e,{binaryStringRequestBody:!0}),i.executeAsync(e)})},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.crossDomainSite=function(e,t){return this._cdImpl(n.Site,e,t,"site")},t.prototype.crossDomainWeb=function(e,t){return this._cdImpl(n.Web,e,t,"web")},t.prototype._cdImpl=function(e,t,n,r){if(!p.isUrlAbsolute(t))throw new p.UrlException("The addInWebUrl parameter must be an absolute url.");if(!p.isUrlAbsolute(n))throw new p.UrlException("The hostWebUrl parameter must be an absolute url.");var o=new e(p.combinePaths(t,"_api/SP.AppContextSite(@target)"),r);return o.query.add("@target","'"+encodeURIComponent(n)+"'"),o.configure(this._options)},t}(n.SPRest),i=new s;e.SPRequestExecutorClient=t,e.SPRequestExecutorUndefinedException=d,e.SPRestAddIn=s,e.sp=i,Object.defineProperty(e,"__esModule",{value:!0})});