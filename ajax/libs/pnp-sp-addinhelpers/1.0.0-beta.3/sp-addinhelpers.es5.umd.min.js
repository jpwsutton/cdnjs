!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("tslib"),require("@pnp/logging"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","tslib","@pnp/logging","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-addinhelpers"]={}),e.common,e.tslib_1,e.logging,e.sp)}(this,function(e,t,n,r,o){"use strict";var s=function(e){function t(){var t=this,n=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return t=e.call(this,n)||this,t.name="SPRequestExecutorUndefinedException",r.Logger.log({data:{},level:r.LogLevel.Error,message:"["+t.name+"]::"+t.message}),t}return n.__extends(t,e),t}(Error),i=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,n){var r=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new s;var o,i,u=e.substring(0,e.indexOf("/_api")),a=new SP.RequestExecutor(u),p={};if(n.headers&&n.headers instanceof Headers)for(i=(o=n.headers.entries()).next();!i.done;)p[i.value[0]]=i.value[1],i=o.next();else p=n.headers;return new Promise(function(o,s){var i={error:function(e){s(r.convertToResponse(e))},headers:p,method:n.method,success:function(e){o(r.convertToResponse(e))},url:e};i=n.body?t.Util.extend(i,{body:n.body}):t.Util.extend(i,{binaryStringRequestBody:!0}),a.executeAsync(i)})},e}(),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.crossDomainSite=function(e,t){return this._cdImpl(o.Site,e,t,"site")},r.prototype.crossDomainWeb=function(e,t){return this._cdImpl(o.Web,e,t,"web")},r.prototype._cdImpl=function(e,n,r,o){if(!t.Util.isUrlAbsolute(n))throw new t.UrlException("The addInWebUrl parameter must be an absolute url.");if(!t.Util.isUrlAbsolute(r))throw new t.UrlException("The hostWebUrl parameter must be an absolute url.");var s=new e(t.Util.combinePaths(n,"_api/SP.AppContextSite(@target)"),o);return s.query.add("@target","'"+encodeURIComponent(r)+"'"),s.configure(this._options)},r}(o.SPRest),a=new u;e.SPRequestExecutorClient=i,e.SPRequestExecutorUndefinedException=s,e.SPRestAddIn=u,e.sp=a,Object.defineProperty(e,"__esModule",{value:!0})});