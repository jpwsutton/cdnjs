/**
@license
 * @pnp/graph v1.0.5 - pnp - provides functionality to query the Microsoft Graph
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https:github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("tslib"),require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/logging","@pnp/odata"],e):e((t.pnp=t.pnp||{},t.pnp.graph={}),t.tslib_1,t.pnp.common,t.pnp.logging,t.pnp.odata)}(this,function(u,i,s,p,o){"use strict";var t,e=function(n){function t(t){void 0===t&&(t="There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.");var e=n.call(this,t)||this;return e.name="NoGraphClientAvailableException",p.Logger.log({data:null,level:3,message:e.message}),e}return i.__extends(t,n),t}(Error),c=new(function(){function t(){}return Object.defineProperty(t.prototype,"headers",{get:function(){var t=s.RuntimeConfig.get("graph");return null!=t&&void 0!==t.headers?t.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClientFactory",{get:function(){var t=s.RuntimeConfig.get("graph");if(null!==t&&void 0!==t.fetchClientFactory)return t.fetchClientFactory;if(void 0!==s.RuntimeConfig.spfxContext)return function(){return s.AdalClient.fromSPFxContext(s.RuntimeConfig.spfxContext)};throw new e},enumerable:!0,configurable:!0}),t}()),a=function(){function t(){this._impl=c.fetchClientFactory()}return t.prototype.fetch=function(t,e){void 0===e&&(e={});var n=new Headers;s.mergeHeaders(n,c.headers),s.mergeHeaders(n,e.headers),n.has("Content-Type")||n.append("Content-Type","application/json");var r=s.extend(e,{headers:n});return this.fetchRaw(t,r)},t.prototype.fetchRaw=function(t,e){var r=this;void 0===e&&(e={});var n=new Headers;s.mergeHeaders(n,e.headers),e=s.extend(e,{headers:n});var o=function(n){r._impl.fetch(t,e).then(function(t){return n.resolve(t)}).catch(function(t){429!==t.status&&503!==t.status&&n.reject(t);var e=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(t),setTimeout(s.getCtxCallback(r,o,n),e)})};return new Promise(function(t,e){var n={attempts:0,delay:100,reject:e,resolve:t,retryCount:7};o.call(r,n)})},t.prototype.get=function(t,e){void 0===e&&(e={});var n=s.extend(e,{method:"GET"});return this.fetch(t,n)},t.prototype.post=function(t,e){void 0===e&&(e={});var n=s.extend(e,{method:"POST"});return this.fetch(t,n)},t.prototype.patch=function(t,e){void 0===e&&(e={});var n=s.extend(e,{method:"PATCH"});return this.fetch(t,n)},t.prototype.delete=function(t,e){void 0===e&&(e={});var n=s.extend(e,{method:"DELETE"});return this.fetch(t,n)},t}(),f=function(){function i(){}return i.ensure=function(t,e){var n=[i.Beta,i.V1],r=new RegExp(e,"i"),o=n.filter(function(t){return!r.test(t)}).map(function(t){return t.replace(".","\\.")});return r=new RegExp("/?("+o.join("|")+")/","ig"),t.replace(r,"/"+e+"/")},i.Beta="beta",i.V1="v1.0",i}(),n=function(o){function t(t,e){var n=o.call(this)||this;if("string"==typeof t){var r=t;n._parentUrl=r,n._url=s.combinePaths(r,e)}else n.extend(t,e);return n}return i.__extends(t,o),t.prototype.as=function(t){var e=new t(this._url,null);return s.extend(e,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this,t=this.toUrl();return s.isUrlAbsolute(t)||(t=s.combinePaths("https://graph.microsoft.com",t)),t+"?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")},t.prototype.getParent=function(t,e,n){return void 0===e&&(e=this.parentUrl),new t(e,n)},t.prototype.clone=function(t,e,n){void 0===n&&(n=!0);var r=new t(this,e);return r.configure(this._options),n&&(r=r.inBatch(this._batch)),r},t.prototype.setEndpoint=function(t){return this._url=f.ensure(this._url,t),this},t.prototype.toRequestContext=function(t,e,n,r){return void 0===e&&(e={}),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new a},isBatched:this.hasBatch,isCached:this._useCaching,options:e,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:s.getGUID(),verb:t})},t}(o.ODataQueryable),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.filter=function(t){return this._query.add("$filter",t),this},e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this._query.add("$select",t.join(",")),this},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this._query.add("$expand",t.join(",")),this},e.prototype.orderBy=function(t,e){var n=this;void 0===e&&(e=!0);var r=this._query.getKeys().filter(function(t){return"$orderby"===t}).map(function(t){return n._query.get(t)});return r.push(t+" "+(e?"asc":"desc")),this._query.add("$orderby",r.join(",")),this},e.prototype.top=function(t){return this._query.add("$top",t.toString()),this},e.prototype.skip=function(t){return this._query.add("$top",t.toString()),this},e.prototype.skipToken=function(t){return this._query.add("$skiptoken",t),this},Object.defineProperty(e.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),e}(n),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.search=function(t){return this._query.add("$search",t),this},e}(r),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this._query.add("$select",t.join(",")),this},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this._query.add("$expand",t.join(",")),this},e}(n),l=function(n){function e(t,e){return void 0===e&&(e="members"),n.call(this,t,e)||this}return i.__extends(e,n),e.prototype.add=function(t){return this.clone(e,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},e.prototype.getById=function(t){return new y(this,t)},e}(r),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(h),g=function(n){function t(t,e){return void 0===e&&(e="owners"),n.call(this,t,e)||this}return i.__extends(t,n),t}(l),b=(function(n){function t(t,e){return void 0===e&&(e="calendars"),n.call(this,t,e)||this}i.__extends(t,n)}(r),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),e}(h)),m=function(n){function t(t,e){return void 0===e&&(e="events"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new v(this,t)},t.prototype.add=function(t){var e=this;return this.postCore({body:JSON.stringify(t)}).then(function(t){return{data:t,event:e.getById(t.id)}})},t}(r),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(h),_=function(n){function t(t,e){return void 0===e&&(e="attachments"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new x(this,t)},t.prototype.addFile=function(t,e){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:e,name:t})})},t}(r),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(h),w=function(n){function t(t,e){return void 0===e&&(e="conversations"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},t.prototype.getById=function(t){return new j(this,t)},t}(r),C=function(n){function t(t,e){return void 0===e&&(e="threads"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new P(this,t)},t.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},t}(r),O=function(n){function t(t,e){return void 0===e&&(e="posts"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new S(this,t)},t.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},t}(r),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),Object.defineProperty(e.prototype,"threads",{get:function(){return new C(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(h),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),Object.defineProperty(e.prototype,"posts",{get:function(){return new O(this)},enumerable:!0,configurable:!0}),e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:JSON.stringify({post:t})})},e.prototype.delete=function(){return this.deleteCore()},e}(h),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),Object.defineProperty(e.prototype,"attachments",{get:function(){return new _(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.forward=function(t){return this.clone(e,"forward").postCore({body:JSON.stringify(t)})},e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:JSON.stringify({post:t})})},e}(h),q=function(n){function r(t,e){return n.call(this,t,e)||this}return i.__extends(r,n),r.prototype.add=function(t){return this.clone(r,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},r.prototype.remove=function(t){var e=this.clone(r,"$ref");return e.query.add("$id",t),e.deleteCore()},r}(r),B=function(n){function t(t,e){return void 0===e&&(e="planner/plans"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new N(this,t)},t}(r),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(h),T=function(n){function e(t,e){return void 0===e&&(e="photo"),n.call(this,t,e)||this}return i.__extends(e,n),e.prototype.getBlob=function(){return this.clone(e,"$value",!1).get(new o.BlobParser)},e.prototype.getBuffer=function(){return this.clone(e,"$value",!1).get(new o.BufferParser)},e.prototype.setContent=function(t){return this.clone(e,"$value",!1).patchCore({body:t})},e}(h),I=function(){function t(){}return t.prototype.create=function(t,e,n){void 0===e&&(e=""),void 0===n&&(n={});var r=e&&0<e.length?{description:e}:{};return H.groups.add(t,t,u.GroupType.Office365,r).then(function(e){return e.group.createTeam(n).then(function(t){return{data:t,group:e.group,team:new G(e.group)}})})},t}(),G=function(n){function r(t,e){return void 0===e&&(e="team"),n.call(this,t,e)||this}return i.__extends(r,n),r.prototype.update=function(t){var e=this;return this.clone(r,"").setEndpoint(f.Beta).patchCore({body:JSON.stringify(t)}).then(function(t){return{data:t,team:e}})},r.prototype.get=function(t,e){return void 0===t&&(t=new o.ODataDefaultParser),void 0===e&&(e={}),this.clone(r,"").setEndpoint(f.Beta).getCore(t,e)},r}(h);(t=u.GroupType||(u.GroupType={}))[t.Office365=0]="Office365",t[t.Dynamic=1]="Dynamic",t[t.Security=2]="Security";var J=function(n){function t(t,e){return void 0===e&&(e="groups"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new $(this,t)},t.prototype.add=function(t,e,n,r){var o=this;void 0===r&&(r={});var i=s.extend({displayName:t,mailEnabled:n===u.GroupType.Office365,mailNickname:e,securityEnabled:n!==u.GroupType.Office365},r);return n!==u.GroupType.Security&&(i=s.extend(i,{groupTypes:n===u.GroupType.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:JSON.stringify(i)}).then(function(t){return{data:t,group:o.getById(t.id)}})},t}(r),$=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(r,t),Object.defineProperty(r.prototype,"calendar",{get:function(){return new b(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"owners",{get:function(){return new g(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"plans",{get:function(){return new B(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"members",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"conversations",{get:function(){return new w(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"acceptedSenders",{get:function(){return new q(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rejectedSenders",{get:function(){return new q(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"photo",{get:function(){return new T(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"team",{get:function(){return new G(this)},enumerable:!0,configurable:!0}),r.prototype.addFavorite=function(){return this.clone(r,"addFavorite").postCore()},r.prototype.createTeam=function(t){return this.clone(r,"team").setEndpoint(f.Beta).putCore({body:JSON.stringify(t)})},r.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(r,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:t})})},r.prototype.delete=function(){return this.deleteCore()},r.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},r.prototype.removeFavorite=function(){return this.clone(r,"removeFavorite").postCore()},r.prototype.resetUnseenCount=function(){return this.clone(r,"resetUnseenCount").postCore()},r.prototype.subscribeByMail=function(){return this.clone(r,"subscribeByMail").postCore()},r.prototype.unsubscribeByMail=function(){return this.clone(r,"unsubscribeByMail").postCore()},r.prototype.getCalendarView=function(t,e){var n=this.clone(r,"calendarView");return n.query.add("startDateTime",t.toISOString()),n.query.add("endDateTime",e.toISOString()),n.get()},r}(h),E=function(n){function t(t,e){return void 0===e&&(e="onenote"),n.call(this,t,e)||this}return i.__extends(t,n),Object.defineProperty(t.prototype,"notebooks",{get:function(){return new R(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sections",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),t}(h),R=function(n){function t(t,e){return void 0===e&&(e="notebooks"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new D(this,t)},t.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:JSON.stringify(n)}).then(function(t){return{data:t,notebook:e.getById(t.id)}})},t}(r),D=function(n){function t(t,e){return n.call(this,t,e)||this}return i.__extends(t,n),Object.defineProperty(t.prototype,"sections",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),t}(h),k=function(n){function t(t,e){return void 0===e&&(e="sections"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new U(this,t)},t.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:JSON.stringify(n)}).then(function(t){return{data:t,section:e.getById(t.id)}})},t}(r),U=function(n){function t(t,e){return n.call(this,t,e)||this}return i.__extends(t,n),t}(h),F=function(n){function t(t,e){return void 0===e&&(e="pages"),n.call(this,t,e)||this}return i.__extends(t,n),t}(r),A=function(n){function t(t,e){return void 0===e&&(e="me"),n.call(this,t,e)||this}return i.__extends(t,n),Object.defineProperty(t.prototype,"onenote",{get:function(){return new E(this)},enumerable:!0,configurable:!0}),t}(h),L=function(n){function t(t,e){return void 0===e&&(e="users"),n.call(this,t,e)||this}return i.__extends(t,n),t.prototype.getById=function(t){return new M(this,t)},t}(r),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(h),Q=function(n){function t(t,e){return n.call(this,t,e)||this}return i.__extends(t,n),Object.defineProperty(t.prototype,"groups",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teams",{get:function(){return new I},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return new A(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"users",{get:function(){return new L(this)},enumerable:!0,configurable:!0}),t.prototype.setup=function(t){var e;e=t,s.RuntimeConfig.extend(e)},t}(n),H=new Q("v1.0"),V=function(n){function t(t){var e=n.call(this,t)||this;return e.name="GraphBatchParseException",p.Logger.log({data:{},level:3,message:"["+e.name+"]::"+e.message}),e}return i.__extends(t,n),t}(Error),K=function(n){function t(t){void 0===t&&(t="https://graph.microsoft.com/beta/$batch");var e=n.call(this)||this;return e.batchUrl=t,e}return i.__extends(t,n),t.prototype.executeImpl=function(){var i=this;p.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1);var t=new a,e={requests:this.formatRequests()},n={body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return p.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch(this.batchUrl,n).then(function(t){return t.json()}).then(this._parseResponse).then(function(o){return p.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),o.responses.reduce(function(t,e,n){var r=i.requests[n];if(s.objectDefinedNotNull(r))return p.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+r.method+" "+r.url+".",0),t.then(function(t){return r.parser.parse(e).then(r.resolve).catch(r.reject)});if(o.nextLink)throw new V("Could not properly parse responses to match requests in batch.");return t},Promise.resolve())})},t.prototype.formatRequests=function(){return this.requests.map(function(t,e){var n={id:""+ ++e,method:t.method,url:t.url},r={};return void 0!==c.headers&&null!==c.headers&&(r=s.extend(r,c.headers)),void 0!==t.options&&(void 0!==t.options.headers&&null!==t.options.headers&&(r=s.extend(r,t.options.headers)),void 0!==t.options.body&&null!==t.options.body&&(n=s.extend(n,{body:t.options.body}))),n=s.extend(n,{headers:r})})},t.prototype._parseResponse=function(i){var u=this;return new Promise(function(t){for(var e=new Array(u.requests.length).fill(null),n=0;n<i.responses.length;++n){var r=i.responses[n],o=parseInt(r.id,10)-1;204===r.status?e[o]=new Response:e[o]=new Response(null,{headers:r.headers,status:r.status})}t({nextLink:i.nextLink,responses:e})})},i.__decorate([s.beta("Graph batching functionality is in beta.")],t.prototype,"executeImpl",null),t}(o.ODataBatch);u.graph=H,u.GraphRest=Q,u.Group=$,u.Groups=J,u.GraphBatch=K,u.GraphQueryable=n,u.GraphQueryableCollection=r,u.GraphQueryableInstance=h,u.GraphQueryableSearchableCollection=d,u.Teams=I,u.Team=G,u.GraphEndpoints=f,u.OneNote=E,u.Notebooks=R,u.Notebook=D,u.Sections=k,u.Section=U,u.Pages=F,Object.defineProperty(u,"__esModule",{value:!0})});