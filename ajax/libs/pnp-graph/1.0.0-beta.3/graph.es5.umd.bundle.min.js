!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u}t.b=r,t.a=o;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};Object.assign},function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return l});var r=n(0),o=n(2),i=n(4),u=n(6),s=function(e){function t(t,n){var r=e.call(this)||this;if("string"==typeof t){var i=t;r._parentUrl=i,r._url=o.d.combinePaths(i,n)}else{var u=t;r._parentUrl=u._url,r._options=u._options,r._url=o.d.combinePaths(r._parentUrl,n)}return r}return r.b(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return o.d.extend(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this;return this.toUrl()+"?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")},t.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},t.prototype.clone=function(e,t,n){return void 0===n&&(n=!0),new e(this,t)},t.prototype.toRequestContext=function(e,t,n,r){return void 0===t&&(t={}),void 0===r&&(r=i.e.default),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new u.a},isBatched:this.hasBatch,isCached:this._useCaching,options:t,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:o.d.getGUID(),verb:e})},t}(i.d),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),r=[],o=t?" asc":" desc",i=0;i<n.length;i++)if("$orderby"===n[i]){r.push(this._query.get("$orderby"));break}return r.push(""+e+o),this._query.add("$orderby",r.join(",")),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skip=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skipToken=function(e){return this._query.add("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),t}(s),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.search=function(e){return this._query.add("$search",e),this},t}(a),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(s)},function(e,t,n){"use strict";function r(e,t){if(c.objectDefinedNotNull(t)){var n=c.extend(e.headers||{},t.headers);e=c.extend(e,t),e.headers=n}}function o(e){return void 0===e&&(e="This feature is flagged as beta and is subject to change."),function(t,n,r){var o=r.value;r.value=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return u.b.log({data:{descriptor:r,propertyKey:n,target:t},level:u.a.Warning,message:e}),o.apply(this,i)}}}function i(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}}n.d(t,"d",function(){return c}),n.d(t,"a",function(){return a}),n.d(t,"g",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"c",function(){return h}),n.d(t,"f",function(){return i}),n.d(t,"b",function(){return y});var u=n(3),s=n(0),a=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.keys=e,this.values=t}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?null===t?this.remove(e):this.values[n]=t:null!==t&&(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){var t=this;if("getKeys"in e){var n=e;n.getKeys().map(function(e){t.add(e,n.get(e))})}else{var r=e;for(var o in r)r.hasOwnProperty(o)&&this.add(o,r[o])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}(),c=function(){function e(){}return e.getCtxCallback=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}},e.urlParamExists=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),new RegExp("[\\?&]"+e+"=([^&#]*)").test(location.search)},e.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},e.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e);return!(""===t||/false|0/i.test(t))},e.stringInsert=function(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e},e.dateAdd=function(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r},e.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>0){var r=document.createElement("link");n[0].appendChild(r),r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",e)}},e.combinePaths=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.filter(function(t){return!e.stringIsNullOrEmpty(t)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")},e.getRandomString=function(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")},e.getGUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},e.isFunction=function(e){return"function"==typeof e},e.objectDefinedNotNull=function(e){return void 0!==e&&null!==e},e.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},e.stringIsNullOrEmpty=function(e){return void 0===e||null===e||e.length<1},e.extend=function(t,n,r){if(void 0===r&&(r=!1),!e.objectDefinedNotNull(n))return t;var o=r?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(n).filter(function(e){return o(t,e)}).reduce(function(e,t){return e[t]=n[t],e},t)},e.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},e}(),l=(function(e){function t(t){void 0===t&&(t="Expected a function.");var n=e.call(this,t)||this;return n.name="FunctionExpectedException",u.b.log({data:{},level:u.a.Error,message:"["+n.name+"]::"+n.message}),n}Object(s.b)(t,e)}(Error),function(e){function t(t){var n=e.call(this,t)||this;return n.name="UrlException",u.b.log({data:{},level:u.a.Error,message:"["+n.name+"]::"+n.message}),n}Object(s.b)(t,e)}(Error),function(){function e(){}return e.defaultCachingStore="defaultCachingStore",e.defaultCachingTimeoutSeconds="defaultCachingTimeoutSeconds",e.globalCacheDisable="globalCacheDisable",e.enableCacheExpiration="enableCacheExpiration",e.cacheExpirationIntervalMilliseconds="cacheExpirationIntervalMilliseconds",e.spfxContext="spfxContext",e}()),f=function(){function e(){this._v=new a,this._v.add(l.defaultCachingStore,"session"),this._v.add(l.defaultCachingTimeoutSeconds,60),this._v.add(l.globalCacheDisable,!1),this._v.add(l.enableCacheExpiration,!1),this._v.add(l.cacheExpirationIntervalMilliseconds,750),this._v.add(l.spfxContext,null)}return e.prototype.extend=function(e){var t=this;Object.keys(e).forEach(function(n){t._v.add(n,e[n])})},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(l.defaultCachingStore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(l.defaultCachingTimeoutSeconds)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(l.globalCacheDisable)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(l.enableCacheExpiration)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(l.cacheExpirationIntervalMilliseconds)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(l.spfxContext)},enumerable:!0,configurable:!0}),e}(),p=new f,h=p,d=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),h.enableCacheExpiration&&(u.b.write("Enabling cache expiration.",u.a.Info),this.cacheExpirationHandler())}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(u.b.write("Removing item with key '"+e+"' from cache due to expiration.",u.a.Info),this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=h.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=c.dateAdd(new Date,"second",n)}return JSON.stringify({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;u.b.write("Called cache expiration handler.",u.a.Verbose),this.deleteExpired().then(function(t){setTimeout(c.getCtxCallback(e,e.cacheExpirationHandler),h.cacheExpirationIntervalMilliseconds)}).catch(function(e){u.b.log({data:e,level:u.a.Error,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},e}(),b=function(){function e(e){void 0===e&&(e=new a),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.count()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return this._store.getKeys()[e]},e.prototype.removeItem=function(e){this._store.remove(e)},e.prototype.setItem=function(e,t){this._store.add(e,t)},e}(),y=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=new d("undefined"!=typeof localStorage?localStorage:new b)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=new d("undefined"!=typeof sessionStorage?sessionStorage:new b)),this._session},enumerable:!0,configurable:!0}),e}()},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r});var r;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(r||(r={}));var o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=r.Verbose),e.instance.log({level:n,message:t})},e.writeJSON=function(t,n){void 0===n&&(n=r.Verbose),e.instance.log({level:n,message:JSON.stringify(t)})},e.log=function(t){e.instance.log(t)},e.measure=function(t,n){return e.instance.measure(t,n)},e}(),i=function(){function e(e,t){void 0===e&&(e=r.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=r.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){void 0===e||e.level<this.activeLogLevel||this.subscribers.map(function(t){return t.log(e)})},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}();(function(){function e(){}e.prototype.log=function(e){var t=this.format(e);switch(e.level){case r.Verbose:case r.Info:console.log(t);break;case r.Warning:console.warn(t);break;case r.Error:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")}})(),function(){function e(e){this.method=e}e.prototype.log=function(e){this.method(e)}}()},function(e,t,n){"use strict";function r(e){return l.b.log({data:e.result,level:l.a.Verbose,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(e.result||null)}function o(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function i(e){var t=e.pipeline.shift();return void 0!==t?t(e):Promise.resolve(e)}function u(e){return i(e).then(function(e){return r(e)}).catch(function(e){throw l.b.log({data:e,level:l.a.Error,message:"Error in request pipeline: "+e.message}),e})}function s(e){return void 0===e&&(e=!1),function(t,n,r){var o=r.value;r.value=function(){for(var r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];return!e&&r.length>0&&r[0].hasOwnProperty("hasResult")&&r[0].hasResult?(l.b.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",l.a.Verbose),Promise.resolve(r[0])):(l.b.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",l.a.Verbose),o.apply(t,r).then(function(e){return i(e)}))}}}n.d(t,"a",function(){return v}),n.d(t,"b",function(){return m}),n.d(t,"e",function(){return w}),n.d(t,"d",function(){return x}),n.d(t,"c",function(){return O});var a=n(2),c=n(0),l=n(3),f=function(){function e(e){this.key=e,this.expiration=a.d.dateAdd(new Date,"second",a.c.defaultCachingTimeoutSeconds),this.storeName=a.c.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new a.b,e}(),p=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}(),h=function(e){function t(t,n,r){var o=e.call(this,"Error making HttpClient request in queryable: ["+t+"] "+n)||this;return o.status=t,o.statusText=n,o.data=r,o.name="ProcessHttpClientResponseException",l.b.log({data:o.data,level:l.a.Error,message:o.message}),o}return Object(c.b)(t,e),t}(Error),d=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var n=e.call(this,t)||this;return n.name="AlreadyInBatchException",l.b.log({data:{},level:l.a.Error,message:"["+n.name+"]::"+n.message}),n}return Object(c.b)(t,e),t}(Error),b=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length")||"-1")||204===e.status?n({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return n(t.parseODataJSON(e))}).catch(function(e){return r(e)}))})},e.prototype.handleError=function(e,t){return e.ok||e.json().then(function(n){var r={responseBody:n,responseHeaders:e.headers};t(new h(e.status,e.statusText,r))}).catch(function(n){l.b.log({data:n,level:l.a.Warning,message:"There was an error parsing the error response body. See data for details."});var r={responseBody:"[[body not available]]",responseHeaders:e.headers};t(new h(e.status,e.statusText,r))}),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.b)(t,e),t}(b),g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(c.b)(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})}}(b),function(){function e(){}return e.prototype.parse=function(e){return e.json()},e}()),v=(new g,function(){function e(){}e.prototype.parse=function(e){return e.text()}}(),function(){function e(){}return e.prototype.parse=function(e){return e.blob()},e}()),m=(function(){function e(){}e.prototype.parse=function(e){return e.json()}}(),function(){function e(){}return e.prototype.parse=function(e){return a.d.isFunction(e.arrayBuffer)?e.arrayBuffer():e.buffer()},e}()),w=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){l.b.log({data:l.b.activeLogLevel===l.a.Info?{}:e,level:l.a.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if("GET"===e.verb&&e.isCached){l.b.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",l.a.Info);var n=new f(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=a.d.extend(n,e.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return l.b.log({data:l.b.activeLogLevel===l.a.Info?{}:r,level:l.a.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),e.batchDependency(),o(e,r).then(function(e){return t(e)})}l.b.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",l.a.Info),e.parser=new p(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var r=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser);e.batchDependency(),l.b.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",l.a.Info),t(o(e,r))}else{l.b.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",l.a.Info);var i=e.clientFactory(),u=a.d.extend(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,u).then(function(t){return e.parser.parse(t)}).then(function(t){return o(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?l.b.log({data:l.b.activeLogLevel===l.a.Info?{}:e,level:l.a.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):l.b.log({data:l.b.activeLogLevel===l.a.Info?{}:e,level:l.a.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},Object.defineProperty(e,"default",{get:function(){return[e.logStart,e.caching,e.send,e.logEnd]},enumerable:!0,configurable:!0}),Object(c.a)([s(!0)],e,"logStart",null),Object(c.a)([s()],e,"caching",null),Object(c.a)([s()],e,"send",null),Object(c.a)([s(!0)],e,"logEnd",null),e}(),x=function(){function e(){this._batch=null,this._query=new a.a,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null}return e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return Object(a.g)(this._options,e),this},e.prototype.usingCaching=function(e){return a.c.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.inBatch=function(e){if(null!==this.batch)throw new d;return this._batch=e,this},e.prototype.toUrl=function(){return this._url},e.prototype.get=function(e,t){return void 0===e&&(e=new y),void 0===t&&(t={}),this.toRequestContext("GET",t,e,w.default).then(function(e){return u(e)})},e.prototype.getAs=function(e,t){return void 0===e&&(e=new y),void 0===t&&(t={}),this.toRequestContext("GET",t,e,w.default).then(function(e){return u(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("POST",e,t,w.default).then(function(e){return u(e)})},e.prototype.postAsCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("POST",e,t,w.default).then(function(e){return u(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("PATCH",e,t,w.default).then(function(e){return u(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("DELETE",e,t,w.default).then(function(e){return u(e)})},e.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(e.prototype,"hasBatch",{get:function(){return a.d.objectDefinedNotNull(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),e.prototype.append=function(e){this._url=a.d.combinePaths(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e}(),O=function(){function e(e){void 0===e&&(e=a.d.getGUID()),this._batchId=e,this._requests=[],this._dependencies=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._requests},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r){var o={method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i},e.prototype.addDependency=function(){var e=function(){},t=new Promise(function(t){e=t});return this._dependencies.push(t),e},e.prototype.execute=function(){var e=this;return Promise.all(this._dependencies).then(function(){return Promise.all(e._dependencies)}).then(function(){return e.executeImpl()})},e}()},function(e,t,n){"use strict";function r(e){o.c.extend(e)}t.b=r,n.d(t,"a",function(){return s});var o=n(2),i=n(7),u=function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=o.c.get("graph");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=o.c.get("graph");if(void 0!==e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==o.c.spfxContext)return function(){return o.c.spfxContext.graphHttpClient};throw new i.b},enumerable:!0,configurable:!0}),e}(),s=new u},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),o=n(5),i=function(){function e(){this._impl=o.a.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;Object(r.f)(n,o.a.headers),Object(r.f)(n,t.headers);var i=r.d.extend(t,{headers:n});return this.fetchRaw(e,i)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var o=new Headers;Object(r.f)(o,t.headers),t=r.d.extend(t,{headers:o});var i=function(o){n._impl.fetch(e,{},t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(r.d.getCtxCallback(n,i,o),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=r.d.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=r.d.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=r.d.extend(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=r.d.extend(t,{method:"DELETE"});return this.fetch(e,n)},e}()},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u});var r=n(0),o=n(3),i=function(e){function t(t){void 0===t&&(t="There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.");var n=e.call(this,t)||this;return n.name="NoGraphClientAvailableException",o.b.log({data:null,level:o.a.Error,message:n.message}),n}return r.b(t,e),t}(Error),u=function(e){function t(t){var n=e.call(this,t)||this;return n.name="GraphBatchParseException",o.b.log({data:{},level:o.a.Error,message:"["+n.name+"]::"+n.message}),n}return r.b(t,e),t}(Error)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);n.d(t,"graph",function(){return r.g}),n.d(t,"GraphRest",function(){return r.f}),n.d(t,"GraphBatch",function(){return r.a}),n.d(t,"GraphQueryable",function(){return r.b}),n.d(t,"GraphQueryableCollection",function(){return r.c}),n.d(t,"GraphQueryableInstance",function(){return r.d}),n.d(t,"GraphQueryableSearchableCollection",function(){return r.e})},function(e,t,n){"use strict";var r=n(10);n.d(t,"g",function(){return r.b}),n.d(t,"f",function(){return r.a});var o=n(19);n.d(t,"a",function(){return o.a});var i=n(1);n.d(t,"b",function(){return i.a}),n.d(t,"c",function(){return i.b}),n.d(t,"d",function(){return i.c}),n.d(t,"e",function(){return i.d})},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u});var r=n(11),o=n(5),i=function(){function e(){}return Object.defineProperty(e.prototype,"v1",{get:function(){return new r.a("")},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){Object(o.b)(e)},e}(),u=new i},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),o=n(1),i=n(12),u=function(e){function t(t,n){return void 0===n&&(n="v1.0"),e.call(this,t,n)||this}return r.b(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.a(this)},enumerable:!0,configurable:!0}),t}(o.a)},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r,o=n(0),i=n(1),u=n(13),s=n(2),a=n(14),c=n(15),l=n(17),f=n(18);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(r||(r={}));var p=function(e){function t(t,n){return void 0===n&&(n="groups"),e.call(this,t,n)||this}return o.b(t,e),t.prototype.getById=function(e){return new h(this,e)},t.prototype.add=function(e,t,n,o){var i=this;void 0===o&&(o={});var u=s.d.extend({displayName:e,mailEnabled:n===r.Office365,mailNickname:t,securityEnabled:n!==r.Office365},o);return n!==r.Security&&(u=s.d.extend(u,{groupTypes:[n===r.Office365?"Unified":"DynamicMembership"]})),this.postCore({body:JSON.stringify(u)}).then(function(e){return{data:e,group:i.getById(e.id)}})},t}(i.b),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.b(t,e),Object.defineProperty(t.prototype,"caldendar",{get:function(){return new a.a(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new a.b(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new u.b(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new l.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new u.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new c.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new c.b(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new c.b(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new f.a(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,n){var r=this.clone(t,"calendarView");return r.query.add("startDateTime",e.toISOString()),r.query.add("endDateTime",n.toISOString()),r.get()},t}(i.c)},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var r=n(0),o=n(1),i=function(e){function t(t,n){return void 0===n&&(n="members"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.getById=function(e){return new u(this,e)},t}(o.b),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(o.c),s=function(e){function t(t,n){return void 0===n&&(n="owners"),e.call(this,t,n)||this}return r.b(t,e),t}(i)},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u});var r=n(0),o=n(1),i=(function(e){function t(t,n){return void 0===n&&(n="calendars"),e.call(this,t,n)||this}r.b(t,e)}(o.b),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t}(o.c)),u=function(e){function t(t,n){return void 0===n&&(n="events"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new s(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:JSON.stringify(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t}(o.b),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.c)},function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return p});var r=n(0),o=n(1),i=n(16),u=function(e){function t(t,n){return void 0===n&&(n="conversations"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getById=function(e){return new c(this,e)},t}(o.b),s=function(e){function t(t,n){return void 0===n&&(n="threads"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new l(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.b),a=function(e){function t(t,n){return void 0===n&&(n="posts"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new f(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.b),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.c),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new a(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(o.c),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new i.a(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:JSON.stringify(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t}(o.c),p=function(e){function t(t,n){return e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.remove=function(e){var n=this.clone(t,"$ref");return n.query.add("$id",e),n.deleteCore()},t}(o.b)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(1),i=function(e){function t(t,n){return void 0===n&&(n="attachments"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new u(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t}(o.b),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(o.c)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(1),i=function(e){function t(t,n){return void 0===n&&(n="planner/plans"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new u(this,e)},t}(o.b),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(o.c)},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),o=n(1),i=n(4),u=function(e){function t(t,n){return void 0===n&&(n="photo"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.a)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.b)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(o.c)},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),o=n(4),i=n(3),u=n(2),s=n(5),a=n(6),c=n(7),l=function(e){function t(t){void 0===t&&(t="https://graph.microsoft.com/beta/$batch");var n=e.call(this)||this;return n.batchUrl=t,n}return r.b(t,e),t.prototype.executeImpl=function(){var e=this;i.b.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",i.a.Info);var t=new a.a,n={requests:this.formatRequests()},r={body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};i.b.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",i.a.Info);var o=!1;return t.fetch(this.batchUrl,r).then(function(e){return e.json()}).then(this._parseResponse).then(function(t){return i.b.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",i.a.Info),t.responses.reduce(function(n,r,s){var a=e.requests[s];if(u.d.objectDefinedNotNull(a))return i.b.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+a.method+" "+a.url+".",i.a.Verbose),n.then(function(e){return a.parser.parse(r).then(a.resolve).catch(a.reject)});if(!u.d.stringIsNullOrEmpty(t.nextLink))throw new c.a("Could not properly parse responses to match requests in batch.");return o=!0,n},Promise.resolve())})},t.prototype.formatRequests=function(){return this.requests.map(function(e,t){var n={id:""+ ++t,method:e.method,url:e.url},r={};return void 0!==s.a.headers&&null!==s.a.headers&&(r=u.d.extend(r,s.a.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(r=u.d.extend(r,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(n=u.d.extend(n,{body:e.options.body}))),n=u.d.extend(n,{headers:r})})},t.prototype._parseResponse=function(e){var t=this;return new Promise(function(n){for(var r=new Array(t.requests.length).fill(null),o=0;o<e.responses.length;++o){var i=e.responses[o],u=parseInt(i.id,10)-1;204===i.status?r[u]=new Response:r[u]=new Response(null,{headers:i.headers,status:i.status})}n({nextLink:e.nextLink,responses:r})})},r.a([Object(u.e)("Graph batching functionality is in beta.")],t.prototype,"executeImpl",null),t}(o.c)}])});
//# sourceMappingURL=graph.es5.umd.bundle.min.js.map