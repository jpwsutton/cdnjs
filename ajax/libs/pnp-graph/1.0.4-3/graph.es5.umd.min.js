/**
@license
 * @pnp/graph v1.0.4-3 - pnp - provides functionality to query the Microsoft Graph
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnp/
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("tslib"),require("@pnp/common"),require("@pnp/odata"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/odata","@pnp/logging"],e):e((t.pnp=t.pnp||{},t.pnp.graph={}),t.tslib_1,t.pnp.common,t.pnp.odata,t.pnp.logging)}(this,function(t,e,n,r,o){"use strict";var i,u=function(t){function n(e){void 0===e&&(e="There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.");var n=t.call(this,e)||this;return n.name="NoGraphClientAvailableException",o.Logger.log({data:null,level:3,message:n.message}),n}return e.__extends(n,t),n}(Error),s=new(function(){function t(){}return Object.defineProperty(t.prototype,"headers",{get:function(){var t=n.RuntimeConfig.get("graph");return null!==t&&void 0!==t&&void 0!==t.headers?t.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClientFactory",{get:function(){var t=n.RuntimeConfig.get("graph");if(null!==t&&void 0!==t.fetchClientFactory)return t.fetchClientFactory;if(void 0!==n.RuntimeConfig.spfxContext)return function(){return n.AdalClient.fromSPFxContext(n.RuntimeConfig.spfxContext)};throw new u},enumerable:!0,configurable:!0}),t}()),p=function(){function t(){this._impl=s.fetchClientFactory()}return t.prototype.fetch=function(t,e){void 0===e&&(e={});var r=new Headers;n.mergeHeaders(r,s.headers),n.mergeHeaders(r,e.headers),r.has("Content-Type")||r.append("Content-Type","application/json");var o=n.extend(e,{headers:r});return this.fetchRaw(t,o)},t.prototype.fetchRaw=function(t,e){var r=this;void 0===e&&(e={});var o=new Headers;n.mergeHeaders(o,e.headers),e=n.extend(e,{headers:o});var i=function(o){r._impl.fetch(t,e).then(function(t){return o.resolve(t)}).catch(function(t){429!==t.status&&503!==t.status&&o.reject(t);var e=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(t),setTimeout(n.getCtxCallback(r,i,o),e)})};return new Promise(function(t,e){var n={attempts:0,delay:100,reject:e,resolve:t,retryCount:7};i.call(r,n)})},t.prototype.get=function(t,e){void 0===e&&(e={});var r=n.extend(e,{method:"GET"});return this.fetch(t,r)},t.prototype.post=function(t,e){void 0===e&&(e={});var r=n.extend(e,{method:"POST"});return this.fetch(t,r)},t.prototype.patch=function(t,e){void 0===e&&(e={});var r=n.extend(e,{method:"PATCH"});return this.fetch(t,r)},t.prototype.delete=function(t,e){void 0===e&&(e={});var r=n.extend(e,{method:"DELETE"});return this.fetch(t,r)},t}(),c=function(){function t(){}return t.ensure=function(e,n){var r=[t.Beta,t.V1],o=new RegExp(n,"i"),i=r.filter(function(t){return!o.test(t)}).map(function(t){return t.replace(".","\\.")});return o=new RegExp("/?("+i.join("|")+")/","ig"),e.replace(o,"/"+n+"/")},t.Beta="beta",t.V1="v1.0",t}(),a=function(t){function r(e,r){var o=t.call(this)||this;if("string"==typeof e){var i=e;o._parentUrl=i,o._url=n.combinePaths(i,r)}else o.extend(e,r);return o}return e.__extends(r,t),r.prototype.as=function(t){var e=new t(this._url,null);return n.extend(e,this,!0)},r.prototype.toUrlAndQuery=function(){var t=this,e=this.toUrl();return n.isUrlAbsolute(e)||(e=n.combinePaths("https://graph.microsoft.com",e)),e+"?"+this._query.getKeys().map(function(e){return e+"="+t._query.get(e)}).join("&")},r.prototype.getParent=function(t,e,n){return void 0===e&&(e=this.parentUrl),new t(e,n)},r.prototype.clone=function(t,e,n){void 0===n&&(n=!0);var r=new t(this,e);return r.configure(this._options),n&&(r=r.inBatch(this._batch)),r},r.prototype.setEndpoint=function(t){return this._url=c.ensure(this._url,t),this},r.prototype.toRequestContext=function(t,e,r,o){return void 0===e&&(e={}),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new p},isBatched:this.hasBatch,isCached:this._useCaching,options:e,parser:r,pipeline:o,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:n.getGUID(),verb:t})},r}(r.ODataQueryable),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.filter=function(t){return this._query.add("$filter",t),this},n.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$select",t.join(",")),this},n.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$expand",t.join(",")),this},n.prototype.orderBy=function(t,e){var n=this;void 0===e&&(e=!0);var r=this._query.getKeys().filter(function(t){return"$orderby"===t}).map(function(t){return n._query.get(t)});return r.push(t+" "+(e?"asc":"desc")),this._query.add("$orderby",r.join(",")),this},n.prototype.top=function(t){return this._query.add("$top",t.toString()),this},n.prototype.skip=function(t){return this._query.add("$top",t.toString()),this},n.prototype.skipToken=function(t){return this._query.add("$skiptoken",t),this},Object.defineProperty(n.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),n}(a),d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.search=function(t){return this._query.add("$search",t),this},n}(f),h=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$select",t.join(",")),this},n.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$expand",t.join(",")),this},n}(a),l=function(t){function n(e,n){return void 0===n&&(n="members"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.add=function(t){return this.clone(n,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},n.prototype.getById=function(t){return new y(this,t)},n}(f),y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n}(h),g=function(t){function n(e,n){return void 0===n&&(n="owners"),t.call(this,e,n)||this}return e.__extends(n,t),n}(l),b=(function(t){function n(e,n){return void 0===n&&(n="calendars"),t.call(this,e,n)||this}e.__extends(n,t)}(f),function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),n}(h)),m=function(t){function n(e,n){return void 0===n&&(n="events"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new v(this,t)},n.prototype.add=function(t){var e=this;return this.postCore({body:JSON.stringify(t)}).then(function(t){return{data:t,event:e.getById(t.id)}})},n}(f),v=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},n.prototype.delete=function(){return this.deleteCore()},n}(h),_=function(t){function n(e,n){return void 0===n&&(n="attachments"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new x(this,t)},n.prototype.addFile=function(t,e){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:e,name:t})})},n}(f),x=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n}(h),w=function(t){function n(e,n){return void 0===n&&(n="conversations"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},n.prototype.getById=function(t){return new j(this,t)},n}(f),C=function(t){function n(e,n){return void 0===n&&(n="threads"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new P(this,t)},n.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},n}(f),O=function(t){function n(e,n){return void 0===n&&(n="posts"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new S(this,t)},n.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},n}(f),j=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"threads",{get:function(){return new C(this)},enumerable:!0,configurable:!0}),n.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},n.prototype.delete=function(){return this.deleteCore()},n}(h),P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"posts",{get:function(){return new O(this)},enumerable:!0,configurable:!0}),n.prototype.reply=function(t){return this.clone(n,"reply").postCore({body:JSON.stringify({post:t})})},n.prototype.delete=function(){return this.deleteCore()},n}(h),S=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"attachments",{get:function(){return new _(this)},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.deleteCore()},n.prototype.forward=function(t){return this.clone(n,"forward").postCore({body:JSON.stringify(t)})},n.prototype.reply=function(t){return this.clone(n,"reply").postCore({body:JSON.stringify({post:t})})},n}(h),q=function(t){function n(e,n){return t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.add=function(t){return this.clone(n,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},n.prototype.remove=function(t){var e=this.clone(n,"$ref");return e.query.add("$id",t),e.deleteCore()},n}(f),B=function(t){function n(e,n){return void 0===n&&(n="planner/plans"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new N(this,t)},n}(f),N=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n}(h),T=function(t){function n(e,n){return void 0===n&&(n="photo"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getBlob=function(){return this.clone(n,"$value",!1).get(new r.BlobParser)},n.prototype.getBuffer=function(){return this.clone(n,"$value",!1).get(new r.BufferParser)},n.prototype.setContent=function(t){return this.clone(n,"$value",!1).patchCore({body:t})},n}(h),I=function(){function e(){}return e.prototype.create=function(e,n,r){void 0===n&&(n=""),void 0===r&&(r={});var o=n&&n.length>0?{description:n}:{};return H.groups.add(e,e,t.GroupType.Office365,o).then(function(t){return t.group.createTeam(r).then(function(e){return{data:e,group:t.group,team:new G(t.group)}})})},e}(),G=function(t){function n(e,n){return void 0===n&&(n="team"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.update=function(t){var e=this;return this.clone(n,"").setEndpoint(c.Beta).patchCore({body:JSON.stringify(t)}).then(function(t){return{data:t,team:e}})},n.prototype.get=function(t,e){return void 0===t&&(t=new r.ODataDefaultParser),void 0===e&&(e={}),this.clone(n,"").setEndpoint(c.Beta).getCore(t,e)},n}(h);(i=t.GroupType||(t.GroupType={}))[i.Office365=0]="Office365",i[i.Dynamic=1]="Dynamic",i[i.Security=2]="Security";var J=function(r){function o(t,e){return void 0===e&&(e="groups"),r.call(this,t,e)||this}return e.__extends(o,r),o.prototype.getById=function(t){return new $(this,t)},o.prototype.add=function(e,r,o,i){var u=this;void 0===i&&(i={});var s=n.extend({displayName:e,mailEnabled:o===t.GroupType.Office365,mailNickname:r,securityEnabled:o!==t.GroupType.Office365},i);return o!==t.GroupType.Security&&(s=n.extend(s,{groupTypes:o===t.GroupType.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:JSON.stringify(s)}).then(function(t){return{data:t,group:u.getById(t.id)}})},o}(f),$=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"calendar",{get:function(){return new b(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"owners",{get:function(){return new g(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"plans",{get:function(){return new B(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"members",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"conversations",{get:function(){return new w(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"acceptedSenders",{get:function(){return new q(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rejectedSenders",{get:function(){return new q(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"photo",{get:function(){return new T(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"team",{get:function(){return new G(this)},enumerable:!0,configurable:!0}),n.prototype.addFavorite=function(){return this.clone(n,"addFavorite").postCore()},n.prototype.createTeam=function(t){return this.clone(n,"team").setEndpoint(c.Beta).putCore({body:JSON.stringify(t)})},n.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(n,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:t})})},n.prototype.delete=function(){return this.deleteCore()},n.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},n.prototype.removeFavorite=function(){return this.clone(n,"removeFavorite").postCore()},n.prototype.resetUnseenCount=function(){return this.clone(n,"resetUnseenCount").postCore()},n.prototype.subscribeByMail=function(){return this.clone(n,"subscribeByMail").postCore()},n.prototype.unsubscribeByMail=function(){return this.clone(n,"unsubscribeByMail").postCore()},n.prototype.getCalendarView=function(t,e){var r=this.clone(n,"calendarView");return r.query.add("startDateTime",t.toISOString()),r.query.add("endDateTime",e.toISOString()),r.get()},n}(h),E=function(t){function n(e,n){return void 0===n&&(n="onenote"),t.call(this,e,n)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"notebooks",{get:function(){return new R(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sections",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pages",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),n}(h),R=function(t){function n(e,n){return void 0===n&&(n="notebooks"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new D(this,t)},n.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:JSON.stringify(n)}).then(function(t){return{data:t,notebook:e.getById(t.id)}})},n}(f),D=function(t){function n(e,n){return t.call(this,e,n)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"sections",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),n}(h),k=function(t){function n(e,n){return void 0===n&&(n="sections"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new U(this,t)},n.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:JSON.stringify(n)}).then(function(t){return{data:t,section:e.getById(t.id)}})},n}(f),U=function(t){function n(e,n){return t.call(this,e,n)||this}return e.__extends(n,t),n}(h),F=function(t){function n(e,n){return void 0===n&&(n="pages"),t.call(this,e,n)||this}return e.__extends(n,t),n}(f),A=function(t){function n(e,n){return void 0===n&&(n="me"),t.call(this,e,n)||this}return e.__extends(n,t),Object.defineProperty(n.prototype,"onenote",{get:function(){return new E(this)},enumerable:!0,configurable:!0}),n}(h),L=function(t){function n(e,n){return void 0===n&&(n="users"),t.call(this,e,n)||this}return e.__extends(n,t),n.prototype.getById=function(t){return new M(this,t)},n}(f),M=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n}(h),Q=function(t){function r(e,n){return t.call(this,e,n)||this}return e.__extends(r,t),Object.defineProperty(r.prototype,"groups",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"teams",{get:function(){return new I},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"me",{get:function(){return new A(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"users",{get:function(){return new L(this)},enumerable:!0,configurable:!0}),r.prototype.setup=function(t){var e;e=t,n.RuntimeConfig.extend(e)},r}(a),H=new Q("v1.0"),V=function(t){function n(e){var n=t.call(this,e)||this;return n.name="GraphBatchParseException",o.Logger.log({data:{},level:3,message:"["+n.name+"]::"+n.message}),n}return e.__extends(n,t),n}(Error),K=function(t){function r(e){void 0===e&&(e="https://graph.microsoft.com/beta/$batch");var n=t.call(this)||this;return n.batchUrl=e,n}return e.__extends(r,t),r.prototype.executeImpl=function(){var t=this;o.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1);var e=new p,r={requests:this.formatRequests()},i={body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return o.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),e.fetch(this.batchUrl,i).then(function(t){return t.json()}).then(this._parseResponse).then(function(e){return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.responses.reduce(function(r,i,u){var s=t.requests[u];if(n.objectDefinedNotNull(s))return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+s.method+" "+s.url+".",0),r.then(function(t){return s.parser.parse(i).then(s.resolve).catch(s.reject)});if(e.nextLink)throw new V("Could not properly parse responses to match requests in batch.");return r},Promise.resolve())})},r.prototype.formatRequests=function(){return this.requests.map(function(t,e){var r={id:""+ ++e,method:t.method,url:t.url},o={};return void 0!==s.headers&&null!==s.headers&&(o=n.extend(o,s.headers)),void 0!==t.options&&(void 0!==t.options.headers&&null!==t.options.headers&&(o=n.extend(o,t.options.headers)),void 0!==t.options.body&&null!==t.options.body&&(r=n.extend(r,{body:t.options.body}))),r=n.extend(r,{headers:o})})},r.prototype._parseResponse=function(t){var e=this;return new Promise(function(n){for(var r=new Array(e.requests.length).fill(null),o=0;o<t.responses.length;++o){var i=t.responses[o],u=parseInt(i.id,10)-1;204===i.status?r[u]=new Response:r[u]=new Response(null,{headers:i.headers,status:i.status})}n({nextLink:t.nextLink,responses:r})})},e.__decorate([n.beta("Graph batching functionality is in beta.")],r.prototype,"executeImpl",null),r}(r.ODataBatch);t.graph=H,t.GraphRest=Q,t.Group=$,t.Groups=J,t.GraphBatch=K,t.GraphQueryable=a,t.GraphQueryableCollection=f,t.GraphQueryableInstance=h,t.GraphQueryableSearchableCollection=d,t.Teams=I,t.Team=G,t.GraphEndpoints=c,t.OneNote=E,t.Notebooks=R,t.Notebook=D,t.Sections=k,t.Section=U,t.Pages=F,Object.defineProperty(t,"__esModule",{value:!0})});