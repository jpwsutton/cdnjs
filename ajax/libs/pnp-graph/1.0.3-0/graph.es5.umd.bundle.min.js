/**
@license
 * @pnp/graph v1.0.3-0 - pnp - provides functionality to query the Microsoft Graph
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pnp=e():t.pnp=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";function r(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u}e.b=r,e.a=o;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};Object.assign},function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"d",function(){return a}),n.d(e,"c",function(){return f});var r=n(0),o=n(2),i=n(4),u=n(6),s=function(t){function e(e,n){var r=t.call(this)||this;if("string"==typeof e){var i=e;r._parentUrl=i,r._url=o.d.combinePaths(i,n)}else{var u=e;r._parentUrl=u._url,r._options=u._options,r._url=o.d.combinePaths(r._parentUrl,n)}return r}return r.b(e,t),e.prototype.as=function(t){var e=new t(this._url,null);return o.d.extend(e,this,!0)},e.prototype.toUrlAndQuery=function(){var t=this;return this.toUrl()+"?"+this._query.getKeys().map(function(e){return e+"="+t._query.get(e)}).join("&")},e.prototype.getParent=function(t,e,n){return void 0===e&&(e=this.parentUrl),new t(e,n)},e.prototype.clone=function(t,e,n){void 0===n&&(n=!0);var r=new t(this,e);return r.configure(this._options),n&&(r=r.inBatch(this._batch)),r},e.prototype.toRequestContext=function(t,e,n,r){return void 0===e&&(e={}),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new u.a},isBatched:this.hasBatch,isCached:this._useCaching,options:e,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:o.d.getGUID(),verb:t})},e}(i.d),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.filter=function(t){return this._query.add("$filter",t),this},e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$select",t.join(",")),this},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$expand",t.join(",")),this},e.prototype.orderBy=function(t,e){var n=this;void 0===e&&(e=!0);var r=this._query.getKeys().filter(function(t){return"$orderby"===t}).map(function(t){return n._query.get(t)});return r.push(t+" "+(e?"asc":"desc")),this._query.add("$orderby",r.join(",")),this},e.prototype.top=function(t){return this._query.add("$top",t.toString()),this},e.prototype.skip=function(t){return this._query.add("$top",t.toString()),this},e.prototype.skipToken=function(t){return this._query.add("$skiptoken",t),this},Object.defineProperty(e.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),e}(s),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.search=function(t){return this._query.add("$search",t),this},e}(c),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$select",t.join(",")),this},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this._query.add("$expand",t.join(",")),this},e}(s)},function(t,e,n){"use strict";(function(t){function r(t){return void 0===t&&(t="This feature is flagged as beta and is subject to change."),function(e,n,r){var o=r.value;r.value=function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return g.a.log({data:{descriptor:r,propertyKey:n,target:e},level:2,message:t}),o.apply(this,i)}}}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){e.apply(t,n)}}function i(t,e,n){var r=new Date(t);switch(e.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.filter(function(t){return!_.stringIsNullOrEmpty(t)}).map(function(t){return t.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function s(t){for(var e=new Array(t),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e[r]=n.charAt(Math.floor(Math.random()*n.length));return e.join("")}function c(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})}function a(t){return"function"==typeof t}function f(t){return void 0!==t&&null!==t}function l(t){return Array.isArray?Array.isArray(t):t&&"number"==typeof t.length&&t.constructor===Array}function p(t,e,n){if(void 0===n&&(n=!1),!_.objectDefinedNotNull(e))return t;var r=n?function(t,e){return!(e in t)}:function(){return!0};return Object.getOwnPropertyNames(e).filter(function(e){return r(t,e)}).reduce(function(t,n){return t[n]=e[n],t},t)}function h(t){return/^https?:\/\/|^\/\//i.test(t)}function d(t){return void 0===t||null===t||t.length<1}function y(t,e){if(void 0!==e&&null!==e){new Request("",{headers:e}).headers.forEach(function(e,n){t.append(n,e)})}}function b(t,e){if(_.objectDefinedNotNull(e)){var n=_.extend(t.headers||{},e.headers);t=_.extend(t,e),t.headers=n}}n.d(e,"a",function(){return m}),n.d(e,"e",function(){return r}),n.d(e,"c",function(){return O}),n.d(e,"f",function(){return y}),n.d(e,"g",function(){return b}),n.d(e,"b",function(){return q}),n.d(e,"d",function(){return _});var g=n(3),v=n(0),m=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this.keys=t,this.values=e}return t.prototype.get=function(t){var e=this.keys.indexOf(t);return e<0?null:this.values[e]},t.prototype.add=function(t,e){var n=this.keys.indexOf(t);n>-1?null===e?this.remove(t):this.values[n]=e:null!==e&&(this.keys.push(t),this.values.push(e))},t.prototype.merge=function(t){var e=this;if("getKeys"in t){var n=t;n.getKeys().map(function(t){e.add(t,n.get(t))})}else{var r=t;for(var o in r)r.hasOwnProperty(o)&&this.add(o,r[o])}},t.prototype.remove=function(t){var e=this.keys.indexOf(t);if(e<0)return null;var n=this.values[e];return this.keys.splice(e,1),this.values.splice(e,1),n},t.prototype.getKeys=function(){return this.keys},t.prototype.getValues=function(){return this.values},t.prototype.clear=function(){this.keys=[],this.values=[]},Object.defineProperty(t.prototype,"count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),t}(),w=(function(t){function e(e){var n=t.call(this,e)||this;return n.name="UrlException",g.a.log({data:{},level:3,message:"["+n.name+"]::"+n.message}),n}Object(v.b)(e,t)}(Error),function(){function t(){this._v=new m,this._v.add("defaultCachingStore","session"),this._v.add("defaultCachingTimeoutSeconds",60),this._v.add("globalCacheDisable",!1),this._v.add("enableCacheExpiration",!1),this._v.add("cacheExpirationIntervalMilliseconds",750),this._v.add("spfxContext",null)}return t.prototype.extend=function(t){var e=this;Object.keys(t).forEach(function(n){e._v.add(n,t[n])})},t.prototype.get=function(t){return this._v.get(t)},Object.defineProperty(t.prototype,"defaultCachingStore",{get:function(){return this.get("defaultCachingStore")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get("defaultCachingTimeoutSeconds")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCacheDisable",{get:function(){return this.get("globalCacheDisable")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableCacheExpiration",{get:function(){return this.get("enableCacheExpiration")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get("cacheExpirationIntervalMilliseconds")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spfxContext",{get:function(){return this.get("spfxContext")},enumerable:!0,configurable:!0}),t}()),x=new w,O=x,_=function(){function t(){}return t.getCtxCallback=o,t.dateAdd=i,t.combinePaths=u,t.getRandomString=s,t.getGUID=c,t.isFunc=a,t.objectDefinedNotNull=f,t.isArray=l,t.extend=p,t.isUrlAbsolute=h,t.stringIsNullOrEmpty=d,t}(),C=function(){function e(){}return e.prototype.fetch=function(e,n){return t.fetch(e,n)},e}(),j=(function(t){function e(e){var n=t.call(this)||this;return n._token=e,n}Object(v.b)(e,t),e.prototype.fetch=function(e,n){void 0===n&&(n={});var r=new Headers;return y(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,t.prototype.fetch.call(this,e,n)}}(C),function(){function t(t,e){void 0===e&&(e=-1),this.store=t,this.defaultTimeoutMinutes=e,this.enabled=this.test(),O.enableCacheExpiration&&(g.a.write("Enabling cache expiration.",1),this.cacheExpirationHandler())}return t.prototype.get=function(t){if(!this.enabled)return null;var e=this.store.getItem(t);if(null==e)return null;var n=JSON.parse(e);return new Date(n.expiration)<=new Date?(g.a.write("Removing item with key '"+t+"' from cache due to expiration.",1),this.delete(t),null):n.value},t.prototype.put=function(t,e,n){this.enabled&&this.store.setItem(t,this.createPersistable(e,n))},t.prototype.delete=function(t){this.enabled&&this.store.removeItem(t)},t.prototype.getOrPut=function(t,e,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(t);null==i?e().then(function(e){r.put(t,e,n),o(e)}):o(i)}):e()},t.prototype.deleteExpired=function(){var t=this;return new Promise(function(e,n){t.enabled||e();try{for(var r=0;r<t.store.length;r++){var o=t.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(t.store.getItem(o))&&t.get(o)}e()}catch(t){n(t)}})},t.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(t){return!1}},t.prototype.createPersistable=function(t,e){if(void 0===e){var n=O.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),e=_.dateAdd(new Date,"second",n)}return JSON.stringify({pnp:1,expiration:e,value:t})},t.prototype.cacheExpirationHandler=function(){var t=this;g.a.write("Called cache expiration handler.",0),this.deleteExpired().then(function(e){setTimeout(_.getCtxCallback(t,t.cacheExpirationHandler),O.cacheExpirationIntervalMilliseconds)}).catch(function(t){g.a.log({data:t,level:3,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},t}()),P=function(){function t(t){void 0===t&&(t=new m),this._store=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this._store.count},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._store.clear()},t.prototype.getItem=function(t){return this._store.get(t)},t.prototype.key=function(t){return this._store.getKeys()[t]},t.prototype.removeItem=function(t){this._store.remove(t)},t.prototype.setItem=function(t,e){this._store.add(t,e)},t}(),q=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._local=t,this._session=e}return Object.defineProperty(t.prototype,"local",{get:function(){return null===this._local&&(this._local=new j("undefined"!=typeof localStorage?localStorage:new P)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"session",{get:function(){return null===this._session&&(this._session=new j("undefined"!=typeof sessionStorage?sessionStorage:new P)),this._session},enumerable:!0,configurable:!0}),t}()}).call(e,n(12))},function(t,e,n){"use strict";n.d(e,"a",function(){return r});/**
@license
 * @pnp/logging v1.0.3-0 - pnp - light-weight, subscribable logging framework
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
var r=function(){function t(){}return Object.defineProperty(t,"activeLogLevel",{get:function(){return t.instance.activeLogLevel},set:function(e){t.instance.activeLogLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return void 0!==t._instance&&null!==t._instance||(t._instance=new o),t._instance},enumerable:!0,configurable:!0}),t.subscribe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.map(function(e){return t.instance.subscribe(e)})},t.clearSubscribers=function(){return t.instance.clearSubscribers()},Object.defineProperty(t,"count",{get:function(){return t.instance.count},enumerable:!0,configurable:!0}),t.write=function(e,n){void 0===n&&(n=0),t.instance.log({level:n,message:e})},t.writeJSON=function(e,n){void 0===n&&(n=0),t.instance.log({level:n,message:JSON.stringify(e)})},t.log=function(e){t.instance.log(e)},t.error=function(e){t.instance.log({data:e,level:3,message:e.message})},t}(),o=function(){function t(t,e){void 0===t&&(t=2),void 0===e&&(e=[]),this.activeLogLevel=t,this.subscribers=e}return t.prototype.subscribe=function(t){this.subscribers.push(t)},t.prototype.clearSubscribers=function(){var t=this.subscribers.slice(0);return this.subscribers.length=0,t},Object.defineProperty(t.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),t.prototype.write=function(t,e){void 0===e&&(e=0),this.log({level:e,message:t})},t.prototype.log=function(t){void 0!==t&&this.activeLogLevel<=t.level&&this.subscribers.map(function(e){return e.log(t)})},t}();(function(){function t(){}t.prototype.log=function(t){var e=this.format(t);switch(t.level){case 0:case 1:console.log(e);break;case 2:console.warn(e);break;case 3:console.error(e)}},t.prototype.format=function(t){var e=[];return e.push("Message: "+t.message),void 0!==t.data&&e.push(" Data: "+JSON.stringify(t.data)),e.join("")}})(),function(){function t(t){this.method=t}t.prototype.log=function(t){this.method(t)}}()},function(t,e,n){"use strict";function r(t){return l.a.log({data:t.result,level:0,message:"["+t.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(t.result||null)}function o(t,e){return new Promise(function(n){t.result=e,t.hasResult=!0,n(t)})}function i(t){return t.pipeline.length>0?t.pipeline.shift()(t):Promise.resolve(t)}function u(t){return t.pipeline.length<1&&l.a.write("["+t.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2),i(t).then(function(t){return r(t)}).catch(function(t){throw l.a.error(t),t})}function s(t){return void 0===t&&(t=!1),function(e,n,r){var o=r.value;r.value=function(){for(var r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];return!t&&r.length>0&&r[0].hasOwnProperty("hasResult")&&r[0].hasResult?(l.a.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(r[0])):(l.a.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),o.apply(e,r).then(function(t){return i(t)}))}}}function c(){return[m.logStart,m.caching,m.send,m.logEnd].slice(0)}n.d(e,"a",function(){return g}),n.d(e,"b",function(){return v}),n.d(e,"d",function(){return x}),n.d(e,"c",function(){return O});var a=n(2),f=n(0),l=n(3),p=function(){function t(t){this.key=t,this.expiration=a.d.dateAdd(new Date,"second",a.c.defaultCachingTimeoutSeconds),this.storeName=a.c.defaultCachingStore}return Object.defineProperty(t.prototype,"store",{get:function(){return"local"===this.storeName?t.storage.local:t.storage.session},enumerable:!0,configurable:!0}),t.storage=new a.b,t}(),h=function(){function t(t,e){this._parser=t,this._cacheOptions=e}return t.prototype.parse=function(t){var e=this;return this._parser.parse(t).then(function(t){return null!==e._cacheOptions.store&&e._cacheOptions.store.put(e._cacheOptions.key,t,e._cacheOptions.expiration),t})},t}(),d=function(t){function e(e,n,r){var o=t.call(this,"Error making HttpClient request in queryable: ["+e+"] "+n)||this;return o.status=e,o.statusText=n,o.data=r,o.name="ProcessHttpClientResponseException",l.a.log({data:o.data,level:3,message:o.message}),o}return Object(f.b)(e,t),e}(Error),y=function(){function t(){}return t.prototype.parse=function(t){var e=this;return new Promise(function(n,r){e.handleError(t,r)&&t.text().then(function(t){return t.replace(/\s/gi,"").length>0?JSON.parse(t):{}}).then(function(t){return n(e.parseODataJSON(t))}).catch(function(t){return r(t)})})},t.prototype.handleError=function(t,e){return t.ok||t.json().then(function(n){var r={responseBody:n,responseHeaders:t.headers};e(new d(t.status,t.statusText,r))}).catch(function(n){l.a.log({data:n,level:2,message:"There was an error parsing the error response body. See data for details."});var r={responseBody:"[[body not available]]",responseHeaders:t.headers};e(new d(t.status,t.statusText,r))}),t.ok},t.prototype.parseODataJSON=function(t){var e=t;return t.hasOwnProperty("d")?e=t.d.hasOwnProperty("results")?t.d.results:t.d:t.hasOwnProperty("value")&&(e=t.value),e},t}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(f.b)(e,t),e}(y),g=(function(){function t(){}t.prototype.parse=function(t){return t.text()}}(),function(){function t(){}return t.prototype.parse=function(t){return t.blob()},t}()),v=(function(){function t(){}t.prototype.parse=function(t){return t.json()}}(),function(){function t(){}return t.prototype.parse=function(t){return a.d.isFunc(t.arrayBuffer)?t.arrayBuffer():t.buffer()},t}()),m=function(){function t(){}return t.logStart=function(t){return new Promise(function(e){l.a.log({data:1===l.a.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Beginning "+t.verb+" request ("+t.requestAbsoluteUrl+")"}),e(t)})},t.caching=function(t){return new Promise(function(e){if("GET"===t.verb&&t.isCached){l.a.write("["+t.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new p(t.requestAbsoluteUrl.toLowerCase());if(void 0!==t.cachingOptions&&(n=a.d.extend(n,t.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return l.a.log({data:1===l.a.activeLogLevel?{}:r,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),t.batchDependency(),t.parser.hasOwnProperty("hydrate")&&(r=t.parser.hydrate(r)),o(t,r).then(function(t){return e(t)})}l.a.write("["+t.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),t.parser=new h(t.parser,n)}return e(t)})},t.send=function(t){return new Promise(function(e,n){if(t.isBatched){var r=t.batch.add(t.requestAbsoluteUrl,t.verb,t.options,t.parser);t.batchDependency(),l.a.write("["+t.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+t.batch.batchId+".",1),e(o(t,r))}else{l.a.write("["+t.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var i=t.clientFactory(),u=a.d.extend(t.options||{},{method:t.verb});i.fetch(t.requestAbsoluteUrl,u).then(function(e){return t.parser.parse(e)}).then(function(e){return o(t,e)}).then(function(t){return e(t)}).catch(function(t){return n(t)})}})},t.logEnd=function(t){return new Promise(function(e){t.isBatched?l.a.log({data:1===l.a.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") "+t.verb+" request will complete in batch "+t.batch.batchId+"."}):l.a.log({data:1===l.a.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Completing "+t.verb+" request."}),e(t)})},Object(f.a)([s(!0)],t,"logStart",null),Object(f.a)([s()],t,"caching",null),Object(f.a)([s()],t,"send",null),Object(f.a)([s(!0)],t,"logEnd",null),t}(),w=function(t){function e(e){void 0===e&&(e="This query is already part of a batch.");var n=t.call(this,e)||this;return n.name="AlreadyInBatchException",l.a.error(n),n}return Object(f.b)(e,t),e}(Error),x=function(){function t(){this._batch=null,this._query=new a.a,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null}return t.prototype.concat=function(t){return this._url+=t,this},Object.defineProperty(t.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),t.prototype.configure=function(t){return Object(a.g)(this._options,t),this},t.prototype.usingCaching=function(t){return a.c.globalCacheDisable||(this._useCaching=!0,void 0!==t&&(this._cachingOptions=t)),this},t.prototype.inBatch=function(t){if(null!==this.batch)throw new w;return this._batch=t,this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(t,e){return void 0===t&&(t=new b),void 0===e&&(e={}),this.toRequestContext("GET",e,t,c()).then(function(t){return u(t)})},t.prototype.postCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new b),this.toRequestContext("POST",t,e,c()).then(function(t){return u(t)})},t.prototype.patchCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new b),this.toRequestContext("PATCH",t,e,c()).then(function(t){return u(t)})},t.prototype.deleteCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new b),this.toRequestContext("DELETE",t,e,c()).then(function(t){return u(t)})},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return a.d.objectDefinedNotNull(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype.append=function(t){this._url=a.d.combinePaths(this._url,t)},Object.defineProperty(t.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),t}(),O=function(){function t(t){void 0===t&&(t=a.d.getGUID()),this._batchId=t,this._requests=[],this._dependencies=[]}return Object.defineProperty(t.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requests",{get:function(){return this._requests},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e,n,r){var o={method:e.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:t},i=new Promise(function(t,e){o.resolve=t,o.reject=e});return this._requests.push(o),i},t.prototype.addDependency=function(){var t=function(){},e=new Promise(function(e){t=e});return this._dependencies.push(e),t},t.prototype.execute=function(){var t=this;return Promise.all(this._dependencies).then(function(){return Promise.all(t._dependencies)}).then(function(){return t.executeImpl()})},t}()},function(t,e,n){"use strict";function r(t){i.c.extend(t)}e.b=r,n.d(e,"a",function(){return f});var o=n(0),i=n(2),u=n(3),s=n(7),c=function(t){function e(e){void 0===e&&(e="There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.");var n=t.call(this,e)||this;return n.name="NoGraphClientAvailableException",u.a.log({data:null,level:3,message:n.message}),n}return o.b(e,t),e}(Error),a=function(){function t(){}return Object.defineProperty(t.prototype,"headers",{get:function(){var t=i.c.get("graph");return null!==t&&void 0!==t&&void 0!==t.headers?t.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClientFactory",{get:function(){var t=i.c.get("graph");if(void 0!==t&&void 0!==t.fetchClientFactory)return t.fetchClientFactory;if(void 0!==i.c.spfxContext)return function(){return new s.a(i.c.spfxContext.graphHttpClient)};throw new c},enumerable:!0,configurable:!0}),t}(),f=new a},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),o=n(5),i=function(){function t(){this._impl=o.a.fetchClientFactory()}return t.prototype.fetch=function(t,e){void 0===e&&(e={});var n=new Headers;Object(r.f)(n,o.a.headers),Object(r.f)(n,e.headers);var i=r.d.extend(e,{headers:n});return this.fetchRaw(t,i)},t.prototype.fetchRaw=function(t,e){var n=this;void 0===e&&(e={});var o=new Headers;Object(r.f)(o,e.headers),e=r.d.extend(e,{headers:o});var i=function(o){n._impl.fetch(t,e).then(function(t){return o.resolve(t)}).catch(function(t){429!==t.status&&503!==t.status&&o.reject(t);var e=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(t),setTimeout(r.d.getCtxCallback(n,i,o),e)})};return new Promise(function(t,e){var r={attempts:0,delay:100,reject:e,resolve:t,retryCount:7};i.call(n,r)})},t.prototype.get=function(t,e){void 0===e&&(e={});var n=r.d.extend(e,{method:"GET"});return this.fetch(t,n)},t.prototype.post=function(t,e){void 0===e&&(e={});var n=r.d.extend(e,{method:"POST"});return this.fetch(t,n)},t.prototype.patch=function(t,e){void 0===e&&(e={});var n=r.d.extend(e,{method:"PATCH"});return this.fetch(t,n)},t.prototype.delete=function(t,e){void 0===e&&(e={});var n=r.d.extend(e,{method:"DELETE"});return this.fetch(t,n)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t,e){void 0===e&&(e={}),this._client=t,this._configuration=e}return t.prototype.fetch=function(t,e){return this._client.fetch(t,this._configuration,e)},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9);n.d(e,"graph",function(){return r.h}),n.d(e,"GraphRest",function(){return r.f}),n.d(e,"GraphBatch",function(){return r.a}),n.d(e,"GraphQueryable",function(){return r.b}),n.d(e,"GraphQueryableCollection",function(){return r.c}),n.d(e,"GraphQueryableInstance",function(){return r.d}),n.d(e,"GraphQueryableSearchableCollection",function(){return r.e}),n.d(e,"SPfxClient",function(){return r.g})},function(t,e,n){"use strict";var r=n(10);n.d(e,"h",function(){return r.b}),n.d(e,"f",function(){return r.a});var o=n(20);n.d(e,"a",function(){return o.a});var i=n(1);n.d(e,"b",function(){return i.a}),n.d(e,"c",function(){return i.b}),n.d(e,"d",function(){return i.c}),n.d(e,"e",function(){return i.d});var u=n(7);n.d(e,"g",function(){return u.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return u});var r=n(11),o=n(5),i=function(){function t(){}return Object.defineProperty(t.prototype,"v1",{get:function(){return new r.a("")},enumerable:!0,configurable:!0}),t.prototype.setup=function(t){Object(o.b)(t)},t}(),u=new i},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(0),o=n(1),i=n(13),u=function(t){function e(e,n){return void 0===n&&(n="v1.0"),t.call(this,e,n)||this}return r.b(e,t),Object.defineProperty(e.prototype,"groups",{get:function(){return new i.a(this)},enumerable:!0,configurable:!0}),e}(o.a)},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,o=n(0),i=n(1),u=n(14),s=n(2),c=n(15),a=n(16),f=n(18),l=n(19);!function(t){t[t.Office365=0]="Office365",t[t.Dynamic=1]="Dynamic",t[t.Security=2]="Security"}(r||(r={}));var p=function(t){function e(e,n){return void 0===n&&(n="groups"),t.call(this,e,n)||this}return o.b(e,t),e.prototype.getById=function(t){return new h(this,t)},e.prototype.add=function(t,e,n,o){var i=this;void 0===o&&(o={});var u=s.d.extend({displayName:t,mailEnabled:n===r.Office365,mailNickname:e,securityEnabled:n!==r.Office365},o);return n!==r.Security&&(u=s.d.extend(u,{groupTypes:[n===r.Office365?"Unified":"DynamicMembership"]})),this.postCore({body:JSON.stringify(u)}).then(function(t){return{data:t,group:i.getById(t.id)}})},e}(i.b),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.b(e,t),Object.defineProperty(e.prototype,"caldendar",{get:function(){return new c.a(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return new c.b(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owners",{get:function(){return new u.b(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plans",{get:function(){return new f.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"members",{get:function(){return new u.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conversations",{get:function(){return new a.a(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acceptedSenders",{get:function(){return new a.b(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejectedSenders",{get:function(){return new a.b(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"photo",{get:function(){return new l.a(this)},enumerable:!0,configurable:!0}),e.prototype.addFavorite=function(){return this.clone(e,"addFavorite").postCore()},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:t})})},e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},e.prototype.removeFavorite=function(){return this.clone(e,"removeFavorite").postCore()},e.prototype.resetUnseenCount=function(){return this.clone(e,"resetUnseenCount").postCore()},e.prototype.subscribeByMail=function(){return this.clone(e,"subscribeByMail").postCore()},e.prototype.unsubscribeByMail=function(){return this.clone(e,"unsubscribeByMail").postCore()},e.prototype.getCalendarView=function(t,n){var r=this.clone(e,"calendarView");return r.query.add("startDateTime",t.toISOString()),r.query.add("endDateTime",n.toISOString()),r.get()},e}(i.c)},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s});var r=n(0),o=n(1),i=function(t){function e(e,n){return void 0===n&&(n="members"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.add=function(t){return this.clone(e,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},e.prototype.getById=function(t){return new u(this,t)},e}(o.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(o.c),s=function(t){function e(e,n){return void 0===n&&(n="owners"),t.call(this,e,n)||this}return r.b(e,t),e}(i)},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return u});var r=n(0),o=n(1),i=(function(t){function e(e,n){return void 0===n&&(n="calendars"),t.call(this,e,n)||this}r.b(e,t)}(o.b),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),e}(o.c)),u=function(t){function e(e,n){return void 0===n&&(n="events"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getById=function(t){return new s(this,t)},e.prototype.add=function(t){var e=this;return this.postCore({body:JSON.stringify(t)}).then(function(t){return{data:t,event:e.getById(t.id)}})},e}(o.b),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(o.c)},function(t,e,n){"use strict";n.d(e,"a",function(){return u}),n.d(e,"b",function(){return p});var r=n(0),o=n(1),i=n(17),u=function(t){function e(e,n){return void 0===n&&(n="conversations"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},e.prototype.getById=function(t){return new a(this,t)},e}(o.b),s=function(t){function e(e,n){return void 0===n&&(n="threads"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getById=function(t){return new f(this,t)},e.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},e}(o.b),c=function(t){function e(e,n){return void 0===n&&(n="posts"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getById=function(t){return new l(this,t)},e.prototype.add=function(t){return this.postCore({body:JSON.stringify(t)})},e}(o.b),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"threads",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:JSON.stringify(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(o.c),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"posts",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:JSON.stringify({post:t})})},e.prototype.delete=function(){return this.deleteCore()},e}(o.c),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"attachments",{get:function(){return new i.a(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.forward=function(t){return this.clone(e,"forward").postCore({body:JSON.stringify(t)})},e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:JSON.stringify({post:t})})},e}(o.c),p=function(t){function e(e,n){return t.call(this,e,n)||this}return r.b(e,t),e.prototype.add=function(t){return this.clone(e,"$ref").postCore({body:JSON.stringify({"@odata.id":t})})},e.prototype.remove=function(t){var n=this.clone(e,"$ref");return n.query.add("$id",t),n.deleteCore()},e}(o.b)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),o=n(1),i=function(t){function e(e,n){return void 0===n&&(n="attachments"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getById=function(t){return new u(this,t)},e.prototype.addFile=function(t,e){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:e,name:t})})},e}(o.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(o.c)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),o=n(1),i=function(t){function e(e,n){return void 0===n&&(n="planner/plans"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getById=function(t){return new u(this,t)},e}(o.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(o.c)},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(0),o=n(1),i=n(4),u=function(t){function e(e,n){return void 0===n&&(n="photo"),t.call(this,e,n)||this}return r.b(e,t),e.prototype.getBlob=function(){return this.clone(e,"$value",!1).get(new i.a)},e.prototype.getBuffer=function(){return this.clone(e,"$value",!1).get(new i.b)},e.prototype.setContent=function(t){return this.clone(e,"$value",!1).patchCore({body:t})},e}(o.c)},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(0),o=n(4),i=n(3),u=n(2),s=n(5),c=n(6),a=function(t){function e(e){var n=t.call(this,e)||this;return n.name="GraphBatchParseException",i.a.log({data:{},level:3,message:"["+n.name+"]::"+n.message}),n}return r.b(e,t),e}(Error),f=function(t){function e(e){void 0===e&&(e="https://graph.microsoft.com/beta/$batch");var n=t.call(this)||this;return n.batchUrl=e,n}return r.b(e,t),e.prototype.executeImpl=function(){var t=this;i.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1);var e=new c.a,n={requests:this.formatRequests()},r={body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return i.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),e.fetch(this.batchUrl,r).then(function(t){return t.json()}).then(this._parseResponse).then(function(e){return i.a.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.responses.reduce(function(n,r,o){var s=t.requests[o];if(u.d.objectDefinedNotNull(s))return i.a.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+s.method+" "+s.url+".",0),n.then(function(t){return s.parser.parse(r).then(s.resolve).catch(s.reject)});if(e.nextLink)throw new a("Could not properly parse responses to match requests in batch.");return n},Promise.resolve())})},e.prototype.formatRequests=function(){return this.requests.map(function(t,e){var n={id:""+ ++e,method:t.method,url:t.url},r={};return void 0!==s.a.headers&&null!==s.a.headers&&(r=u.d.extend(r,s.a.headers)),void 0!==t.options&&(void 0!==t.options.headers&&null!==t.options.headers&&(r=u.d.extend(r,t.options.headers)),void 0!==t.options.body&&null!==t.options.body&&(n=u.d.extend(n,{body:t.options.body}))),n=u.d.extend(n,{headers:r})})},e.prototype._parseResponse=function(t){var e=this;return new Promise(function(n){for(var r=new Array(e.requests.length).fill(null),o=0;o<t.responses.length;++o){var i=t.responses[o],u=parseInt(i.id,10)-1;204===i.status?r[u]=new Response:r[u]=new Response(null,{headers:i.headers,status:i.status})}n({nextLink:t.nextLink,responses:r})})},r.a([Object(u.e)("Graph batching functionality is in beta.")],e.prototype,"executeImpl",null),e}(o.c)}])});
//# sourceMappingURL=graph.es5.umd.bundle.min.js.map