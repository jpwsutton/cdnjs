!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("@pnp/odata"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/odata","@pnp/logging"],t):t(e.pnp={},e.common,e.odata,e.logging)}(this,function(e,t,r,n){"use strict";function o(e){t.RuntimeConfig.extend(e)}function i(e){return new Promise(function(r){if(t.Util.isUrlAbsolute(e))return r(e);if(null!==p.baseUrl)return r(t.Util.combinePaths(p.baseUrl,e));if(void 0!==global._spPageContextInfo){if(global._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return r(t.Util.combinePaths(global._spPageContextInfo.webAbsoluteUrl,e));if(global._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return r(t.Util.combinePaths(global._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==global.location){var n=global.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=n.indexOf(o);if(i>0)return r(t.Util.combinePaths(n.substr(0,i),e))})}return r(e)})}function u(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}function a(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new g(e)}function s(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?t.Util.combinePaths(u(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(n.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",n.LogLevel.Warning),"")}var c=function(){function e(){}return e.prototype.fetch=function(e,t){return global.fetch(e,t)},e}(),p=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=t.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=t.RuntimeConfig.get("sp");return null!==e&&void 0!==e.baseUrl?e.baseUrl:null!==t.RuntimeConfig.spfxContext?t.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=t.RuntimeConfig.get("sp");return null!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new c}},enumerable:!0,configurable:!0}),e}()),l=function(){return function(){}}(),f=new t.Dictionary,d=function(){function e(e,t){void 0===t&&(t=f),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var n=this,o=this._digests.get(e);if(null!==o&&new Date<o.expiration)return Promise.resolve(o.value);var i=t.Util.combinePaths(e,"/_api/contextinfo"),u={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:t.Util.extend(u,p.headers,!0),method:"POST"}).then(function(e){return(new r.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(t){var r=new l;r.value=t.FormDigestValue;var o=t.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,n._digests.add(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),h=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=function(e){function t(t){var r=e.call(this,t)||this;return r.name="BatchParseException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+r.name+"]::"+r.message}),r}return h(t,e),t}(Error),g=function(e){function t(t,r){void 0===r&&(r="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var o=e.call(this,r)||this;return o.name="ODataIdException",n.Logger.log({data:t,level:n.LogLevel.Error,message:"["+o.name+"]::"+o.message}),o}return h(t,e),t}(Error),b=function(e){function t(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var r=e.call(this,t)||this;return r.name="MaxCommentLengthException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+r.name+"]::"+r.message}),r}return h(t,e),t}(Error),m=function(e){function t(t){void 0===t&&(t="This operation");var r=e.call(this,t+" is not supported as part of a batch.")||this;return r.name="NotSupportedInBatchException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+r.name+"]::"+r.message}),r}return h(t,e),t}(Error),v=function(e){function t(t){void 0===t&&(t="Unable to determine API url.");var r=e.call(this,t)||this;return r.name="APIUrlException",n.Logger.log({data:{},level:n.LogLevel.Error,message:"["+r.name+"]::"+r.message}),r}return h(t,e),t}(Error),P=function(){function e(){this._impl=p.fetchClientFactory(),this._digestCache=new d(this)}return e.prototype.fetch=function(e,r){var n=this;void 0===r&&(r={});var o=t.Util.extend(r,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if(t.mergeHeaders(i,p.headers),t.mergeHeaders(i,r.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),(o=t.Util.extend(o,{headers:i})).method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")&&!i.has("Authorization")){var u=e.indexOf("_api/");if(u<0)throw new v;var a=e.substr(0,u);return this._digestCache.getDigest(a).then(function(t){return i.append("X-RequestDigest",t),n.fetchRaw(e,o)})}return this.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,r){var n=this;void 0===r&&(r={});var o=new Headers;t.mergeHeaders(o,r.headers),r=t.Util.extend(r,{headers:o});var i=function(o){n._impl.fetch(e,r).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var r=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(t.Util.getCtxCallback(n,i,o),r)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(n,r)})},e.prototype.get=function(e,r){void 0===r&&(r={});var n=t.Util.extend(r,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,r){void 0===r&&(r={});var n=t.Util.extend(r,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,r){void 0===r&&(r={});var n=t.Util.extend(r,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,r){void 0===r&&(r={});var n=t.Util.extend(r,{method:"DELETE"});return this.fetch(e,n)},e}(),w=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),O=function(e){function o(r,n){var o=e.call(this)||this;if(o._options={},o._query=new t.Dictionary,"string"==typeof r){var i=r;if(t.Util.isUrlAbsolute(i)||i.lastIndexOf("/")<0)o._parentUrl=i,o._url=t.Util.combinePaths(i,n);else if(i.lastIndexOf("/")>i.lastIndexOf("(")){u=i.lastIndexOf("/");o._parentUrl=i.slice(0,u),n=t.Util.combinePaths(i.slice(u),n),o._url=t.Util.combinePaths(o._parentUrl,n)}else{var u=i.lastIndexOf("(");o._parentUrl=i.slice(0,u),o._url=t.Util.combinePaths(i,n)}}else{var a=r;o._parentUrl=a._url,o._options=a._options;var s=a._query.get("@target");null!==s&&o._query.add("@target",s),o._url=t.Util.combinePaths(o._parentUrl,n)}return o}return w(o,e),o.prototype.as=function(e){var r=new e(this._url,null);return t.Util.extend(r,this,!0)},o.prototype.toUrlAndQuery=function(){var e=new t.Dictionary,r=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,r,o){return n.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+r+" value: "+o,n.LogLevel.Verbose),e.add(r,"'"+o+"'"),r});return e.merge(this._query),e.count()>0&&(r+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),r},o.prototype.getParent=function(e,t,r,n){void 0===t&&(t=this.parentUrl);var o=new e(t,r);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==n&&(o=o.inBatch(n)),o},o.prototype.clone=function(e,t,r){void 0===r&&(r=!0);var n=new e(this,t),o=this.query.get("@target");return null!==o&&n.query.add("@target",o),r&&this.hasBatch&&(n=n.inBatch(this.batch)),n},o.prototype.toRequestContext=function(e,n,o,u){var a=this;void 0===n&&(n={}),void 0===u&&(u=r.PipelineMethods.default);var s=this.hasBatch?this.addBatchDependency():function(){};return i(this.toUrlAndQuery()).then(function(r){return t.mergeOptions(n,a._options),{batch:a.batch,batchDependency:s,cachingOptions:a._cachingOptions,clientFactory:function(){return new P},isBatched:a.hasBatch,isCached:a._useCaching,options:n,parser:o,pipeline:u,requestAbsoluteUrl:r,requestId:t.Util.getGUID(),verb:e}})},o}(r.ODataQueryable),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var r=this._query.getKeys(),n=[],o=t?" asc":" desc",i=0;i<r.length;i++)if("$orderby"===r[i]){n.push(this._query.get("$orderby"));break}return n.push(""+e+o),this._query.add("$orderby",n.join(",")),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t}(O),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(O),C=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),T=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,r){return void 0===t&&(t=""),void 0===r&&(r={}),new e(t,r)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=t.Util.extend(this._query,e),this},e}(),U=function(e){function r(t,r){return void 0===r&&(r="_api/search/postquery"),e.call(this,t,r)||this}return C(r,e),r.prototype.execute=function(e){var r,n=this;(r=e).SelectProperties&&(r.SelectProperties=this.fixupProp(e.SelectProperties)),r.RefinementFilters&&(r.RefinementFilters=this.fixupProp(e.RefinementFilters)),r.SortList&&(r.SortList=this.fixupProp(e.SortList)),r.HithighlightedProperties&&(r.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),r.ReorderingRules&&(r.ReorderingRules=this.fixupProp(e.ReorderingRules)),r.Properties&&(r.Properties=this.fixupProp(e.Properties));var o=JSON.stringify({request:t.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},r)});return this.postCore({body:o}).then(function(t){return new I(t,n.toUrl(),e)})},r.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},r}(S),I=function(){function e(e,t,r,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this._url=t,this._query=r,this._raw=n,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,r){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==r?r:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,o=t.Util.extend(this._query,{RowLimit:n,StartRow:n*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new U(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,r=0,n=e.results?e.results:e;r<n.length;r++){var o=n[r],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(e.SortDirection||(e.SortDirection={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(e.ReorderingRuleMatchType||(e.ReorderingRuleMatchType={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32TYpe=2]="Int32TYpe",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(e.QueryPropertyValueType||(e.QueryPropertyValueType={}));var x,L=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),j=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R=function(e){function t(t,r){return void 0===r&&(r="_api/search/suggest"),e.call(this,t,r)||this}return j(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new A(e)})},t.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},t}(S),A=function(){return function(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}}(),B=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),E=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r}return B(r,e),r.prototype.parse=function(r){var n=this;return e.prototype.parse.call(this,r).then(function(e){var r=new n.factory(s(e),null);return t.Util.extend(r,e)})},r}(r.ODataParserBase),D=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r}return B(r,e),r.prototype.parse=function(r){var n=this;return e.prototype.parse.call(this,r).then(function(e){return e.map(function(e){var r=new n.factory(s(e),null);return t.Util.extend(r,e)})})},r}(r.ODataParserBase),F=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),N=function(e){function t(t,r){return void 0===r&&(r="siteusers"),e.call(this,t,r)||this}return F(t,e),t.prototype.getByEmail=function(e){return new k(this,"getByEmail('"+e+"')")},t.prototype.getById=function(e){return new k(this,"getById("+e+")")},t.prototype.getByLoginName=function(e){var t=new k(this);return t.concat("(@v)"),t.query.add("@v","'"+encodeURIComponent(e)+"'"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var r=this.clone(t,"removeByLoginName(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.postCore()},t.prototype.add=function(e){var r=this;return this.clone(t,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return r.getByLoginName(e)})},t}(_),k=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return F(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new Q(this,"groups")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var r=this,n=t.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(S),M=function(e){function t(t,r){return void 0===r&&(r="currentuser"),e.call(this,t,r)||this}return F(t,e),t}(S),q=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(x||(x={}));var Q=function(e){function r(t,r){return void 0===r&&(r="sitegroups"),e.call(this,t,r)||this}return q(r,e),r.prototype.add=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:n}).then(function(e){return{data:e,group:r.getById(e.Id)}})},r.prototype.getByName=function(e){return new W(this,"getByName('"+e+"')")},r.prototype.getById=function(e){var t=new W(this);return t.concat("("+e+")"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById('"+e+"')").postCore()},r.prototype.removeByLoginName=function(e){return this.clone(r,"removeByLoginName('"+e+"')").postCore()},r}(_),W=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return q(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return new N(this,"users")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var n=this,o=t.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(o),headers:{"X-HTTP-Method":"MERGE"}}).then(function(t){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(r,n.parentUrl,"getByName('"+e.Title+"')")),{data:t,group:o}})},r}(S),H=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),V=function(e){function t(t,r){return void 0===r&&(r="roleassignments"),e.call(this,t,r)||this}return H(t,e),t.prototype.add=function(e,r){return this.clone(t,"addroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.remove=function(e,r){return this.clone(t,"removeroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.getById=function(e){var t=new G(this);return t.concat("("+e+")"),t},t}(_),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return H(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new Q(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(S),J=function(e){function r(t,r){return void 0===r&&(r="roledefinitions"),e.call(this,t,r)||this}return H(r,e),r.prototype.getById=function(e){return new X(this,"getById("+e+")")},r.prototype.getByName=function(e){return new X(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return new X(this,"getbytype("+e+")")},r.prototype.add=function(e,r,n,o){var i=this,u=JSON.stringify({BasePermissions:t.Util.extend({__metadata:{type:"SP.BasePermissions"}},o),Description:r,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:u}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},r}(_),X=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return H(r,e),r.prototype.update=function(e){var r=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=t.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(t){var n=r;return e.hasOwnProperty("Name")&&(n=r.getParent(J,r.parentUrl,"").getByName(e.Name)),{data:t,definition:n}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(S),K=function(e){function t(t,r){return void 0===r&&(r="roledefinitionbindings"),e.call(this,t,r)||this}return H(t,e),t}(_);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(e.ControlMode||(e.ControlMode={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(e.FieldTypes||(e.FieldTypes={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(e.DateTimeFieldFormatType||(e.DateTimeFieldFormatType={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(e.AddFieldOptions||(e.AddFieldOptions={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(e.CalendarType||(e.CalendarType={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(e.UrlFieldFormatType||(e.UrlFieldFormatType={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(e.PermissionKind||(e.PermissionKind={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(e.PrincipalType||(e.PrincipalType={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(e.PrincipalSource||(e.PrincipalSource={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(e.RoleType||(e.RoleType={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(e.PageType||(e.PageType={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(e.SharingLinkKind||(e.SharingLinkKind={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(e.SharingRole||(e.SharingRole={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(e.SharingOperationStatusCode||(e.SharingOperationStatusCode={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(e.SPSharedObjectType||(e.SPSharedObjectType={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(e.SharingDomainRestrictionMode||(e.SharingDomainRestrictionMode={}));var z=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return z(r,t),Object.defineProperty(r.prototype,"roleAssignments",{get:function(){return new V(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new S(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),r.prototype.getUserEffectivePermissions=function(e){var t=this.clone(O,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},r.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return lt.fromUrl(this.toUrl()).currentUser.select("LoginName").getAs().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},r.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(r,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},r.prototype.resetRoleInheritance=function(){return this.clone(r,"resetroleinheritance").postCore()},r.prototype.userHasPermissions=function(e,t){var r=this;return this.getUserEffectivePermissions(e).then(function(e){return r.hasPermissions(e,t)})},r.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(r){return t.hasPermissions(r,e)})},r.prototype.hasPermissions=function(t,r){if(!r)return!0;if(r===e.PermissionKind.FullMask)return 32767==(32767&t.High)&&65535===t.Low;var n=1;return(r-=1)>=0&&r<32?(n<<=r,0!=(t.Low&n)):r>=32&&r<64&&(n<<=r-32,0!=(t.High&n))},r}(S),Y=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return Y(n,r),n.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var r=null!==t?t.toISOString():null;return this.clone(n,"shareLink").postAsCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}})})},n.prototype.shareWith=function(r,o,i,u,a){var s=this;void 0===i&&(i=!1),void 0===u&&(u=!1),Array.isArray(r)||(r=[r]);var c=JSON.stringify(r.map(function(e){return{Key:e}})),p=o===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return lt.fromUrl(this.toUrl()).roleDefinitions.select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var r={includeAnonymousLinkInEmail:i,peoplePickerInput:c,propagateAcl:u,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==a&&(r=t.Util.extend(r,{emailBody:a.body,emailSubject:void 0!==a.subject?a.subject:"",sendEmail:!0})),s.clone(n,"shareObject").postAsCore({body:JSON.stringify(r)})})},n.prototype.shareObject=function(e,r){var n=this;return void 0===r&&(r=!1),r?this.sendShareObjectRequest(e):(e=t.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(r){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),roleValue:r,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=t.Util.extend(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),n.sendShareObjectRequest(o)}))},n.prototype.unshareObjectWeb=function(e){return this.clone(n,"unshareObject").postAsCore({body:JSON.stringify({url:e})})},n.prototype.checkPermissions=function(e){return this.clone(n,"checkPermissions").postAsCore({body:JSON.stringify({recipients:e})})},n.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(n,"getSharingInformation").postAsCore({body:JSON.stringify({request:e})})},n.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(n,"getObjectSharingSettings").postAsCore({body:JSON.stringify({useSimplifiedRoles:e})})},n.prototype.unshareObject=function(){return this.clone(n,"unshareObject").postAsCore()},n.prototype.deleteLinkByKind=function(e){return this.clone(n,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},n.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(n,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:t})})},n.prototype.getRoleValue=function(t,r){if(void 0===r||null===r){var n=t===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return lt.fromUrl(this.toUrl()).roleDefinitions.select("Id").top(1).filter("RoleTypeKind eq "+n).getAs().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(r){case e.RoleType.Contributor:return lt.fromUrl(this.toUrl()).associatedMemberGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});case e.RoleType.Reader:case e.RoleType.Guest:return lt.fromUrl(this.toUrl()).associatedVisitorGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},n.prototype.getShareObjectWeb=function(e){return Promise.resolve(lt.fromUrl(e,"/_api/SP.Web.ShareObject"))},n.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(t){return t.expand("UsersWithAccessRequests","GroupsSharedWith").as(n).postCore({body:JSON.stringify(e)})})},n}(O),ee=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return Y(n,r),n.prototype.shareWith=function(r,n,o){var i=this;void 0===n&&(n=e.SharingRole.View);var u=this.addBatchDependency();return lt.fromUrl(this.toUrl(),"/_api/web/url").get().then(function(e){return u(),i.shareObject(t.Util.combinePaths(e,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),r,n,o)})},n.prototype.shareObject=function(e,t,r,n,o,i,u,a){return void 0===i&&(i=!1),void 0===u&&(u=!1),void 0===a&&(a=!0),this.clone(Z,null).shareObject({emailData:n,group:o,includeAnonymousLinkInEmail:u,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:a})},n.prototype.shareObjectRaw=function(e){return this.clone(Z,null).shareObject(e,!0)},n.prototype.unshareObject=function(e){return this.clone(Z,null).unshareObjectWeb(e)},n}($),te=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Y(r,t),r.prototype.getShareLink=function(t,r){return void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===r&&(r=null),this.clone(Z,null).getShareLink(t,r)},r.prototype.shareWith=function(t,r,n,o){return void 0===r&&(r=e.SharingRole.View),void 0===n&&(n=!1),this.clone(Z,null).shareWith(t,r,n,!1,o)},r.prototype.checkSharingPermissions=function(e){return this.clone(Z,null).checkPermissions(e)},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(Z,null).getSharingInformation(e)},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(Z,null).getObjectSharingSettings(e)},r.prototype.unshare=function(){return this.clone(Z,null).unshareObject()},r.prototype.deleteSharingLinkByKind=function(e){return this.clone(Z,null).deleteLinkByKind(e)},r.prototype.unshareLink=function(e,t){return this.clone(Z,null).unshareLink(e,t)},r}($),re=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Y(r,t),r.prototype.getShareLink=function(t,r){void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===r&&(r=null);var n=this.addBatchDependency();return this.getShareable().then(function(e){return n(),e.getShareLink(t,r)})},r.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.checkPermissions(e)})},r.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getSharingInformation(e)})},r.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getObjectSharingSettings(e)})},r.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},r.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.deleteLinkByKind(e)})},r.prototype.unshareLink=function(e,t){var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.unshareLink(e,t)})},r.prototype.getShareable=function(){var e=this;return this.clone(ne,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var r=new Z(s(t));return e.hasBatch&&(r=r.inBatch(e.batch)),r})},r}(S),ne=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Y(r,t),r.prototype.shareWith=function(t,r,n,o){void 0===r&&(r=e.SharingRole.View),void 0===n&&(n=!1);var i=this.addBatchDependency();return this.getShareable().then(function(e){return i(),e.shareWith(t,r,n,!1,o)})},r}(re),oe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Y(r,t),r.prototype.shareWith=function(t,r,n,o,i){void 0===r&&(r=e.SharingRole.View),void 0===n&&(n=!1),void 0===o&&(o=!1);var u=this.addBatchDependency();return this.getShareable().then(function(e){return u(),e.shareWith(t,r,n,o,i)})},r}(re),ie=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new ae(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},t}(O),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),t.prototype.getById=function(e){return new se(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new se(this,"getByControlId('"+e+"')")},t}(_),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,r){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+r+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(S),ce=function(e){function t(t,r){return void 0===r&&(r="webpart"),e.call(this,t,r)||this}return ie(t,e),t}(S),pe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),le=function(e){function r(t,r){return void 0===r&&(r="contenttypes"),e.call(this,t,r)||this}return pe(r,e),r.prototype.getById=function(e){var t=new fe(this);return t.concat("('"+e+"')"),t},r.prototype.addAvailableContentType=function(e){var t=this,n=JSON.stringify({contentTypeId:e});return this.clone(r,"addAvailableContentType").postAsCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},r.prototype.add=function(e,r,n,o,i){var u=this;void 0===n&&(n=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var a=JSON.stringify(t.Util.extend({Description:n,Group:o,Id:{StringValue:e},Name:r,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:a}).then(function(e){return{contentType:u.getById(e.id),data:e}})},r}(_),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new de(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new _(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new _(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(S),de=function(e){function t(t,r){return void 0===r&&(r="fieldlinks"),e.call(this,t,r)||this}return pe(t,e),t.prototype.getById=function(e){var t=new he(this);return t.concat("(guid'"+e+"')"),t},t}(_),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t}(S),ye=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ge=function(e){function t(t,r){return void 0===r&&(r="AttachmentFiles"),e.call(this,t,r)||this}return ye(t,e),t.prototype.getByName=function(e){var t=new be(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return this.clone(t,"add(FileName='"+e+"')",!1).postCore({body:r}).then(function(t){return{data:t,file:n.getByName(e)}})},t.prototype.addMultiple=function(e){var r=this;return e.reduce(function(e,n){return e.then(function(){return r.clone(t,"add(FileName='"+n.name+"')",!1).postCore({body:n.content})})},Promise.resolve())},t}(_),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ye(t,e),t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new r.TextFileParser)},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new r.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new r.BufferFileParser)},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new r.JSONFileParser)},t.prototype.setContent=function(e){var r=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(r)})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(S),me=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ve=function(e){function r(t,r){return void 0===r&&(r="views"),e.call(this,t,r)||this}return me(r,e),r.prototype.getById=function(e){var t=new Pe(this);return t.concat("('"+e+"')"),t},r.prototype.getByTitle=function(e){return new Pe(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,n,o){var i=this;void 0===n&&(n=!1),void 0===o&&(o={});var u=JSON.stringify(t.Util.extend({PersonalView:n,Title:e,__metadata:{type:"SP.View"}},o));return this.clone(r,null).postAsCore({body:u}).then(function(e){return{data:e,view:i.getById(e.Id)}})},r}(_),Pe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return me(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return new we(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.renderAsHtml=function(){return this.clone(O,"renderashtml").get()},r}(S),we=function(e){function t(t,r){return void 0===r&&(r="viewfields"),e.call(this,t,r)||this}return me(t,e),t.prototype.getSchemaXml=function(){return this.clone(O,"schemaxml").get()},t.prototype.add=function(e){return this.clone(t,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,r){return this.clone(t,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:r})})},t.prototype.removeAll=function(){return this.clone(t,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(t,"removeviewfield('"+e+"')").postCore()},t}(_),Oe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_e=function(r){function n(e,t){return void 0===t&&(t="fields"),r.call(this,e,t)||this}return Oe(n,r),n.prototype.getByTitle=function(e){return new Se(this,"getByTitle('"+e+"')")},n.prototype.getByInternalNameOrTitle=function(e){return new Se(this,"getByInternalNameOrTitle('"+e+"')")},n.prototype.getById=function(e){var t=new Se(this);return t.concat("('"+e+"')"),t},n.prototype.createFieldAsXml=function(e){var r,o=this;r="string"==typeof e?{SchemaXml:e}:e;var i=JSON.stringify({parameters:t.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},r)});return this.clone(n,"createfieldasxml").postAsCore({body:i}).then(function(e){return{data:e,field:o.getById(e.Id)}})},n.prototype.add=function(e,r,o){var i=this;void 0===o&&(o={});var u=JSON.stringify(t.Util.extend({Title:e,__metadata:{type:r}},o));return this.clone(n,null).postAsCore({body:u}).then(function(e){return{data:e,field:i.getById(e.Id)}})},n.prototype.addText=function(e,r,n){void 0===r&&(r=255);var o={FieldTypeKind:2,MaxLength:r};return this.add(e,"SP.FieldText",t.Util.extend(o,n))},n.prototype.addCalculated=function(r,n,o,i,u){void 0===i&&(i=e.FieldTypes.Text);var a={DateFormat:o,FieldTypeKind:17,Formula:n,OutputType:i};return this.add(r,"SP.FieldCalculated",t.Util.extend(a,u))},n.prototype.addDateTime=function(r,n,o,i,u){void 0===n&&(n=e.DateTimeFieldFormatType.DateOnly),void 0===o&&(o=e.CalendarType.Gregorian),void 0===i&&(i=0);var a={DateTimeCalendarType:o,DisplayFormat:n,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(r,"SP.FieldDateTime",t.Util.extend(a,u))},n.prototype.addNumber=function(e,r,n,o){var i={FieldTypeKind:9};return void 0!==r&&(i=t.Util.extend({MinimumValue:r},i)),void 0!==n&&(i=t.Util.extend({MaximumValue:n},i)),this.add(e,"SP.FieldNumber",t.Util.extend(i,o))},n.prototype.addCurrency=function(e,r,n,o,i){void 0===o&&(o=1033);var u={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==r&&(u=t.Util.extend({MinimumValue:r},u)),void 0!==n&&(u=t.Util.extend({MaximumValue:n},u)),this.add(e,"SP.FieldCurrency",t.Util.extend(u,i))},n.prototype.addMultilineText=function(e,r,n,o,i,u,a){void 0===r&&(r=6),void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===u&&(u=!0);var s={AllowHyperlink:u,AppendOnly:i,FieldTypeKind:3,NumberOfLines:r,RestrictedMode:o,RichText:n};return this.add(e,"SP.FieldMultiLineText",t.Util.extend(s,a))},n.prototype.addUrl=function(r,n,o){void 0===n&&(n=e.UrlFieldFormatType.Hyperlink);var i={DisplayFormat:n,FieldTypeKind:11};return this.add(r,"SP.FieldUrl",t.Util.extend(i,o))},n}(_),Se=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Oe(r,e),r.prototype.update=function(e,r){var n=this;void 0===r&&(r="SP.Field");var o=JSON.stringify(t.Util.extend({__metadata:{type:r}},e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.setShowInDisplayForm=function(e){return this.clone(r,"setshowindisplayform("+e+")").postCore()},r.prototype.setShowInEditForm=function(e){return this.clone(r,"setshowineditform("+e+")").postCore()},r.prototype.setShowInNewForm=function(e){return this.clone(r,"setshowinnewform("+e+")").postCore()},r}(S),Ce=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Te=function(e){function t(t,r){return void 0===r&&(r="forms"),e.call(this,t,r)||this}return Ce(t,e),t.prototype.getById=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},t}(_),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t}(S),Ie=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xe=function(e){function t(t,r){return void 0===r&&(r="subscriptions"),e.call(this,t,r)||this}return Ie(t,e),t.prototype.getById=function(e){var t=new Le(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var n=this,o=JSON.stringify({clientState:r||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:n.getById(e.id)}})},t}(_),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ie(t,e),t.prototype.update=function(e){var t=this,r=JSON.stringify({expirationDateTime:e});return this.patchCore({body:r,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(S),je=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Re=function(e){function r(t,r){return void 0===r&&(r="usercustomactions"),e.call(this,t,r)||this}return je(r,e),r.prototype.getById=function(e){var t=new Ae(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n}).then(function(e){return{action:r.getById(e.Id),data:e}})},r.prototype.clear=function(){return this.clone(r,"clear").postCore()},r}(_),Ae=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return je(r,e),r.prototype.update=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:r,data:e}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(S),Be=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ee=function(e){function r(t,r){return void 0===r&&(r="lists"),e.call(this,t,r)||this}return Be(r,e),r.prototype.getByTitle=function(e){return new De(this,"getByTitle('"+e+"')")},r.prototype.getById=function(e){var t=new De(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,r,n,o,i){var u=this;void 0===r&&(r=""),void 0===n&&(n=100),void 0===o&&(o=!1),void 0===i&&(i={});var a=t.Util.extend({AllowContentTypes:o,BaseTemplate:n,ContentTypesEnabled:o,Description:r,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:u.getByTitle(a.Title)}})},r.prototype.ensure=function(e,r,n,o,i){var u=this;if(void 0===r&&(r=""),void 0===n&&(n=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw new m("The ensure list method");return new Promise(function(a,s){var c=t.Util.extend(i,{Title:e,Description:r,ContentTypesEnabled:o},!0),p=u.getByTitle(c.Title);p.get().then(function(e){p.update(c).then(function(e){a({created:!1,data:e,list:u.getByTitle(c.Title)})}).catch(function(e){return s(e)})}).catch(function(t){u.add(e,r,n,o,c).then(function(e){a({created:!0,data:e.data,list:u.getByTitle(c.Title)})}).catch(function(e){return s(e)})})})},r.prototype.ensureSiteAssetsLibrary=function(){return this.clone(r,"ensuresiteassetslibrary").postCore().then(function(e){return new De(a(e))})},r.prototype.ensureSitePagesLibrary=function(){return this.clone(r,"ensuresitepageslibrary").postCore().then(function(e){return new De(a(e))})},r}(_),De=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Be(r,e),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return new Ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"views",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"forms",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"defaultView",{get:function(){return new S(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new O(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return new _(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return new O(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return new O(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscriptions",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new ze(this,"rootFolder")},enumerable:!0,configurable:!0}),r.prototype.getView=function(e){return new Pe(this,"getView('"+e+"')")},r.prototype.update=function(e,n){var o=this;void 0===n&&(n="*");var i=JSON.stringify(t.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}}).then(function(t){var n=o;return e.hasOwnProperty("Title")&&(n=o.getParent(r,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:t,list:n}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getChanges=function(e){return this.clone(r,"getchanges").postCore({body:JSON.stringify({query:t.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},r.prototype.getItemsByCAMLQuery=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=this.clone(r,"getitems");return i.expand.apply(i,n).postCore({body:JSON.stringify({query:t.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},r.prototype.getListItemChangesSinceToken=function(e){return this.clone(r,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:t.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},r.prototype.renderListData=function(e){var t=this.clone(r,"renderlistdata(@viewXml)");return t.query.add("@viewXml","'"+e+"'"),t.postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("RenderListData")?e.RenderListData:e})},r.prototype.renderListFormData=function(e,t,n){return this.clone(r,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("ListData")?e.ListData:e})},r.prototype.reserveListItemId=function(){return this.clone(r,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(r,null,!1).select("ListItemEntityTypeFullName").getAs().then(function(e){return e.ListItemEntityTypeFullName})},r}($),Fe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ne=function(e){function r(t,r){return void 0===r&&(r="items"),e.call(this,t,r)||this}return Fe(r,e),r.prototype.getById=function(e){var t=new ke(this);return t.concat("("+e+")"),t},r.prototype.skip=function(e){return this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},r.prototype.getPaged=function(){return this.getAs(new qe)},r.prototype.add=function(e,n){var o=this;void 0===e&&(e={}),void 0===n&&(n=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(n).then(function(n){var u=JSON.stringify(t.Util.extend({__metadata:{type:n}},e)),a=o.clone(r,null).postAsCore({body:u}).then(function(e){return{data:e,item:o.getById(e.Id)}});return i(),a})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(De).getListItemEntityTypeFullName()},r}(_),ke=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Fe(r,e),Object.defineProperty(r.prototype,"attachmentFiles",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentType",{get:function(){return new fe(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new O(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return new O(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return new S(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return new S(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return new S(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folder",{get:function(){return new ze(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"file",{get:function(){return new Ve(this,"file")},enumerable:!0,configurable:!0}),r.prototype.update=function(e,r){var n=this;return void 0===r&&(r="*"),new Promise(function(o,i){var u=n.addBatchDependency();n.getParent(S,n.parentUrl.substr(0,n.parentUrl.lastIndexOf("/"))).select("ListItemEntityTypeFullName").getAs().then(function(i){var a=JSON.stringify(t.Util.extend({__metadata:{type:i.ListItemEntityTypeFullName}},e));return u(),n.postCore({body:a,headers:{"IF-Match":r,"X-HTTP-Method":"MERGE"}},new Qe).then(function(e){o({data:e,item:n})})}).catch(function(e){return i(e)})})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(r,"getWOPIFrameUrl(@action)");return t._query.add("@action",e),t.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},r.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(r,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:t})})},r}(te),Me=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Ne(this.nextUrl,null).getPaged():new Promise(function(e){return e(null)})},e}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&e.json().then(function(e){var n=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];r(new Me(n,t.parseODataJSON(e)))})})},t}(r.ODataParserBase),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&r({"odata.etag":e.headers.get("etag")})})},t}(r.ODataParserBase),We=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),He=function(e){function t(t,r){return void 0===r&&(r="files"),e.call(this,t,r)||this}return We(t,e),t.prototype.getByName=function(e){var t=new Ve(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r,n){var o=this;return void 0===n&&(n=!0),new t(this,"add(overwrite="+n+",url='"+e+"')").postCore({body:r}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,r,n,o,i){var u=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(t,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return u.getByName(e)}).then(function(e){return e.setContentChunked(r,n,i)}).then(function(t){return{data:t,file:u.getByName(e)}})},t.prototype.addTemplateFile=function(e,r){var n=this;return this.clone(t,"addTemplateFile(urloffile='"+e+"',templatefiletype="+r+")",!1).postCore().then(function(t){return{data:t,file:n.getByName(e)}})},t}(_),Ve=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return We(o,n),Object.defineProperty(o.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"versions",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),o.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(o,"approve(comment='"+e+"')").postCore()},o.prototype.cancelUpload=function(e){return this.clone(o,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},o.prototype.checkin=function(t,r){if(void 0===t&&(t=""),void 0===r&&(r=e.CheckinType.Major),t.length>1023)throw new b;return this.clone(o,"checkin(comment='"+t+"',checkintype="+r+")").postCore()},o.prototype.checkout=function(){return this.clone(o,"checkout").postCore()},o.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(o,"copyTo(strnewurl='"+e+"',boverwrite="+t+")").postCore()},o.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(o,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},o.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new b;return this.clone(o,"deny(comment='"+e+"')").postCore()},o.prototype.getLimitedWebPartManager=function(t){return void 0===t&&(t=e.WebPartsPersonalizationScope.Shared),new ue(this,"getLimitedWebPartManager(scope="+t+")")},o.prototype.moveTo=function(t,r){return void 0===r&&(r=e.MoveOperations.Overwrite),this.clone(o,"moveTo(newurl='"+t+"',flags="+r+")").postCore()},o.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new b;return this.clone(o,"publish(comment='"+e+"')").postCore()},o.prototype.recycle=function(){return this.clone(o,"recycle").postCore()},o.prototype.undoCheckout=function(){return this.clone(o,"undoCheckout").postCore()},o.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new b;return this.clone(o,"unpublish(comment='"+e+"')").postCore()},o.prototype.getText=function(){return this.clone(o,"$value",!1).get(new r.TextFileParser,{headers:{binaryStringResponseBody:"true"}})},o.prototype.getBlob=function(){return this.clone(o,"$value",!1).get(new r.BlobFileParser,{headers:{binaryStringResponseBody:"true"}})},o.prototype.getBuffer=function(){return this.clone(o,"$value",!1).get(new r.BufferFileParser,{headers:{binaryStringResponseBody:"true"}})},o.prototype.getJSON=function(){return this.clone(o,"$value",!1).get(new r.JSONFileParser,{headers:{binaryStringResponseBody:"true"}})},o.prototype.setContent=function(e){var t=this;return this.clone(o,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new o(t)})},o.prototype.getItem=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return t.Util.extend(new ke(s(e)),e)})},o.prototype.setContentChunked=function(e,r,n){void 0===n&&(n=10485760),void 0===r&&(r=function(){return null});var o=this,i=e.size,u=parseInt((e.size/n).toString(),10)+(e.size%n==0?1:0),a=t.Util.getGUID();r({blockNumber:1,chunkSize:n,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:u});for(var s=o.startUpload(a,e.slice(0,n)),c=2;c<u;c++)!function(t){s=s.then(function(s){return r({blockNumber:t,chunkSize:n,currentPointer:s,fileSize:i,stage:"continue",totalBlocks:u}),o.continueUpload(a,s,e.slice(s,s+n))})}(c);return s.then(function(t){return r({blockNumber:u,chunkSize:n,currentPointer:t,fileSize:i,stage:"finishing",totalBlocks:u}),o.finishUpload(a,t,e.slice(t))}).then(function(e){return o})},o.prototype.startUpload=function(e,t){return this.clone(o,"startUpload(uploadId=guid'"+e+"')",!1).postAsCore({body:t}).then(function(e){return parseFloat(e)})},o.prototype.continueUpload=function(e,t,r){return this.clone(o,"continueUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postAsCore({body:r}).then(function(e){return parseFloat(e)})},o.prototype.finishUpload=function(e,t,r){return this.clone(o,"finishUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postAsCore({body:r}).then(function(e){return{data:e,file:new o(e.ServerRelativeUrl)}})},o}(ne),Ge=function(e){function t(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return We(t,e),t.prototype.getById=function(e){var t=new Je(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new t(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(t,"deleteById(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(t,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(t,"restoreByLabel(versionlabel='"+e+"')").postCore()},t}(_),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return We(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(S);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(e.CheckinType||(e.CheckinType={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(e.WebPartsPersonalizationScope||(e.WebPartsPersonalizationScope={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(e.MoveOperations||(e.MoveOperations={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage"}(e.TemplateFileType||(e.TemplateFileType={}));var Xe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ke=function(e){function t(t,r){return void 0===r&&(r="folders"),e.call(this,t,r)||this}return Xe(t,e),t.prototype.getByName=function(e){var t=new ze(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var r=this;return this.clone(t,"add('"+e+"')").postCore().then(function(t){return{data:t,folder:r.getByName(e)}})},t}(_),ze=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Xe(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return new _(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"files",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new Ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return new r(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return new S(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return new O(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return new _(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:r}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getItem=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return t.Util.extend(new ke(s(e)),e)})},r}(oe),$e=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),t.prototype.getById=function(e){var t=new Ze(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,r,n){var o=this;void 0===n&&(n=!0);var i=JSON.stringify({IsVisible:n,Title:e,Url:r,__metadata:{type:"SP.NavigationNode"}});return this.clone(t,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},t.prototype.moveAfter=function(e,r){var n=JSON.stringify({nodeId:e,previousNodeId:r});return this.clone(t,"MoveAfter").postCore({body:n})},t}(_),Ze=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return $e(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return new Ye(this,"Children")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:r}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(S),et=function(e){function t(t,r){return void 0===r&&(r="navigation"),e.call(this,t,r)||this}return $e(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new Ye(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new Ye(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t}(O),tt=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rt=function(e){function r(t){var r=e.call(this)||this;return r.baseUrl=t,r}return tt(r,e),r.prototype.executeImpl=function(){var e=this;if(n.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",n.LogLevel.Info),this.requests.length<1)return n.Logger.write("Resolving empty batch.",n.LogLevel.Info),Promise.resolve();var r=new P;return i(this.baseUrl).then(function(o){for(var i=[],u="",a=0;a<e.requests.length;a++){var s=e.requests[a];"GET"===s.method?(u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=t.Util.getGUID(),i.push("--batch_"+e.batchId+"\n"),i.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),i.push("--changeset_"+u+"\n")),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n");var c=new Headers,l=t.Util.isUrlAbsolute(s.url)?s.url:t.Util.combinePaths(o,s.url);if(n.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+s.method+" "+l+" to batch.",n.LogLevel.Verbose),"GET"!==s.method){var f=s.method,d=s.options.headers;s.hasOwnProperty("options")&&s.options.hasOwnProperty("headers")&&void 0!==d["X-HTTP-Method"]&&(f=d["X-HTTP-Method"],delete d["X-HTTP-Method"]),i.push(f+" "+l+" HTTP/1.1\n"),c.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else i.push(s.method+" "+l+" HTTP/1.1\n");t.mergeHeaders(c,p.headers),s.options&&t.mergeHeaders(c,s.options.headers),c.has("Accept")||c.append("Accept","application/json"),c.has("Content-Type")||c.append("Content-Type","application/json;odata=verbose;charset=utf-8"),c.has("X-ClientService-ClientTag")||c.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),c.forEach(function(e,t){i.push(t+": "+e+"\n")}),i.push("\n"),s.options.body&&i.push(s.options.body+"\n\n")}u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"--\n");var h={body:i.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return n.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",n.LogLevel.Info),r.fetch(t.Util.combinePaths(o,"/_api/$batch"),h).then(function(e){return e.text()}).then(e._parseResponse).then(function(t){if(t.length!==e.requests.length)throw new y("Could not properly parse responses to match requests in batch.");return n.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",n.LogLevel.Info),t.reduce(function(t,r,o){var i=e.requests[o];return n.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",n.LogLevel.Verbose),t.then(function(e){return i.parser.parse(r).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},r.prototype._parseResponse=function(e){return new Promise(function(t,r){for(var n,o,i=[],u=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),a=e.split("\n"),s="batch",c=0;c<a.length;++c){var p=a[c];switch(s){case"batch":if("--batchresponse_"===p.substr(0,"--batchresponse_".length))s="batchHeaders";else if(""!==p.trim())throw new y("Invalid response, line "+c);break;case"batchHeaders":""===p.trim()&&(s="status");break;case"status":var l=u.exec(p);if(3!==l.length)throw new y("Invalid status, line "+c);n=parseInt(l[1],10),o=l[2],s="statusHeaders";break;case"statusHeaders":""===p.trim()&&(s="body");break;case"body":i.push(204===n?new Response:new Response(p,{status:n,statusText:o})),s="batch"}}"status"!==s&&r(new y("Unexpected end of input")),t(i)})},r}(r.ODataBatch),nt=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ot=function(e){function t(t,r){return void 0===r&&(r="features"),e.call(this,t,r)||this}return nt(t,e),t.prototype.getById=function(e){var t=new it(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return void 0===r&&(r=!1),this.clone(t,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:r})}).then(function(t){return{data:t,feature:n.getById(e)}})},t.prototype.remove=function(e,r){return void 0===r&&(r=!1),this.clone(t,"remove").postCore({body:JSON.stringify({featureId:e,force:r})})},t}(_),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nt(t,e),t.prototype.deactivate=function(e){var r=this;void 0===e&&(e=!1);var n=this.addBatchDependency();return new t(this).select("DefinitionId").getAs().then(function(t){var o=r.getParent(ot,r.parentUrl,"",r.batch).remove(t.DefinitionId,e);return n(),o})},t}(S),ut=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),at=function(e){function t(t,r){return void 0===r&&(r="_api/SP.RelatedItemManager"),e.call(this,t,r)||this}return ut(t,e),t.FromUrl=function(e){if(null===e)return new t("");var r=e.indexOf("_api/");return new t(r>-1?e.substr(0,r):e)},t.prototype.getRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetPageOneRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.addSingleLink=function(e,r,n,o,i,u,a){void 0===a&&(a=!1);var s=this.clone(t,null);return s.concat(".AddSingleLink"),s.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryAddReverseLink:a})})},t.prototype.addSingleLinkToUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:n,TargetListName:r,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,r,n,o,i,u,a){void 0===a&&(a=!1);var s=this.clone(t,null);return s.concat(".DeleteSingleLink"),s.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryDeleteReverseLink:a})})},t}(O),st=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ct=function(e){function r(t,r){return void 0===r&&(r="webs"),e.call(this,t,r)||this}return st(r,e),r.prototype.add=function(e,n,o,i,u,s){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===u&&(u=1033),void 0===s&&(s=!0);var c={Description:o,Language:u,Title:e,Url:n,UseSamePermissionsAsParentSite:s,WebTemplate:i},p=JSON.stringify({parameters:t.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},c)});return this.clone(r,"add").postCore({body:p}).then(function(e){return{data:e,web:new lt(a(e).replace(/_api\/web\/?/i,""))}})},r}(_),pt=function(e){function t(t,r){return void 0===r&&(r="webinfos"),e.call(this,t,r)||this}return st(t,e),t}(_),lt=function(e){function r(t,r){return void 0===r&&(r="_api/web"),e.call(this,t,r)||this}return st(r,e),r.fromUrl=function(e,t){return new r(u(e),t)},Object.defineProperty(r.prototype,"webs",{get:function(){return new ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return new pt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lists",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new ot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availablefields",{get:function(){return new _e(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"navigation",{get:function(){return new et(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUsers",{get:function(){return new N(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteGroups",{get:function(){return new Q(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentUser",{get:function(){return new M(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new Ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"roleDefinitions",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedItems",{get:function(){return at.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new rt(this.parentUrl)},Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new ze(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedOwnerGroup",{get:function(){return new W(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedMemberGroup",{get:function(){return new W(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedVisitorGroup",{get:function(){return new W(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),r.prototype.getFolderByServerRelativeUrl=function(e){return new ze(this,"getFolderByServerRelativeUrl('"+e+"')")},r.prototype.getFileByServerRelativeUrl=function(e){return new Ve(this,"getFileByServerRelativeUrl('"+e+"')")},r.prototype.getList=function(e){return new De(this,"getList('"+e+"')")},r.prototype.update=function(e){var r=this,n=JSON.stringify(t.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:r}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r.prototype.applyTheme=function(e,t,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(r,"applytheme").postCore({body:i})},r.prototype.applyWebTemplate=function(e){var t=this.clone(r,"applywebtemplate");return t.concat("(@t)"),t.query.add("@t",e),t.postCore()},r.prototype.ensureUser=function(e){var t=JSON.stringify({logonName:e});return this.clone(r,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new k(a(e))}})},r.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new _(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},r.prototype.getCatalog=function(e){return this.clone(r,"getcatalog("+e+")").select("Id").get().then(function(e){return new De(a(e))})},r.prototype.getChanges=function(e){var n=JSON.stringify({query:t.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(r,"getchanges").postCore({body:n})},Object.defineProperty(r.prototype,"customListTemplate",{get:function(){return new _(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),r.prototype.getUserById=function(e){return new k(this,"getUserById("+e+")")},r.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(r,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},r}(ee),ft=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dt=function(e){function t(t,r){return void 0===r&&(r="_api/site"),e.call(this,t,r)||this}return ft(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new lt(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new ot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),t.prototype.getContextInfo=function(){return new t(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new O("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new O("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new rt(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(t,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:lt.fromUrl(a(e))}})},t}(S),ht=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yt=function(e){function n(t,r){void 0===r&&(r="_api/sp.userprofiles.peoplemanager");var n=e.call(this,t,r)||this;return n.profileLoader=new gt(t),n}return ht(n,e),Object.defineProperty(n.prototype,"editProfileLink",{get:function(){return this.clone(n,"EditProfileLink").getAs(r.ODataValue())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(n,"IsMyPeopleListPublic").getAs(r.ODataValue())},enumerable:!0,configurable:!0}),n.prototype.amIFollowedBy=function(e){var t=this.clone(n,"amifollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},n.prototype.amIFollowing=function(e){var t=this.clone(n,"amifollowing(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},n.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(n,"getfollowedtags("+e+")").get()},n.prototype.getFollowersFor=function(e){var t=this.clone(n,"getfollowersfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(n.prototype,"myFollowers",{get:function(){return new _(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"myProperties",{get:function(){return new n(this,"getmyproperties")},enumerable:!0,configurable:!0}),n.prototype.getPeopleFollowedBy=function(e){var t=this.clone(n,"getpeoplefollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},n.prototype.getPropertiesFor=function(e){var t=this.clone(n,"getpropertiesfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(n.prototype,"trendingTags",{get:function(){var e=this.clone(n,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),n.prototype.getUserProfilePropertyFor=function(e,t){var r=this.clone(n,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},n.prototype.hideSuggestion=function(e){var t=this.clone(n,"hidesuggestion(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},n.prototype.isFollowing=function(e,t){var r=this.clone(n,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.query.add("@y","'"+encodeURIComponent(t)+"'"),r.get()},n.prototype.setMyProfilePic=function(e){var r=this;return new Promise(function(o,i){t.readBlobAsArrayBuffer(e).then(function(e){new n(r,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return o()})}).catch(function(e){return i(e)})})},n.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(n.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),n.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},n.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},n}(S),gt=function(e){function t(t,r){return void 0===r&&(r="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,r)||this}return ht(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(t,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postAsCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(t,"getuserprofile").postAsCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(t,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(t,"getuserprofile/shareallsocialdata("+e+")").postCore()},t}(O),bt=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mt=function(e){function r(t,n){return e.call(this,r.getBaseUrl(t),"_api/SP.Utilities.Utility."+n)||this}return bt(r,e),r.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),r=t.indexOf("_api/");return r<0?t:t.substr(0,r)},r.prototype.excute=function(e){return this.postAsCore({body:JSON.stringify(e)})},r.prototype.sendEmail=function(e){var r={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(r.properties=t.Util.extend(r.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(r.properties=t.Util.extend(r.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(r.properties=t.Util.extend(r.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(r.properties=t.Util.extend(r.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.create("SendEmail",!0).excute(r)},r.prototype.getCurrentUserEmailAddresses=function(){return this.create("GetCurrentUserEmailAddresses",!0).excute({})},r.prototype.resolvePrincipal=function(e,t,r,n,o,i){void 0===i&&(i=!1);var u={addToUserInfoList:o,input:e,inputIsEmailOnly:n,matchUserInfoList:i,scopes:t,sources:r};return this.create("ResolvePrincipalInCurrentContext",!0).excute(u)},r.prototype.searchPrincipals=function(e,t,r,n,o){var i={groupName:n,input:e,maxCount:o,scopes:t,sources:r};return this.create("SearchPrincipalsUsingContextWeb",!0).excute(i)},r.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.create("CreateEmailBodyForInvitation",!0).excute(t)},r.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var r={inputs:e,maxCount:t};return this.create("ExpandGroupsToPrincipals",!0).excute(r)},r.prototype.createWikiPage=function(e){return this.create("CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new Ve(a(e))}})},r.prototype.create=function(e,t){var n=new r(this.parentUrl,e),o=this.query.get("@target");return null!==o&&n.query.add("@target",o),t&&this.hasBatch&&(n=n.inBatch(this.batch)),n},r}(O),vt=new(function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,r){return void 0===r&&(r=""),new e(t,r)},e.prototype.setup=function(e){o(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new R(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof T?e.toSearchQuery():e,new U(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new dt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new lt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new yt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new mt(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e.prototype.crossDomainSite=function(e,t){return this._cdImpl(dt,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(lt,e,t,"web")},e.prototype._cdImpl=function(e,r,n,o){if(!t.Util.isUrlAbsolute(r))throw new t.UrlException("The addInWebUrl parameter must be an absolute url.");if(!t.Util.isUrlAbsolute(n))throw new t.UrlException("The hostWebUrl parameter must be an absolute url.");var i=new e(t.Util.combinePaths(r,"_api/SP.AppContextSite(@target)"),o);return i.query.add("@target","'"+encodeURIComponent(n)+"'"),i.configure(this._options)},e}());e.sp=vt,e.File=Ve,e.Files=He,e.Folder=ze,e.Folders=Ke,e.HttpClient=P,e.Item=ke,e.Items=Ne,e.PagedItemCollection=Me,e.NavigationNodes=Ye,e.NavigationNode=Ze,e.List=De,e.Lists=Ee,e.spExtractODataId=a,e.spODataEntity=function(e){return new E(e)},e.spODataEntityArray=function(e){return new D(e)},e.SharePointQueryable=O,e.SharePointQueryableInstance=S,e.SharePointQueryableCollection=_,e.SharePointQueryableSecurable=$,e.RoleDefinitionBindings=K,e.Search=U,e.SearchQueryBuilder=T,e.SearchResults=I,e.SearchBuiltInSourceId=L,e.SearchSuggest=R,e.SearchSuggestResult=A,e.Site=dt,e.UtilityMethod=mt,e.WebPartDefinitions=ae,e.WebPartDefinition=se,e.WebPart=ce,e.Web=lt,Object.defineProperty(e,"__esModule",{value:!0})});