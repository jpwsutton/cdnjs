/**
@license
 * @pnp/sp v1.0.0-beta.10 - pnp - provides a fluent api for working with SharePoint REST
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/logging","@pnp/odata"],t):t((e.pnp=e.pnp||{},e.pnp.sp={}),e.tslib_1,e.common,e.logging,e.odata)}(this,function(e,t,n,r,o){"use strict";function i(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}function u(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new h(e)}function a(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?n.Util.combinePaths(i(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(r.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),"")}function s(e){return new m(e)}function l(e){n.RuntimeConfig.extend(e)}function p(e){return new Promise(function(t){if(n.Util.isUrlAbsolute(e))return t(e);if(null!==v.baseUrl)return t(n.Util.combinePaths(v.baseUrl,e));if(void 0!==global._spPageContextInfo){if(global._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webAbsoluteUrl,e));if(global._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==global.location){var r=global.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=r.indexOf(o);if(i>0)return t(n.Util.combinePaths(r.substr(0,i),e))})}return t(e)})}var c,d=function(e){function n(t){var n=e.call(this,t)||this;return n.name="BatchParseException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),h=function(e){function n(t,n){void 0===n&&(n="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var o=e.call(this,n)||this;return o.data=t,o.name="ODataIdException",r.Logger.error(o),o}return t.__extends(n,e),n}(Error),f=function(e){function n(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var n=e.call(this,t)||this;return n.name="MaxCommentLengthException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),y=function(e){function n(t){void 0===t&&(t="This operation");var n=e.call(this,t+" is not supported as part of a batch.")||this;return n.name="NotSupportedInBatchException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),g=function(e){function n(t){void 0===t&&(t="Unable to determine API url.");var n=e.call(this,t)||this;return n.name="APIUrlException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),m=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(a(e),null);return n.Util.extend(t,e)},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(a(e),null);return n.Util.extend(t,e)})},r}(o.ODataParserBase),b=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(a(e),null);return n.Util.extend(t,e)})},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(a(e),null);return n.Util.extend(t,e)})})},r}(o.ODataParserBase),v=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.baseUrl?e.baseUrl:null!==n.RuntimeConfig.spfxContext?n.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new n.FetchClient}},enumerable:!0,configurable:!0}),e}()),P=function(){return function(){}}(),w=new n.Dictionary,S=function(){function e(e,t){void 0===t&&(t=w),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r&&new Date<r.expiration)return Promise.resolve(r.value);var i=n.Util.combinePaths(e,"/_api/contextinfo"),u={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:n.Util.extend(u,v.headers,!0),method:"POST"}).then(function(e){return(new o.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new P;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.add(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),C=function(){function e(){this._impl=v.fetchClientFactory(),this._digestCache=new S(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var o=n.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if(n.mergeHeaders(i,v.headers),n.mergeHeaders(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/$$Version$$"),(o=n.Util.extend(o,{headers:i})).method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")&&!i.has("Authorization")){var u=e.indexOf("_api/");if(u<0)throw new g;var a=e.substr(0,u);return this._digestCache.getDigest(a).then(function(t){return i.append("X-RequestDigest",t),r.fetchRaw(e,o)})}return this.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;n.mergeHeaders(o,t.headers),t=n.Util.extend(t,{headers:o});var i=function(o){r._impl.fetch(e,t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.Util.getCtxCallback(r,i,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}(),T=function(e){function o(t,r){var o=e.call(this)||this;if("string"==typeof t){var i=t;if(n.Util.isUrlAbsolute(i)||i.lastIndexOf("/")<0)o._parentUrl=i,o._url=n.Util.combinePaths(i,r);else if(i.lastIndexOf("/")>i.lastIndexOf("(")){u=i.lastIndexOf("/");o._parentUrl=i.slice(0,u),r=n.Util.combinePaths(i.slice(u),r),o._url=n.Util.combinePaths(o._parentUrl,r)}else{var u=i.lastIndexOf("(");o._parentUrl=i.slice(0,u),o._url=n.Util.combinePaths(i,r)}}else{var a=t;o._parentUrl=a._url,o._options=a._options;var s=a._query.get("@target");null!==s&&o._query.add("@target",s),o._url=n.Util.combinePaths(o._parentUrl,r)}return o}return t.__extends(o,e),o.prototype.as=function(e){var t=new e(this._url,null);return n.Util.extend(t,this,!0)},o.prototype.toUrlAndQuery=function(){var e=new n.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,o){return r.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+o,0),e.add(n,"'"+o+"'"),n});return e.merge(this._query),e.count>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},o.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==r&&(o=o.inBatch(r)),o},o.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=new e(this,t),o=this.query.get("@target");return null!==o&&r.query.add("@target",o),n&&this.hasBatch&&(r=r.inBatch(this.batch)),r},o.prototype.toRequestContext=function(e,t,r,o){var i=this;void 0===t&&(t={});var u=this.hasBatch?this.addBatchDependency():function(){};return p(this.toUrlAndQuery()).then(function(a){return n.mergeOptions(t,i._options),{batch:i.batch,batchDependency:u,cachingOptions:i._cachingOptions,clientFactory:function(){return new C},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:o,requestAbsoluteUrl:a,requestId:n.Util.getGUID(),verb:e}})},o}(o.ODataQueryable),_=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.filter=function(e){return this._query.add("$filter",e),this},n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),r=[],o=t?" asc":" desc",i=0;i<n.length;i++)if("$orderby"===n[i]){r.push(this._query.get("$orderby"));break}return r.push(""+e+o),this._query.add("$orderby",r.join(",")),this},n.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},n.prototype.top=function(e){return this._query.add("$top",e.toString()),this},n}(T),O=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n}(T),x=function(e){function n(t,n){return void 0===n&&(n="siteusers"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByEmail=function(e){return new I(this,"getByEmail('"+e+"')")},n.prototype.getById=function(e){return new I(this,"getById("+e+")")},n.prototype.getByLoginName=function(e){var t=new I(this);return t.concat("(@v)"),t.query.add("@v","'"+encodeURIComponent(e)+"'"),t},n.prototype.removeById=function(e){return this.clone(n,"removeById("+e+")").postCore()},n.prototype.removeByLoginName=function(e){var t=this.clone(n,"removeByLoginName(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},n.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return t.getByLoginName(e)})},n}(_),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new L(this,"groups")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=n.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),U=function(e){function n(t,n){return void 0===n&&(n="currentuser"),e.call(this,t,n)||this}return t.__extends(n,e),n}(O);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(c||(c={}));var L=function(e){function r(t,n){return void 0===n&&(n="sitegroups"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},r.prototype.getByName=function(e){return new R(this,"getByName('"+e+"')")},r.prototype.getById=function(e){var t=new R(this);return t.concat("("+e+")"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById('"+e+"')").postCore()},r.prototype.removeByLoginName=function(e){return this.clone(r,"removeByLoginName('"+e+"')").postCore()},r}(_),R=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return new x(this,"users")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,o=n.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(o),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=t;return e.hasOwnProperty("Title")&&(o=t.getParent(r,t.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},r}(O),B=function(e){function n(t,n){return void 0===n&&(n="roleassignments"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.getById=function(e){var t=new N(this);return t.concat("("+e+")"),t},n}(_),N=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"groups",{get:function(){return new L(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bindings",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),D=function(e){function r(t,n){return void 0===n&&(n="roledefinitions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){return new E(this,"getById("+e+")")},r.prototype.getByName=function(e){return new E(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return new E(this,"getbytype("+e+")")},r.prototype.add=function(e,t,r,o){var i=this,u=JSON.stringify({BasePermissions:n.Util.extend({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:u}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},r}(_),E=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=n.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;return e.hasOwnProperty("Name")&&(r=t.getParent(D,t.parentUrl,"").getByName(e.Name)),{data:n,definition:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),F=function(e){function n(t,n){return void 0===n&&(n="roledefinitionbindings"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(e.ControlMode||(e.ControlMode={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(e.FieldTypes||(e.FieldTypes={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(e.DateTimeFieldFormatType||(e.DateTimeFieldFormatType={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(e.AddFieldOptions||(e.AddFieldOptions={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(e.CalendarType||(e.CalendarType={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(e.UrlFieldFormatType||(e.UrlFieldFormatType={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(e.PermissionKind||(e.PermissionKind={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(e.PrincipalType||(e.PrincipalType={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(e.PrincipalSource||(e.PrincipalSource={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(e.RoleType||(e.RoleType={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(e.PageType||(e.PageType={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(e.SharingLinkKind||(e.SharingLinkKind={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(e.SharingRole||(e.SharingRole={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(e.SharingOperationStatusCode||(e.SharingOperationStatusCode={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(e.SPSharedObjectType||(e.SPSharedObjectType={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(e.SharingDomainRestrictionMode||(e.SharingDomainRestrictionMode={})),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView"}(e.RenderListDataOptions||(e.RenderListDataOptions={}));var j=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),Object.defineProperty(r.prototype,"roleAssignments",{get:function(){return new B(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new O(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),r.prototype.getUserEffectivePermissions=function(e){var t=this.clone(T,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},r.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new O("_api/web","currentuser").select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},r.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(r,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},r.prototype.resetRoleInheritance=function(){return this.clone(r,"resetroleinheritance").postCore()},r.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},r.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},r.prototype.hasPermissions=function(t,n){if(!n)return!0;if(n===e.PermissionKind.FullMask)return 32767==(32767&t.High)&&65535===t.Low;var r=1;return(n-=1)>=0&&n<32?(r<<=n,0!=(t.Low&r)):n>=32&&n<64&&(r<<=n-32,0!=(t.High&r))},r}(O),A=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null;return this.clone(o,"shareLink").postCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},o.prototype.shareWith=function(t,r,i,u,a){var s=this;void 0===i&&(i=!1),void 0===u&&(u=!1),Array.isArray(t)||(t=[t]);var l=JSON.stringify(t.map(function(e){return{Key:e}})),p=r===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var t={includeAnonymousLinkInEmail:i,peoplePickerInput:l,propagateAcl:u,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==a&&(t=n.Util.extend(t,{emailBody:a.body,emailSubject:void 0!==a.subject?a.subject:"",sendEmail:!0})),s.clone(o,"shareObject").postCore({body:JSON.stringify(t)})})},o.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=n.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=n.Util.extend(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(o)}))},o.prototype.unshareObjectWeb=function(e){return this.clone(o,"unshareObject").postCore({body:JSON.stringify({url:e})})},o.prototype.checkPermissions=function(e){return this.clone(o,"checkPermissions").postCore({body:JSON.stringify({recipients:e})})},o.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(o,"getSharingInformation").postCore({body:JSON.stringify({request:e})})},o.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(o,"getObjectSharingSettings").postCore({body:JSON.stringify({useSimplifiedRoles:e})})},o.prototype.unshareObject=function(){return this.clone(o,"unshareObject").postCore()},o.prototype.deleteLinkByKind=function(e){return this.clone(o,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},o.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(o,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:t})})},o.prototype.getRoleValue=function(t,n){if(void 0===n||null===n){var r=t===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+r).get().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(n){case e.RoleType.Contributor:return new O("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case e.RoleType.Reader:case e.RoleType.Guest:return new O("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},o.prototype.getShareObjectWeb=function(e){return Promise.resolve(new O(i(e),"/_api/SP.Web.ShareObject"))},o.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(t){return t.expand("UsersWithAccessRequests","GroupsSharedWith").as(o).postCore({body:JSON.stringify(e)})})},o}(T),k=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.shareWith=function(t,r,o){var u=this;void 0===r&&(r=e.SharingRole.View);var a=this.addBatchDependency();return new O(i(this.toUrl()),"/_api/web/url").get().then(function(e){return a(),u.shareObject(n.Util.combinePaths(e,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),t,r,o)})},o.prototype.shareObject=function(e,t,n,r,o,i,u,a){return void 0===i&&(i=!1),void 0===u&&(u=!1),void 0===a&&(a=!0),this.clone(A,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:u,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:a})},o.prototype.shareObjectRaw=function(e){return this.clone(A,null).shareObject(e,!0)},o.prototype.unshareObject=function(e){return this.clone(A,null).unshareObjectWeb(e)},o}(j),M=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){return void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null),this.clone(A,null).getShareLink(t,n)},r.prototype.shareWith=function(t,n,r,o){return void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),this.clone(A,null).shareWith(t,n,r,!1,o)},r.prototype.checkSharingPermissions=function(e){return this.clone(A,null).checkPermissions(e)},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(A,null).getSharingInformation(e)},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(A,null).getObjectSharingSettings(e)},r.prototype.unshare=function(){return this.clone(A,null).unshareObject()},r.prototype.deleteSharingLinkByKind=function(e){return this.clone(A,null).deleteLinkByKind(e)},r.prototype.unshareLink=function(e,t){return this.clone(A,null).unshareLink(e,t)},r}(j),q=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null);var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.getShareLink(t,n)})},r.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},r.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getSharingInformation(e)})},r.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},r.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},r.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},r.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},r.prototype.getShareable=function(){var e=this;return this.clone(Q,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var n=new A(a(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},r}(O),Q=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(e){return i(),e.shareWith(t,n,r,!1,o)})},r}(q),H=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o,i){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),void 0===o&&(o=!1);var u=this.addBatchDependency();return this.getShareable().then(function(e){return u(),e.shareWith(t,n,r,o,i)})},r}(q),W=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webparts",{get:function(){return new V(this,"webparts")},enumerable:!0,configurable:!0}),n.prototype.export=function(e){return this.clone(n,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},n.prototype.import=function(e){return this.clone(n,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},n}(T),V=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){return new G(this,"getbyid('"+e+"')")},n.prototype.getByControlId=function(e){return new G(this,"getByControlId('"+e+"')")},n}(_),G=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webpart",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),n.prototype.saveChanges=function(){return this.clone(n,"SaveWebPartChanges").postCore()},n.prototype.moveTo=function(e,t){return this.clone(n,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")").postCore()},n.prototype.close=function(){return this.clone(n,"CloseWebPart").postCore()},n.prototype.open=function(){return this.clone(n,"OpenWebPart").postCore()},n.prototype.delete=function(){return this.clone(n,"DeleteWebPart").postCore()},n}(O),J=function(e){function n(t,n){return void 0===n&&(n="webpart"),e.call(this,t,n)||this}return t.__extends(n,e),n}(O),X=function(e){function n(t,n){return void 0===n&&(n="folders"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new K(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},n}(_),K=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return new _(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"files",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return new r(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return new O(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return new T(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return new _(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new ge(a(e)),e)})},r}(H),z=function(e){function r(t,n){return void 0===n&&(n="contenttypes"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new $(this);return t.concat("('"+e+"')"),t},r.prototype.addAvailableContentType=function(e){var t=this,n=JSON.stringify({contentTypeId:e});return this.clone(r,"addAvailableContentType").postCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},r.prototype.add=function(e,t,r,o,i){var u=this;void 0===r&&(r=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var a=JSON.stringify(n.Util.extend({Description:r,Group:o,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:a}).then(function(e){return{contentType:u.getById(e.id),data:e}})},r}(_),$=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"fieldLinks",{get:function(){return new Z(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fields",{get:function(){return new _(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new n(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"workflowAssociations",{get:function(){return new _(this,"workflowAssociations")},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),Z=function(e){function n(t,n){return void 0===n&&(n="fieldlinks"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Y(this);return t.concat("(guid'"+e+"')"),t},n}(_),Y=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(O),ee=function(e){function n(t,n){return void 0===n&&(n="AttachmentFiles"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new te(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},n.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},n.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},n}(_),te=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getText=function(){return this.getParsed(new o.TextParser)},n.prototype.getBlob=function(){return this.getParsed(new o.BlobParser)},n.prototype.getBuffer=function(){return this.getParsed(new o.BufferParser)},n.prototype.getJSON=function(){return this.getParsed(new o.JSONParser)},n.prototype.setContent=function(e){var t=this;return this.clone(n,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new n(t)})},n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n.prototype.getParsed=function(e){return this.clone(n,"$value",!1).get(e)},n}(O),ne=function(e){function r(t,n){return void 0===n&&(n="views"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new re(this);return t.concat("('"+e+"')"),t},r.prototype.getByTitle=function(e){return new re(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,t,o){var i=this;void 0===t&&(t=!1),void 0===o&&(o={});var u=JSON.stringify(n.Util.extend({PersonalView:t,Title:e,__metadata:{type:"SP.View"}},o));return this.clone(r,null).postCore({body:u}).then(function(e){return{data:e,view:i.getById(e.Id)}})},r}(_),re=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return new oe(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.renderAsHtml=function(){return this.clone(T,"renderashtml").get()},r}(O),oe=function(e){function n(t,n){return void 0===n&&(n="viewfields"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getSchemaXml=function(){return this.clone(T,"schemaxml").get()},n.prototype.add=function(e){return this.clone(n,"addviewfield('"+e+"')").postCore()},n.prototype.move=function(e,t){return this.clone(n,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:t})})},n.prototype.removeAll=function(){return this.clone(n,"removeallviewfields").postCore()},n.prototype.remove=function(e){return this.clone(n,"removeviewfield('"+e+"')").postCore()},n}(_),ie=function(r){function o(e,t){return void 0===t&&(t="fields"),r.call(this,e,t)||this}return t.__extends(o,r),o.prototype.getByTitle=function(e){return new ue(this,"getByTitle('"+e+"')")},o.prototype.getByInternalNameOrTitle=function(e){return new ue(this,"getByInternalNameOrTitle('"+e+"')")},o.prototype.getById=function(e){var t=new ue(this);return t.concat("('"+e+"')"),t},o.prototype.createFieldAsXml=function(e){var t,r=this;t="string"==typeof e?{SchemaXml:e}:e;var i=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},t)});return this.clone(o,"createfieldasxml").postCore({body:i}).then(function(e){return{data:e,field:r.getById(e.Id)}})},o.prototype.add=function(e,t,r){var i=this;void 0===r&&(r={});var u=JSON.stringify(n.Util.extend({Title:e,__metadata:{type:t}},r));return this.clone(o,null).postCore({body:u}).then(function(e){return{data:e,field:i.getById(e.Id)}})},o.prototype.addText=function(e,t,r){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",n.Util.extend(o,r))},o.prototype.addCalculated=function(t,r,o,i,u){void 0===i&&(i=e.FieldTypes.Text);var a={DateFormat:o,FieldTypeKind:17,Formula:r,OutputType:i};return this.add(t,"SP.FieldCalculated",n.Util.extend(a,u))},o.prototype.addDateTime=function(t,r,o,i,u){void 0===r&&(r=e.DateTimeFieldFormatType.DateOnly),void 0===o&&(o=e.CalendarType.Gregorian),void 0===i&&(i=0);var a={DateTimeCalendarType:o,DisplayFormat:r,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(t,"SP.FieldDateTime",n.Util.extend(a,u))},o.prototype.addNumber=function(e,t,r,o){var i={FieldTypeKind:9};return void 0!==t&&(i=n.Util.extend({MinimumValue:t},i)),void 0!==r&&(i=n.Util.extend({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",n.Util.extend(i,o))},o.prototype.addCurrency=function(e,t,r,o,i){void 0===o&&(o=1033);var u={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(u=n.Util.extend({MinimumValue:t},u)),void 0!==r&&(u=n.Util.extend({MaximumValue:r},u)),this.add(e,"SP.FieldCurrency",n.Util.extend(u,i))},o.prototype.addMultilineText=function(e,t,r,o,i,u,a){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===u&&(u=!0);var s={AllowHyperlink:u,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:r};return this.add(e,"SP.FieldMultiLineText",n.Util.extend(s,a))},o.prototype.addUrl=function(t,r,o){void 0===r&&(r=e.UrlFieldFormatType.Hyperlink);var i={DisplayFormat:r,FieldTypeKind:11};return this.add(t,"SP.FieldUrl",n.Util.extend(i,o))},o}(_),ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var o=JSON.stringify(n.Util.extend({__metadata:{type:t}},e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.setShowInDisplayForm=function(e){return this.clone(r,"setshowindisplayform("+e+")").postCore()},r.prototype.setShowInEditForm=function(e){return this.clone(r,"setshowineditform("+e+")").postCore()},r.prototype.setShowInNewForm=function(e){return this.clone(r,"setshowinnewform("+e+")").postCore()},r}(O),ae=function(e){function n(t,n){return void 0===n&&(n="forms"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new se(this);return t.concat("('"+e+"')"),t},n}(_),se=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(O),le=function(e){function n(t,n){return void 0===n&&(n="subscriptions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new pe(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,n){var r=this,o=JSON.stringify({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},n}(_),pe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.update=function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patchCore({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},n.prototype.delete=function(){return e.prototype.deleteCore.call(this)},n}(O),ce=function(e){function r(t,n){return void 0===n&&(n="usercustomactions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new de(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},r.prototype.clear=function(){return this.clone(r,"clear").postCore()},r}(_),de=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),he=function(e){function r(t,n){return void 0===n&&(n="lists"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getByTitle=function(e){return new fe(this,"getByTitle('"+e+"')")},r.prototype.getById=function(e){var t=new fe(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,r,o,i){var u=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={});var a=n.Util.extend({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:u.getByTitle(a.Title)}})},r.prototype.ensure=function(e,t,r,o,i){var u=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw new y("The ensure list method");return new Promise(function(a,s){var l=n.Util.extend(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),p=u.getByTitle(l.Title);p.get().then(function(e){p.update(l).then(function(e){a({created:!1,data:e,list:u.getByTitle(l.Title)})}).catch(function(e){return s(e)})}).catch(function(n){u.add(e,t,r,o,l).then(function(e){a({created:!0,data:e.data,list:u.getByTitle(l.Title)})}).catch(function(e){return s(e)})})})},r.prototype.ensureSiteAssetsLibrary=function(){return this.clone(r,"ensuresiteassetslibrary").postCore().then(function(e){return new fe(u(e))})},r.prototype.ensureSitePagesLibrary=function(){return this.clone(r,"ensuresitepageslibrary").postCore().then(function(e){return new fe(u(e))})},r}(_),fe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"views",{get:function(){return new ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"forms",{get:function(){return new ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"defaultView",{get:function(){return new O(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return new _(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return new T(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return new T(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscriptions",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new K(this,"rootFolder")},enumerable:!0,configurable:!0}),r.prototype.getView=function(e){return new re(this,"getView('"+e+"')")},r.prototype.update=function(e,t){var o=this;void 0===t&&(t="*");var i=JSON.stringify(n.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(function(t){var n=o;return e.hasOwnProperty("Title")&&(n=o.getParent(r,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:t,list:n}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getChanges=function(e){return this.clone(r,"getchanges").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},r.prototype.getItemsByCAMLQuery=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.clone(r,"getitems");return i.expand.apply(i,t).postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},r.prototype.getListItemChangesSinceToken=function(e){return this.clone(r,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},r.prototype.renderListData=function(e){var t=this.clone(r,"renderlistdata(@viewXml)");return t.query.add("@viewXml","'"+e+"'"),t.postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("RenderListData")?e.RenderListData:e})},r.prototype.renderListDataAsStream=function(e,t){void 0===t&&(t=null);var o={overrideParameters:n.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},t),parameters:n.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(r,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(o)})},r.prototype.renderListFormData=function(e,t,n){return this.clone(r,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("ListData")?e.ListData:e})},r.prototype.reserveListItemId=function(){return this.clone(r,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(r,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},r}(j),ye=function(e){function r(t,n){return void 0===n&&(n="items"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new ge(this);return t.concat("("+e+")"),t},r.prototype.getItemByStringId=function(e){return new ge(this.parentUrl,"getItemByStringId('"+e+"')")},r.prototype.skip=function(e){return this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},r.prototype.getPaged=function(){return this.get(new Pe)},r.prototype.add=function(e,t){var o=this;void 0===e&&(e={}),void 0===t&&(t=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var u=JSON.stringify(n.Util.extend({__metadata:{type:t}},e)),a=o.clone(r,null).postCore({body:u}).then(function(e){return{data:e,item:o.getById(e.Id)}});return i(),a})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(fe).getListItemEntityTypeFullName()},r}(_),ge=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"attachmentFiles",{get:function(){return new ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentType",{get:function(){return new $(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return new T(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return new O(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return new O(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return new O(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folder",{get:function(){return new K(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"file",{get:function(){return new Ce(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e,t,r){var o=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(i,u){var a=o.addBatchDependency();return o.ensureListItemEntityTypeName(r).then(function(r){var u=JSON.stringify(n.Util.extend({__metadata:{type:r}},e));return a(),o.postCore({body:u,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new we).then(function(e){i({data:e,item:o})})}).catch(function(e){return u(e)})})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(r,"getWOPIFrameUrl(@action)");return t._query.add("@action",e),t.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},r.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(r,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:t})})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(fe,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},r}(M),me=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new be(this);return t.concat("("+e+")"),t},n}(_),be=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),ve=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new ye(this.nextUrl,null).getPaged():new Promise(function(e){return e(null)})},e}(),Pe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];n(new ve(r,t.parseODataJSON(e)))})})},n}(o.ODataParserBase),we=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})},n}(o.ODataParserBase),Se=function(e){function n(t,n){return void 0===n&&(n="files"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new Ce(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},n.prototype.addChunked=function(e,t,r,o,i){var u=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return u.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)}).then(function(t){return{data:t,file:u.getByName(e)}})},n.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},n}(_),Ce=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(i,r),Object.defineProperty(i.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"versions",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),i.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(i,"approve(comment='"+e+"')").postCore()},i.prototype.cancelUpload=function(e){return this.clone(i,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},i.prototype.checkin=function(t,n){if(void 0===t&&(t=""),void 0===n&&(n=e.CheckinType.Major),t.length>1023)throw new f;return this.clone(i,"checkin(comment='"+t+"',checkintype="+n+")").postCore()},i.prototype.checkout=function(){return this.clone(i,"checkout").postCore()},i.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(i,"copyTo(strnewurl='"+e+"',boverwrite="+t+")").postCore()},i.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(i,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},i.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new f;return this.clone(i,"deny(comment='"+e+"')").postCore()},i.prototype.getLimitedWebPartManager=function(t){return void 0===t&&(t=e.WebPartsPersonalizationScope.Shared),new W(this,"getLimitedWebPartManager(scope="+t+")")},i.prototype.moveTo=function(t,n){return void 0===n&&(n=e.MoveOperations.Overwrite),this.clone(i,"moveTo(newurl='"+t+"',flags="+n+")").postCore()},i.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new f;return this.clone(i,"publish(comment='"+e+"')").postCore()},i.prototype.recycle=function(){return this.clone(i,"recycle").postCore()},i.prototype.undoCheckout=function(){return this.clone(i,"undoCheckout").postCore()},i.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new f;return this.clone(i,"unpublish(comment='"+e+"')").postCore()},i.prototype.getText=function(){return this.clone(i,"$value",!1).get(new o.TextParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBlob=function(){return this.clone(i,"$value",!1).get(new o.BlobParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBuffer=function(){return this.clone(i,"$value",!1).get(new o.BufferParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getJSON=function(){return this.clone(i,"$value",!1).get(new o.JSONParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.setContent=function(e){var t=this;return this.clone(i,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new i(t)})},i.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new ge(a(e)),e)})},i.prototype.setContentChunked=function(e,t,r){void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var o=this,i=e.size,u=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),a=n.Util.getGUID();t({blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:u});for(var s=o.startUpload(a,e.slice(0,r)),l=2;l<u;l++)!function(n){s=s.then(function(s){return t({blockNumber:n,chunkSize:r,currentPointer:s,fileSize:i,stage:"continue",totalBlocks:u}),o.continueUpload(a,s,e.slice(s,s+r))})}(l);return s.then(function(n){return t({blockNumber:u,chunkSize:r,currentPointer:n,fileSize:i,stage:"finishing",totalBlocks:u}),o.finishUpload(a,n,e.slice(n))}).then(function(e){return o})},i.prototype.startUpload=function(e,t){return this.clone(i,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:t}).then(function(e){return parseFloat(e)})},i.prototype.continueUpload=function(e,t,n){return this.clone(i,"continueUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return parseFloat(e)})},i.prototype.finishUpload=function(e,t,n){return this.clone(i,"finishUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return{data:e,file:new i(e.ServerRelativeUrl)}})},i}(Q),Te=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new _e(this);return t.concat("("+e+")"),t},n.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},n.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},n.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},n.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},n.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},n.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()},n}(_),_e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n}(O);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(e.CheckinType||(e.CheckinType={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(e.WebPartsPersonalizationScope||(e.WebPartsPersonalizationScope={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(e.MoveOperations||(e.MoveOperations={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage"}(e.TemplateFileType||(e.TemplateFileType={}));var Oe=function(e){function n(t,n){void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps");var r="";return"string"==typeof t?r=t:void 0!==t&&(r=t.toUrl()),e.call(this,i(r),n)||this}return t.__extends(n,e),n.prototype.getAppById=function(e){return new xe(this,"getById('"+e+"')")},n.prototype.add=function(e,t,r){return void 0===r&&(r=!0),new n(i(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(e){return{data:e,file:new Ce(u(e))}})},n}(_),xe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deploy=function(){return this.clone(n,"Deploy").postCore()},n.prototype.retract=function(){return this.clone(n,"Retract").postCore()},n.prototype.install=function(){return this.clone(n,"Install").postCore()},n.prototype.uninstall=function(){return this.clone(n,"Uninstall").postCore()},n.prototype.upgrade=function(){return this.clone(n,"Upgrade").postCore()},n.prototype.remove=function(){return this.clone(n,"Remove").postCore()},n}(O),Ie=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ue(this);return t.concat("("+e+")"),t},n.prototype.add=function(e,t,r){var o=this;void 0===r&&(r=!0);var i=JSON.stringify({IsVisible:r,Title:e,Url:t,__metadata:{type:"SP.NavigationNode"}});return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},n.prototype.moveAfter=function(e,t){var r=JSON.stringify({nodeId:e,previousNodeId:t});return this.clone(n,"MoveAfter").postCore({body:r})},n}(_),Ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return new Ie(this,"Children")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),Le=function(e){function n(t,n){return void 0===n&&(n="navigation"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"quicklaunch",{get:function(){return new Ie(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topNavigationBar",{get:function(){return new Ie(this,"topnavigationbar")},enumerable:!0,configurable:!0}),n}(T),Re=function(e){function n(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return t.__extends(n,e),n.prototype.getMenuState=function(e,t,r,o){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===r&&(r=null),void 0===o&&(o=null),new n("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:t,mapProviderName:r,menuNodeKey:e})})},n.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),new n("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:t})})},n}(T),Be=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,n){return void 0===t&&(t=""),void 0===n&&(n={}),new e(t,n)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=n.Util.extend(this._query,e),this},e}(),Ne=function(e){function r(t,n){return void 0===n&&(n="_api/search/postquery"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.execute=function(e){var t,r=this;(t=e).SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var o=JSON.stringify({request:n.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:o}).then(function(t){return new De(t,r.toUrl(),e)})},r.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},r}(O),De=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,o=n.Util.extend(this._query,{RowLimit:r,StartRow:r*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new Ne(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(e.SortDirection||(e.SortDirection={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(e.ReorderingRuleMatchType||(e.ReorderingRuleMatchType={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32TYpe=2]="Int32TYpe",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(e.QueryPropertyValueType||(e.QueryPropertyValueType={}));var Ee=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),Fe=function(e){function n(t,n){return void 0===n&&(n="_api/search/suggest"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new je(e)})},n.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},n}(O),je=function(){return function(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}}(),Ae=function(e){function o(t){var n=e.call(this)||this;return n.baseUrl=t,n}return t.__extends(o,e),o.prototype.executeImpl=function(){var e=this;if(r.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return r.Logger.write("Resolving empty batch.",1),Promise.resolve();var t=new C;return p(this.baseUrl).then(function(o){for(var i=[],u="",a=0;a<e.requests.length;a++){var s=e.requests[a];"GET"===s.method?(u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=n.Util.getGUID(),i.push("--batch_"+e.batchId+"\n"),i.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),i.push("--changeset_"+u+"\n")),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n");var l=new Headers,p=n.Util.isUrlAbsolute(s.url)?s.url:n.Util.combinePaths(o,s.url);if(r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+s.method+" "+p+" to batch.",0),"GET"!==s.method){var c=s.method,h=s.options.headers;s.hasOwnProperty("options")&&s.options.hasOwnProperty("headers")&&void 0!==h["X-HTTP-Method"]&&(c=h["X-HTTP-Method"],delete h["X-HTTP-Method"]),i.push(c+" "+p+" HTTP/1.1\n"),l.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else i.push(s.method+" "+p+" HTTP/1.1\n");n.mergeHeaders(l,v.headers),s.options&&n.mergeHeaders(l,s.options.headers),l.has("Accept")||l.append("Accept","application/json"),l.has("Content-Type")||l.append("Content-Type","application/json;odata=verbose;charset=utf-8"),l.has("X-ClientService-ClientTag")||l.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),l.forEach(function(e,t){i.push(t+": "+e+"\n")}),i.push("\n"),s.options.body&&i.push(s.options.body+"\n\n")}u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"--\n");var f={body:i.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch(n.Util.combinePaths(o,"/_api/$batch"),f).then(function(e){return e.text()}).then(e._parseResponse).then(function(t){if(t.length!==e.requests.length)throw new d("Could not properly parse responses to match requests in batch.");return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,o){var i=e.requests[o];return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",0),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},o.prototype._parseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],u=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),a=e.split("\n"),s="batch",l=0;l<a.length;++l){var p=a[l];switch(s){case"batch":if("--batchresponse_"===p.substr(0,"--batchresponse_".length))s="batchHeaders";else if(""!==p.trim())throw new d("Invalid response, line "+l);break;case"batchHeaders":""===p.trim()&&(s="status");break;case"status":var c=u.exec(p);if(3!==c.length)throw new d("Invalid status, line "+l);r=parseInt(c[1],10),o=c[2],s="statusHeaders";break;case"statusHeaders":""===p.trim()&&(s="body");break;case"body":i.push(204===r?new Response:new Response(p,{status:r,statusText:o})),s="batch"}}"status"!==s&&n(new d("Unexpected end of input")),t(i)})},o}(o.ODataBatch),ke=function(e){function n(t,n){return void 0===n&&(n="features"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Me(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(n,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},n.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,"remove").postCore({body:JSON.stringify({featureId:e,force:t})})},n}(_),Me=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deactivate=function(e){var t=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new n(this).select("DefinitionId").get().then(function(n){var o=t.getParent(ke,t.parentUrl,"",t.batch).remove(n.DefinitionId,e);return r(),o})},n}(O),qe=function(e){function n(t,n){return void 0===n&&(n="_api/SP.RelatedItemManager"),e.call(this,t,n)||this}return t.__extends(n,e),n.FromUrl=function(e){if(null===e)return new n("");var t=e.indexOf("_api/");return new n(t>-1?e.substr(0,t):e)},n.prototype.getRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.addSingleLink=function(e,t,r,o,i,u,a){void 0===a&&(a=!1);var s=this.clone(n,null);return s.concat(".AddSingleLink"),s.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryAddReverseLink:a})})},n.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},n.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},n.prototype.deleteSingleLink=function(e,t,r,o,i,u,a){void 0===a&&(a=!1);var s=this.clone(n,null);return s.concat(".DeleteSingleLink"),s.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryDeleteReverseLink:a})})},n}(T),Qe=function(e){function n(t,n){return void 0===n&&(n="regionalsettings"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"installedLanguages",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"globalInstalledLanguages",{get:function(){return new He(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZone",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZones",{get:function(){return new Ve(this)},enumerable:!0,configurable:!0}),n}(O),He=function(e){function n(t,n){return void 0===n&&(n="installedlanguages"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_),We=function(e){function r(t,n){return void 0===n&&(n="timezone"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(r,"utctolocaltime('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},r.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:n.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(r,"localtimetoutc('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},r}(O),Ve=function(e){function n(t,n){return void 0===n&&(n="timezones"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},s(We))},n}(_),Ge=function(e){function r(t,n){return void 0===n&&(n="webs"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e,t,o,i,a,s){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===a&&(a=1033),void 0===s&&(s=!0);var l={Description:o,Language:a,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:i},p=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},l)});return this.clone(r,"add").postCore({body:p}).then(function(e){return{data:e,web:new Xe(u(e).replace(/_api\/web\/?/i,""))}})},r}(_),Je=function(e){function n(t,n){return void 0===n&&(n="webinfos"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_),Xe=function(e){function r(t,n){return void 0===n&&(n="_api/web"),e.call(this,t,n)||this}return t.__extends(r,e),r.fromUrl=function(e,t){return new r(i(e),t)},Object.defineProperty(r.prototype,"webs",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),r.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Ge,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(r.prototype,"allProperties",{get:function(){return this.clone(_,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lists",{get:function(){return new he(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availablefields",{get:function(){return new ie(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"navigation",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUsers",{get:function(){return new x(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteGroups",{get:function(){return new L(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUserInfoList",{get:function(){return new fe(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"regionalSettings",{get:function(){return new Qe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentUser",{get:function(){return new U(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"roleDefinitions",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedItems",{get:function(){return qe.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new Ae(this.parentUrl)},Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new K(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedOwnerGroup",{get:function(){return new R(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedMemberGroup",{get:function(){return new R(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedVisitorGroup",{get:function(){return new R(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),r.prototype.getFolderByServerRelativeUrl=function(e){return new K(this,"getFolderByServerRelativeUrl('"+e+"')")},r.prototype.getFileByServerRelativeUrl=function(e){return new Ce(this,"getFileByServerRelativeUrl('"+e+"')")},r.prototype.getList=function(e){return new fe(this,"getList('"+e+"')")},r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r.prototype.applyTheme=function(e,t,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(r,"applytheme").postCore({body:i})},r.prototype.applyWebTemplate=function(e){var t=this.clone(r,"applywebtemplate");return t.concat("(@t)"),t.query.add("@t",e),t.postCore()},r.prototype.ensureUser=function(e){var t=JSON.stringify({logonName:e});return this.clone(r,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new I(u(e))}})},r.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new _(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},r.prototype.getCatalog=function(e){return this.clone(r,"getcatalog("+e+")").select("Id").get().then(function(e){return new fe(u(e))})},r.prototype.getChanges=function(e){var t=JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(r,"getchanges").postCore({body:t})},Object.defineProperty(r.prototype,"customListTemplate",{get:function(){return new _(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),r.prototype.getUserById=function(e){return new I(this,"getUserById("+e+")")},r.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(r,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},r.prototype.getStorageEntity=function(e){return this.clone(r,"getStorageEntity('"+e+"')").get()},r.prototype.getAppCatalog=function(e){return new Oe(e||this)},r}(k),Ke=function(e){function n(t,n){return void 0===n&&(n="_api/site"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"rootWeb",{get:function(){return new Xe(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"features",{get:function(){return new ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userCustomActions",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),n.prototype.getContextInfo=function(){return new n(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},n.prototype.getDocumentLibraries=function(e){var t=new T("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},n.prototype.getWebUrlFromPageUrl=function(e){var t=new T("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},n.prototype.createBatch=function(){return new Ae(this.parentUrl)},n.prototype.openWebById=function(e){return this.clone(n,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Xe.fromUrl(u(e))}})},n}(O),ze=function(e){function r(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.profileLoader=new $e(t),r}return t.__extends(r,e),Object.defineProperty(r.prototype,"editProfileLink",{get:function(){return this.clone(r,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(r,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),r.prototype.amIFollowedBy=function(e){var t=this.clone(r,"amifollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.amIFollowing=function(e){var t=this.clone(r,"amifollowing(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(r,"getfollowedtags("+e+")").get()},r.prototype.getFollowersFor=function(e){var t=this.clone(r,"getfollowersfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"myFollowers",{get:function(){return new _(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"myProperties",{get:function(){return new r(this,"getmyproperties")},enumerable:!0,configurable:!0}),r.prototype.getPeopleFollowedBy=function(e){var t=this.clone(r,"getpeoplefollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getPropertiesFor=function(e){var t=this.clone(r,"getpropertiesfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"trendingTags",{get:function(){var e=this.clone(r,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),r.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(r,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},r.prototype.hideSuggestion=function(e){var t=this.clone(r,"hidesuggestion(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},r.prototype.isFollowing=function(e,t){var n=this.clone(r,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(t)+"'"),n.get()},r.prototype.setMyProfilePic=function(e){var t=this;return new Promise(function(o,i){n.readBlobAsArrayBuffer(e).then(function(e){new r(t,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return o()})}).catch(function(e){return i(e)})})},r.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},r.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},r}(O),$e=function(e){function n(t,n){return void 0===n&&(n="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(n.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(n,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userProfile",{get:function(){return this.clone(n,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),n.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},n.prototype.shareAllSocialData=function(e){return this.clone(n,"getuserprofile/shareallsocialdata("+e+")").postCore()},n}(T),Ze=function(e){function r(t,n){return e.call(this,r.getBaseUrl(t),"_api/SP.Utilities.Utility."+n)||this}return t.__extends(r,e),r.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},r.prototype.excute=function(e){return this.postCore({body:JSON.stringify(e)})},r.prototype.sendEmail=function(e){var t={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(t.properties=n.Util.extend(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=n.Util.extend(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=n.Util.extend(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=n.Util.extend(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(r,"SendEmail",!0).excute(t)},r.prototype.getCurrentUserEmailAddresses=function(){return this.clone(r,"GetCurrentUserEmailAddresses",!0).excute({})},r.prototype.resolvePrincipal=function(e,t,n,o,i,u){void 0===u&&(u=!1);var a={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:u,scopes:t,sources:n};return this.clone(r,"ResolvePrincipalInCurrentContext",!0).excute(a)},r.prototype.searchPrincipals=function(e,t,n,o,i){var u={groupName:o,input:e,maxCount:i,scopes:t,sources:n};return this.clone(r,"SearchPrincipalsUsingContextWeb",!0).excute(u)},r.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.clone(r,"CreateEmailBodyForInvitation",!0).excute(t)},r.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t};return this.clone(r,"ExpandGroupsToPrincipals",!0).excute(n)},r.prototype.createWikiPage=function(e){return this.clone(r,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new Ce(u(e))}})},r}(T),Ye=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){l(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new Fe(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof Be?e.toSearchQuery():e,new Ne(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new Ke(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new Xe(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new ze(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new Re},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new Ze(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e}(),et=new Ye;e.spExtractODataId=u,e.spODataEntity=s,e.spODataEntityArray=function(e){return new b(e)},e.SharePointQueryable=T,e.SharePointQueryableInstance=O,e.SharePointQueryableCollection=_,e.SharePointQueryableSecurable=j,e.FileFolderShared=q,e.SharePointQueryableShareable=A,e.SharePointQueryableShareableFile=Q,e.SharePointQueryableShareableFolder=H,e.SharePointQueryableShareableItem=M,e.SharePointQueryableShareableWeb=k,e.AppCatalog=Oe,e.App=xe,e.File=Ce,e.Files=Se,e.Folder=K,e.Folders=X,e.SPHttpClient=C,e.Item=ge,e.Items=ye,e.ItemVersion=be,e.ItemVersions=me,e.PagedItemCollection=ve,e.NavigationNodes=Ie,e.NavigationNode=Ue,e.NavigationService=Re,e.List=fe,e.Lists=he,e.sp=et,e.SPRest=Ye,e.RoleDefinitionBindings=F,e.Search=Ne,e.SearchQueryBuilder=Be,e.SearchResults=De,e.SearchBuiltInSourceId=Ee,e.SearchSuggest=Fe,e.SearchSuggestResult=je,e.Site=Ke,e.UtilityMethod=Ze,e.WebPartDefinitions=V,e.WebPartDefinition=G,e.WebPart=J,e.Web=Xe,Object.defineProperty(e,"__esModule",{value:!0})});