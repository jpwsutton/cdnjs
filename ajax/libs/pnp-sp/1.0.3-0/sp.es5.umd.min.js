/**
@license
 * @pnp/sp v1.0.3-0 - pnp - provides a fluent api for working with SharePoint REST
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/logging","@pnp/odata"],t):t((e.pnp=e.pnp||{},e.pnp.sp={}),e.tslib_1,e.pnp.common,e.pnp.logging,e.pnp.odata)}(this,function(e,t,n,r,o){"use strict";function i(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}var s=function(e){function n(t){var n=e.call(this,t)||this;return n.name="BatchParseException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),a=function(e){function n(t,n){void 0===n&&(n="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var o=e.call(this,n)||this;return o.data=t,o.name="ODataIdException",r.Logger.error(o),o}return t.__extends(n,e),n}(Error),u=function(e){function n(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var n=e.call(this,t)||this;return n.name="MaxCommentLengthException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),l=function(e){function n(t){void 0===t&&(t="This operation");var n=e.call(this,t+" is not supported as part of a batch.")||this;return n.name="NotSupportedInBatchException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),p=function(e){function n(t){void 0===t&&(t="Unable to determine API url.");var n=e.call(this,t)||this;return n.name="APIUrlException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error);function c(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new a(e)}var d=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})},r}(o.ODataParserBase),h=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})})},r}(o.ODataParserBase);function f(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?n.Util.combinePaths(i(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(r.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),"")}function y(e){return new d(e)}var g=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.baseUrl?e.baseUrl:null!==n.RuntimeConfig.spfxContext?n.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new n.FetchClient}},enumerable:!0,configurable:!0}),e}()),m=function(){return function(){}}(),b=new n.Dictionary,v=function(){function e(e,t){void 0===t&&(t=b),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r&&new Date<r.expiration)return Promise.resolve(r.value);var i=n.Util.combinePaths(e,"/_api/contextinfo");return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:n.Util.extend({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},g.headers,!0),method:"POST"}).then(function(e){return(new o.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new m;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.add(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),P=function(){function e(){this._impl=g.fetchClientFactory(),this._digestCache=new v(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var o=n.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if(n.mergeHeaders(i,g.headers),n.mergeHeaders(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/$$Version$$"),(o=n.Util.extend(o,{headers:i})).method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")&&!i.has("Authorization")){var s=e.indexOf("_api/");if(s<0)throw new p;var a=e.substr(0,s);return this._digestCache.getDigest(a).then(function(t){return i.append("X-RequestDigest",t),r.fetchRaw(e,o)})}return this.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;n.mergeHeaders(o,t.headers),t=n.Util.extend(t,{headers:o});var i=function(o){r._impl.fetch(e,t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.Util.getCtxCallback(r,i,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();function w(e){return new Promise(function(t){if(n.Util.isUrlAbsolute(e))return t(e);if(null!==g.baseUrl)return t(n.Util.combinePaths(g.baseUrl,e));if(void 0!==global._spPageContextInfo){if(global._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webAbsoluteUrl,e));if(global._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==global.location){var r=global.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=r.indexOf(o);if(i>0)return t(n.Util.combinePaths(r.substr(0,i),e))})}return t(e)})}var C,S,T=function(e){function o(t,r){var o=e.call(this)||this;if("string"==typeof t){var i=t;if(n.Util.isUrlAbsolute(i)||i.lastIndexOf("/")<0)o._parentUrl=i,o._url=n.Util.combinePaths(i,r);else if(i.lastIndexOf("/")>i.lastIndexOf("(")){var s=i.lastIndexOf("/");o._parentUrl=i.slice(0,s),r=n.Util.combinePaths(i.slice(s),r),o._url=n.Util.combinePaths(o._parentUrl,r)}else{s=i.lastIndexOf("(");o._parentUrl=i.slice(0,s),o._url=n.Util.combinePaths(i,r)}}else{var a=t;o._parentUrl=a._url,o._options=a._options;var u=a._query.get("@target");null!==u&&o._query.add("@target",u),o._url=n.Util.combinePaths(o._parentUrl,r)}return o}return t.__extends(o,e),o.prototype.as=function(e){var t=new e(this._url,null);return n.Util.extend(t,this,!0)},o.prototype.toUrlAndQuery=function(){var e=new n.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,o){return r.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+o,0),e.add(n,"'"+o+"'"),n});return e.merge(this._query),e.count>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},o.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==r&&(o=o.inBatch(r)),o},o.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=new e(this,t);r.configure(this._options);var o=this.query.get("@target");return null!==o&&r.query.add("@target",o),n&&this.hasBatch&&(r=r.inBatch(this.batch)),r},o.prototype.toRequestContext=function(e,t,r,o){var i=this;void 0===t&&(t={});var s=this.hasBatch?this.addBatchDependency():function(){};return w(this.toUrlAndQuery()).then(function(a){return n.mergeOptions(t,i._options),{batch:i.batch,batchDependency:s,cachingOptions:i._cachingOptions,clientFactory:function(){return new P},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:o,requestAbsoluteUrl:a,requestId:n.Util.getGUID(),verb:e}})},o}(o.ODataQueryable),x=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.filter=function(e){return this._query.add("$filter",e),this},n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n.prototype.orderBy=function(e,t){var n=this;void 0===t&&(t=!0);var r=this._query.getKeys().filter(function(e){return"$orderby"===e}).map(function(e){return n._query.get(e)});return r.push(e+" "+(t?"asc":"desc")),this._query.add("$orderby",r.join(",")),this},n.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},n.prototype.top=function(e){return this._query.add("$top",e.toString()),this},n}(T),_=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n}(T),I=function(e){function n(t,n){return void 0===n&&(n="siteusers"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByEmail=function(e){return new O(this,"getByEmail('"+e+"')")},n.prototype.getById=function(e){return new O(this,"getById("+e+")")},n.prototype.getByLoginName=function(e){var t=new O(this);return t.concat("(@v)"),t.query.add("@v","'"+encodeURIComponent(e)+"'"),t},n.prototype.removeById=function(e){return this.clone(n,"removeById("+e+")").postCore()},n.prototype.removeByLoginName=function(e){var t=this.clone(n,"removeByLoginName(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},n.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return t.getByLoginName(e)})},n}(x),O=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new X(this,"groups")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=n.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(_),U=function(e){function n(t,n){return void 0===n&&(n="currentuser"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_);(S=C||(C={}))[S.None=0]="None",S[S.User=1]="User",S[S.DistributionList=2]="DistributionList",S[S.SecurityGroup=4]="SecurityGroup",S[S.SharePointGroup=8]="SharePointGroup",S[S.All=15]="All";var D,R,F,L,B,N,E,j,A,k,M,q,H,V,Q,J,W,G,K,X=function(e){function r(t,n){return void 0===n&&(n="sitegroups"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},r.prototype.getByName=function(e){return new z(this,"getByName('"+e+"')")},r.prototype.getById=function(e){var t=new z(this);return t.concat("("+e+")"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById('"+e+"')").postCore()},r.prototype.removeByLoginName=function(e){return this.clone(r,"removeByLoginName('"+e+"')").postCore()},r}(x),z=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return new I(this,"users")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,o=n.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(o),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=t;return e.hasOwnProperty("Title")&&(o=t.getParent(r,t.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},r}(_),$=function(e){function n(t,n){return void 0===n&&(n="roleassignments"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.getById=function(e){var t=new Z(this);return t.concat("("+e+")"),t},n}(x),Z=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"groups",{get:function(){return new X(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bindings",{get:function(){return new te(this)},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(_),Y=function(e){function r(t,n){return void 0===n&&(n="roledefinitions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){return new ee(this,"getById("+e+")")},r.prototype.getByName=function(e){return new ee(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return new ee(this,"getbytype("+e+")")},r.prototype.add=function(e,t,r,o){var i=this,s=JSON.stringify({BasePermissions:n.Util.extend({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:s}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},r}(x),ee=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=n.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;e.hasOwnProperty("Name")&&(r=t.getParent(Y,t.parentUrl,"").getByName(e.Name));return{data:n,definition:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(_),te=function(e){function n(t,n){return void 0===n&&(n="roledefinitionbindings"),e.call(this,t,n)||this}return t.__extends(n,e),n}(x);(D=e.ControlMode||(e.ControlMode={}))[D.Display=1]="Display",D[D.Edit=2]="Edit",D[D.New=3]="New",(R=e.FieldTypes||(e.FieldTypes={}))[R.Invalid=0]="Invalid",R[R.Integer=1]="Integer",R[R.Text=2]="Text",R[R.Note=3]="Note",R[R.DateTime=4]="DateTime",R[R.Counter=5]="Counter",R[R.Choice=6]="Choice",R[R.Lookup=7]="Lookup",R[R.Boolean=8]="Boolean",R[R.Number=9]="Number",R[R.Currency=10]="Currency",R[R.URL=11]="URL",R[R.Computed=12]="Computed",R[R.Threading=13]="Threading",R[R.Guid=14]="Guid",R[R.MultiChoice=15]="MultiChoice",R[R.GridChoice=16]="GridChoice",R[R.Calculated=17]="Calculated",R[R.File=18]="File",R[R.Attachments=19]="Attachments",R[R.User=20]="User",R[R.Recurrence=21]="Recurrence",R[R.CrossProjectLink=22]="CrossProjectLink",R[R.ModStat=23]="ModStat",R[R.Error=24]="Error",R[R.ContentTypeId=25]="ContentTypeId",R[R.PageSeparator=26]="PageSeparator",R[R.ThreadIndex=27]="ThreadIndex",R[R.WorkflowStatus=28]="WorkflowStatus",R[R.AllDayEvent=29]="AllDayEvent",R[R.WorkflowEventType=30]="WorkflowEventType",(F=e.DateTimeFieldFormatType||(e.DateTimeFieldFormatType={}))[F.DateOnly=0]="DateOnly",F[F.DateTime=1]="DateTime",(L=e.AddFieldOptions||(e.AddFieldOptions={}))[L.DefaultValue=0]="DefaultValue",L[L.AddToDefaultContentType=1]="AddToDefaultContentType",L[L.AddToNoContentType=2]="AddToNoContentType",L[L.AddToAllContentTypes=4]="AddToAllContentTypes",L[L.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",L[L.AddFieldToDefaultView=16]="AddFieldToDefaultView",L[L.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName",(B=e.CalendarType||(e.CalendarType={}))[B.Gregorian=1]="Gregorian",B[B.Japan=3]="Japan",B[B.Taiwan=4]="Taiwan",B[B.Korea=5]="Korea",B[B.Hijri=6]="Hijri",B[B.Thai=7]="Thai",B[B.Hebrew=8]="Hebrew",B[B.GregorianMEFrench=9]="GregorianMEFrench",B[B.GregorianArabic=10]="GregorianArabic",B[B.GregorianXLITEnglish=11]="GregorianXLITEnglish",B[B.GregorianXLITFrench=12]="GregorianXLITFrench",B[B.KoreaJapanLunar=14]="KoreaJapanLunar",B[B.ChineseLunar=15]="ChineseLunar",B[B.SakaEra=16]="SakaEra",B[B.UmAlQura=23]="UmAlQura",(N=e.UrlFieldFormatType||(e.UrlFieldFormatType={}))[N.Hyperlink=0]="Hyperlink",N[N.Image=1]="Image",(E=e.PermissionKind||(e.PermissionKind={}))[E.EmptyMask=0]="EmptyMask",E[E.ViewListItems=1]="ViewListItems",E[E.AddListItems=2]="AddListItems",E[E.EditListItems=3]="EditListItems",E[E.DeleteListItems=4]="DeleteListItems",E[E.ApproveItems=5]="ApproveItems",E[E.OpenItems=6]="OpenItems",E[E.ViewVersions=7]="ViewVersions",E[E.DeleteVersions=8]="DeleteVersions",E[E.CancelCheckout=9]="CancelCheckout",E[E.ManagePersonalViews=10]="ManagePersonalViews",E[E.ManageLists=12]="ManageLists",E[E.ViewFormPages=13]="ViewFormPages",E[E.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",E[E.Open=17]="Open",E[E.ViewPages=18]="ViewPages",E[E.AddAndCustomizePages=19]="AddAndCustomizePages",E[E.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",E[E.ApplyStyleSheets=21]="ApplyStyleSheets",E[E.ViewUsageData=22]="ViewUsageData",E[E.CreateSSCSite=23]="CreateSSCSite",E[E.ManageSubwebs=24]="ManageSubwebs",E[E.CreateGroups=25]="CreateGroups",E[E.ManagePermissions=26]="ManagePermissions",E[E.BrowseDirectories=27]="BrowseDirectories",E[E.BrowseUserInfo=28]="BrowseUserInfo",E[E.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",E[E.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",E[E.ManageWeb=31]="ManageWeb",E[E.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",E[E.UseClientIntegration=37]="UseClientIntegration",E[E.UseRemoteAPIs=38]="UseRemoteAPIs",E[E.ManageAlerts=39]="ManageAlerts",E[E.CreateAlerts=40]="CreateAlerts",E[E.EditMyUserInfo=41]="EditMyUserInfo",E[E.EnumeratePermissions=63]="EnumeratePermissions",E[E.FullMask=65]="FullMask",(j=e.PrincipalType||(e.PrincipalType={}))[j.None=0]="None",j[j.User=1]="User",j[j.DistributionList=2]="DistributionList",j[j.SecurityGroup=4]="SecurityGroup",j[j.SharePointGroup=8]="SharePointGroup",j[j.All=15]="All",(A=e.PrincipalSource||(e.PrincipalSource={}))[A.None=0]="None",A[A.UserInfoList=1]="UserInfoList",A[A.Windows=2]="Windows",A[A.MembershipProvider=4]="MembershipProvider",A[A.RoleProvider=8]="RoleProvider",A[A.All=15]="All",(k=e.RoleType||(e.RoleType={}))[k.None=0]="None",k[k.Guest=1]="Guest",k[k.Reader=2]="Reader",k[k.Contributor=3]="Contributor",k[k.WebDesigner=4]="WebDesigner",k[k.Administrator=5]="Administrator",(M=e.PageType||(e.PageType={}))[M.Invalid=-1]="Invalid",M[M.DefaultView=0]="DefaultView",M[M.NormalView=1]="NormalView",M[M.DialogView=2]="DialogView",M[M.View=3]="View",M[M.DisplayForm=4]="DisplayForm",M[M.DisplayFormDialog=5]="DisplayFormDialog",M[M.EditForm=6]="EditForm",M[M.EditFormDialog=7]="EditFormDialog",M[M.NewForm=8]="NewForm",M[M.NewFormDialog=9]="NewFormDialog",M[M.SolutionForm=10]="SolutionForm",M[M.PAGE_MAXITEMS=11]="PAGE_MAXITEMS",(q=e.SharingLinkKind||(e.SharingLinkKind={}))[q.Uninitialized=0]="Uninitialized",q[q.Direct=1]="Direct",q[q.OrganizationView=2]="OrganizationView",q[q.OrganizationEdit=3]="OrganizationEdit",q[q.AnonymousView=4]="AnonymousView",q[q.AnonymousEdit=5]="AnonymousEdit",q[q.Flexible=6]="Flexible",(H=e.SharingRole||(e.SharingRole={}))[H.None=0]="None",H[H.View=1]="View",H[H.Edit=2]="Edit",H[H.Owner=3]="Owner",(V=e.SharingOperationStatusCode||(e.SharingOperationStatusCode={}))[V.CompletedSuccessfully=0]="CompletedSuccessfully",V[V.AccessRequestsQueued=1]="AccessRequestsQueued",V[V.NoResolvedUsers=-1]="NoResolvedUsers",V[V.AccessDenied=-2]="AccessDenied",V[V.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",V[V.UnknowError=-4]="UnknowError",V[V.EmailBodyTooLong=-5]="EmailBodyTooLong",V[V.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",V[V.CapabilityDisabled=-7]="CapabilityDisabled",V[V.ObjectNotSupported=-8]="ObjectNotSupported",V[V.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",(Q=e.SPSharedObjectType||(e.SPSharedObjectType={}))[Q.Unknown=0]="Unknown",Q[Q.File=1]="File",Q[Q.Folder=2]="Folder",Q[Q.Item=3]="Item",Q[Q.List=4]="List",Q[Q.Web=5]="Web",Q[Q.Max=6]="Max",(J=e.SharingDomainRestrictionMode||(e.SharingDomainRestrictionMode={}))[J.None=0]="None",J[J.AllowList=1]="AllowList",J[J.BlockList=2]="BlockList",(W=e.RenderListDataOptions||(e.RenderListDataOptions={}))[W.None=0]="None",W[W.ContextInfo=1]="ContextInfo",W[W.ListData=2]="ListData",W[W.ListSchema=4]="ListSchema",W[W.MenuView=8]="MenuView",W[W.ListContentType=16]="ListContentType",W[W.FileSystemItemId=32]="FileSystemItemId",W[W.ClientFormSchema=64]="ClientFormSchema",W[W.QuickLaunch=128]="QuickLaunch",W[W.Spotlight=256]="Spotlight",W[W.Visualization=512]="Visualization",W[W.ViewMetadata=1024]="ViewMetadata",W[W.DisableAutoHyperlink=2048]="DisableAutoHyperlink",W[W.EnableMediaTAUrls=4096]="EnableMediaTAUrls",W[W.ParentInfo=8192]="ParentInfo",W[W.PageContextInfo=16384]="PageContextInfo",W[W.ClientSideComponentManifest=32768]="ClientSideComponentManifest",(G=e.FieldUserSelectionMode||(e.FieldUserSelectionMode={}))[G.PeopleAndGroups=1]="PeopleAndGroups",G[G.PeopleOnly=0]="PeopleOnly",(K=e.ChoiceFieldFormatType||(e.ChoiceFieldFormatType={}))[K.Dropdown=0]="Dropdown",K[K.RadioButtons=1]="RadioButtons";var ne,re,oe,ie,se=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),Object.defineProperty(r.prototype,"roleAssignments",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new _(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),r.prototype.getUserEffectivePermissions=function(e){var t=this.clone(T,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},r.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new _("_api/web","currentuser").select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},r.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(r,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},r.prototype.resetRoleInheritance=function(){return this.clone(r,"resetroleinheritance").postCore()},r.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},r.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},r.prototype.hasPermissions=function(t,n){if(!n)return!0;if(n===e.PermissionKind.FullMask)return 32767==(32767&t.High)&&65535===t.Low;var r=1;return(n-=1)>=0&&n<32?(r<<=n,0!=(t.Low&r)):n>=32&&n<64&&(r<<=n-32,0!=(t.High&r))},r}(_),ae=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null;return this.clone(o,"shareLink").postCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},o.prototype.shareWith=function(t,r,i,s,a){var u=this;void 0===i&&(i=!1),void 0===s&&(s=!1),Array.isArray(t)||(t=[t]);var l=JSON.stringify(t.map(function(e){return{Key:e}})),p=r===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new x("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var t={includeAnonymousLinkInEmail:i,peoplePickerInput:l,propagateAcl:s,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==a&&(t=n.Util.extend(t,{emailBody:a.body,emailSubject:void 0!==a.subject?a.subject:"",sendEmail:!0})),u.clone(o,"shareObject").postCore({body:JSON.stringify(t)})})},o.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=n.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=n.Util.extend(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(o)}))},o.prototype.unshareObjectWeb=function(e){return this.clone(o,"unshareObject").postCore({body:JSON.stringify({url:e})})},o.prototype.checkPermissions=function(e){return this.clone(o,"checkPermissions").postCore({body:JSON.stringify({recipients:e})})},o.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(o,"getSharingInformation").postCore({body:JSON.stringify({request:e})})},o.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(o,"getObjectSharingSettings").postCore({body:JSON.stringify({useSimplifiedRoles:e})})},o.prototype.unshareObject=function(){return this.clone(o,"unshareObject").postCore()},o.prototype.deleteLinkByKind=function(e){return this.clone(o,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},o.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(o,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:t})})},o.prototype.getRoleValue=function(t,n){if(void 0===n||null===n){var r=t===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new x("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+r).get().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(n){case e.RoleType.Contributor:return new _("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case e.RoleType.Reader:case e.RoleType.Guest:return new _("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},o.prototype.getShareObjectWeb=function(e){return Promise.resolve(new _(i(e),"/_api/SP.Web.ShareObject"))},o.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(t){return t.expand("UsersWithAccessRequests","GroupsSharedWith").as(o).postCore({body:JSON.stringify(e)})})},o}(T),ue=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.shareWith=function(t,r,o){var s=this;void 0===r&&(r=e.SharingRole.View);var a=this.addBatchDependency();return new _(i(this.toUrl()),"/_api/web/url").get().then(function(e){return a(),s.shareObject(n.Util.combinePaths(e,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),t,r,o)})},o.prototype.shareObject=function(e,t,n,r,o,i,s,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),this.clone(ae,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:a})},o.prototype.shareObjectRaw=function(e){return this.clone(ae,null).shareObject(e,!0)},o.prototype.unshareObject=function(e){return this.clone(ae,null).unshareObjectWeb(e)},o}(se),le=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){return void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null),this.clone(ae,null).getShareLink(t,n)},r.prototype.shareWith=function(t,n,r,o){return void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),this.clone(ae,null).shareWith(t,n,r,!1,o)},r.prototype.checkSharingPermissions=function(e){return this.clone(ae,null).checkPermissions(e)},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(ae,null).getSharingInformation(e)},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(ae,null).getObjectSharingSettings(e)},r.prototype.unshare=function(){return this.clone(ae,null).unshareObject()},r.prototype.deleteSharingLinkByKind=function(e){return this.clone(ae,null).deleteLinkByKind(e)},r.prototype.unshareLink=function(e,t){return this.clone(ae,null).unshareLink(e,t)},r}(se),pe=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null);var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.getShareLink(t,n)})},r.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},r.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getSharingInformation(e)})},r.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},r.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},r.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},r.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},r.prototype.getShareable=function(){var e=this;return this.clone(ce,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var n=new ae(f(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},r}(_),ce=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(e){return i(),e.shareWith(t,n,r,!1,o)})},r}(pe),de=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o,i){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),void 0===o&&(o=!1);var s=this.addBatchDependency();return this.getShareable().then(function(e){return s(),e.shareWith(t,n,r,o,i)})},r}(pe),he=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webparts",{get:function(){return new fe(this,"webparts")},enumerable:!0,configurable:!0}),n.prototype.export=function(e){return this.clone(n,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},n.prototype.import=function(e){return this.clone(n,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},n}(T),fe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){return new ye(this,"getbyid('"+e+"')")},n.prototype.getByControlId=function(e){return new ye(this,"getByControlId('"+e+"')")},n}(x),ye=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webpart",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),n.prototype.saveChanges=function(){return this.clone(n,"SaveWebPartChanges").postCore()},n.prototype.moveTo=function(e,t){return this.clone(n,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")").postCore()},n.prototype.close=function(){return this.clone(n,"CloseWebPart").postCore()},n.prototype.open=function(){return this.clone(n,"OpenWebPart").postCore()},n.prototype.delete=function(){return this.clone(n,"DeleteWebPart").postCore()},n}(_),ge=function(e){function n(t,n){return void 0===n&&(n="webpart"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_),me=function(e){function n(t,n){return void 0===n&&(n="folders"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new be(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},n}(x),be=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return new x(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"files",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new x(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return new r(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return new _(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return new T(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return new x(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new ke(f(e)),e)})},r}(de),ve=function(e){function r(t,n){return void 0===n&&(n="contenttypes"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new Pe(this);return t.concat("('"+e+"')"),t},r.prototype.addAvailableContentType=function(e){var t=this,n=JSON.stringify({contentTypeId:e});return this.clone(r,"addAvailableContentType").postCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},r.prototype.add=function(e,t,r,o,i){var s=this;void 0===r&&(r=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var a=JSON.stringify(n.Util.extend({Description:r,Group:o,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:a}).then(function(e){return{contentType:s.getById(e.id),data:e}})},r}(x),Pe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"fieldLinks",{get:function(){return new we(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fields",{get:function(){return new x(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new n(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"workflowAssociations",{get:function(){return new x(this,"workflowAssociations")},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(_),we=function(e){function n(t,n){return void 0===n&&(n="fieldlinks"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ce(this);return t.concat("(guid'"+e+"')"),t},n}(x),Ce=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(_),Se=function(e){function n(t,n){return void 0===n&&(n="AttachmentFiles"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new Te(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},n.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},n.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},n}(x),Te=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getText=function(){return this.getParsed(new o.TextParser)},n.prototype.getBlob=function(){return this.getParsed(new o.BlobParser)},n.prototype.getBuffer=function(){return this.getParsed(new o.BufferParser)},n.prototype.getJSON=function(){return this.getParsed(new o.JSONParser)},n.prototype.setContent=function(e){var t=this;return this.clone(n,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new n(t)})},n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n.prototype.getParsed=function(e){return this.clone(n,"$value",!1).get(e)},n}(_),xe=function(e){function r(t,n){return void 0===n&&(n="views"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new _e(this);return t.concat("('"+e+"')"),t},r.prototype.getByTitle=function(e){return new _e(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,t,o){var i=this;void 0===t&&(t=!1),void 0===o&&(o={});var s=JSON.stringify(n.Util.extend({PersonalView:t,Title:e,__metadata:{type:"SP.View"}},o));return this.clone(r,null).postCore({body:s}).then(function(e){return{data:e,view:i.getById(e.Id)}})},r}(x),_e=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return new Ie(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.renderAsHtml=function(){return this.clone(T,"renderashtml").get()},r}(_),Ie=function(e){function n(t,n){return void 0===n&&(n="viewfields"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getSchemaXml=function(){return this.clone(T,"schemaxml").get()},n.prototype.add=function(e){return this.clone(n,"addviewfield('"+e+"')").postCore()},n.prototype.move=function(e,t){return this.clone(n,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:t})})},n.prototype.removeAll=function(){return this.clone(n,"removeallviewfields").postCore()},n.prototype.remove=function(e){return this.clone(n,"removeviewfield('"+e+"')").postCore()},n}(x),Oe=function(r){function o(e,t){return void 0===t&&(t="fields"),r.call(this,e,t)||this}return t.__extends(o,r),o.prototype.getByTitle=function(e){return new Ue(this,"getByTitle('"+e+"')")},o.prototype.getByInternalNameOrTitle=function(e){return new Ue(this,"getByInternalNameOrTitle('"+e+"')")},o.prototype.getById=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},o.prototype.createFieldAsXml=function(e){var t,r=this;t="string"==typeof e?{SchemaXml:e}:e;var i=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},t)});return this.clone(o,"createfieldasxml").postCore({body:i}).then(function(e){return{data:e,field:r.getById(e.Id)}})},o.prototype.add=function(e,t,r){var i=this,s=JSON.stringify(n.Util.extend({Title:e,__metadata:{type:t}},r));return this.clone(o,null).postCore({body:s}).then(function(e){return{data:e,field:i.getById(e.Id)}})},o.prototype.addText=function(e,t,r){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",n.Util.extend(o,r))},o.prototype.addCalculated=function(t,r,o,i,s){void 0===i&&(i=e.FieldTypes.Text);var a={DateFormat:o,FieldTypeKind:17,Formula:r,OutputType:i};return this.add(t,"SP.FieldCalculated",n.Util.extend(a,s))},o.prototype.addDateTime=function(t,r,o,i,s){void 0===r&&(r=e.DateTimeFieldFormatType.DateOnly),void 0===o&&(o=e.CalendarType.Gregorian),void 0===i&&(i=0);var a={DateTimeCalendarType:o,DisplayFormat:r,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(t,"SP.FieldDateTime",n.Util.extend(a,s))},o.prototype.addNumber=function(e,t,r,o){var i={FieldTypeKind:9};return void 0!==t&&(i=n.Util.extend({MinimumValue:t},i)),void 0!==r&&(i=n.Util.extend({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",n.Util.extend(i,o))},o.prototype.addCurrency=function(e,t,r,o,i){void 0===o&&(o=1033);var s={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(s=n.Util.extend({MinimumValue:t},s)),void 0!==r&&(s=n.Util.extend({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",n.Util.extend(s,i))},o.prototype.addMultilineText=function(e,t,r,o,i,s,a){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!0);var u={AllowHyperlink:s,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:r};return this.add(e,"SP.FieldMultiLineText",n.Util.extend(u,a))},o.prototype.addUrl=function(t,r,o){void 0===r&&(r=e.UrlFieldFormatType.Hyperlink);var i={DisplayFormat:r,FieldTypeKind:11};return this.add(t,"SP.FieldUrl",n.Util.extend(i,o))},o.prototype.addUser=function(e,t,r){var o={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",n.Util.extend(o,r))},o.prototype.addLookup=function(e,t,r,i){var s=this,a=JSON.stringify({parameters:n.Util.extend({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e,__metadata:{type:"SP.FieldCreationInformation"}},i)});return this.clone(o,"addfield").postCore({body:a}).then(function(e){return{data:e,field:s.getById(e.Id)}})},o.prototype.addChoice=function(t,r,o,i,s){void 0===o&&(o=e.ChoiceFieldFormatType.Dropdown);var a={Choices:{results:r},EditFormat:o,FieldTypeKind:6,FillInChoice:i};return this.add(t,"SP.FieldChoice",n.Util.extend(a,s))},o.prototype.addMultiChoice=function(e,t,r,o){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",n.Util.extend(i,o))},o.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",n.Util.extend({FieldTypeKind:8},t))},o}(x),Ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var o=JSON.stringify(n.Util.extend({__metadata:{type:t}},e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.setShowInDisplayForm=function(e){return this.clone(r,"setshowindisplayform("+e+")").postCore()},r.prototype.setShowInEditForm=function(e){return this.clone(r,"setshowineditform("+e+")").postCore()},r.prototype.setShowInNewForm=function(e){return this.clone(r,"setshowinnewform("+e+")").postCore()},r}(_),De=function(e){function n(t,n){return void 0===n&&(n="forms"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Re(this);return t.concat("('"+e+"')"),t},n}(x),Re=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(_),Fe=function(e){function n(t,n){return void 0===n&&(n="subscriptions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Le(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,n){var r=this,o=JSON.stringify({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},n}(x),Le=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.update=function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patchCore({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},n.prototype.delete=function(){return e.prototype.deleteCore.call(this)},n}(_),Be=function(e){function r(t,n){return void 0===n&&(n="usercustomactions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new Ne(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},r.prototype.clear=function(){return this.clone(r,"clear").postCore()},r}(x),Ne=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(_),Ee=function(e){function r(t,n){return void 0===n&&(n="lists"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getByTitle=function(e){return new je(this,"getByTitle('"+e+"')")},r.prototype.getById=function(e){var t=new je(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,r,o,i){var s=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={});var a=n.Util.extend({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:s.getByTitle(a.Title)}})},r.prototype.ensure=function(e,t,r,o,i){var s=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw new l("The ensure list method");return new Promise(function(a,u){var l=n.Util.extend(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),p=s.getByTitle(l.Title);p.get().then(function(e){p.update(l).then(function(e){a({created:!1,data:e,list:s.getByTitle(l.Title)})}).catch(function(e){return u(e)})}).catch(function(n){s.add(e,t,r,o,l).then(function(e){a({created:!0,data:e.data,list:s.getByTitle(l.Title)})}).catch(function(e){return u(e)})})})},r.prototype.ensureSiteAssetsLibrary=function(){return this.clone(r,"ensuresiteassetslibrary").postCore().then(function(e){return new je(c(e))})},r.prototype.ensureSitePagesLibrary=function(){return this.clone(r,"ensuresitepageslibrary").postCore().then(function(e){return new je(c(e))})},r}(x),je=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"views",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"forms",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"defaultView",{get:function(){return new _e(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return new x(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return new T(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return new T(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscriptions",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new be(this,"rootFolder")},enumerable:!0,configurable:!0}),r.prototype.getView=function(e){return new _e(this,"getView('"+e+"')")},r.prototype.update=function(e,t){var o=this;void 0===t&&(t="*");var i=JSON.stringify(n.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(function(t){var n=o;return e.hasOwnProperty("Title")&&(n=o.getParent(r,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:t,list:n}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getChanges=function(e){return this.clone(r,"getchanges").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},r.prototype.getItemsByCAMLQuery=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.clone(r,"getitems");return i.expand.apply(i,t).postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},r.prototype.getListItemChangesSinceToken=function(e){return this.clone(r,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},r.prototype.renderListData=function(e){var t=this.clone(r,"renderlistdata(@viewXml)");return t.query.add("@viewXml","'"+e+"'"),t.postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("RenderListData")?e.RenderListData:e})},r.prototype.renderListDataAsStream=function(e,t){void 0===t&&(t=null);var o={overrideParameters:n.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},t),parameters:n.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(r,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(o)})},r.prototype.renderListFormData=function(e,t,n){return this.clone(r,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("ListData")?e.ListData:e})},r.prototype.reserveListItemId=function(){return this.clone(r,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(r,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},r}(se),Ae=function(e){function o(t,n){return void 0===n&&(n="items"),e.call(this,t,n)||this}return t.__extends(o,e),o.prototype.getById=function(e){var t=new ke(this);return t.concat("("+e+")"),t},o.prototype.getItemByStringId=function(e){return new ke(this.parentUrl,"getItemByStringId('"+e+"')")},o.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},o.prototype.getPaged=function(){return this.get(new Ve)},o.prototype.getAll=function(e){var t=this;void 0===e&&(e=2e3),r.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var n=new o(this,"").top(e).configure({headers:{Accept:"application/json;odata=nometadata"}});return this.query.getKeys().filter(function(e){return/^\$select$|^\$filter$|^\$top$/.test(e.toLowerCase())}).reduce(function(e,n){return e.query.add(n,t.query.get(n)),e},n),new Promise(function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)})},o.prototype.add=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var s=JSON.stringify(n.Util.extend({__metadata:{type:t}},e)),a=r.clone(o,null).postCore({body:s}).then(function(e){return{data:e,item:r.getById(e.Id)}});return i(),a})},o.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(je).getListItemEntityTypeFullName()},o}(x),ke=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"attachmentFiles",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentType",{get:function(){return new Pe(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return new T(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return new _(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return new _(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return new _(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folder",{get:function(){return new be(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"file",{get:function(){return new We(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return new Me(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e,t,r){var o=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(i,s){var a=o.addBatchDependency();return o.ensureListItemEntityTypeName(r).then(function(r){var s=JSON.stringify(n.Util.extend({__metadata:{type:r}},e));return a(),o.postCore({body:s,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new Qe).then(function(e){i({data:e,item:o})})}).catch(function(e){return s(e)})})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(r,"getWOPIFrameUrl(@action)");return t._query.add("@action",e),t.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},r.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(r,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:t})})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(je,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},r}(le),Me=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new qe(this);return t.concat("("+e+")"),t},n}(x),qe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(_),He=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Ae(this.nextUrl,null).getPaged():new Promise(function(e){return e(null)})},e}(),Ve=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];n(new He(r,t.parseODataJSON(e)))})})},n}(o.ODataParserBase),Qe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})},n}(o.ODataParserBase),Je=function(e){function n(t,n){return void 0===n&&(n="files"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new We(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},n.prototype.addChunked=function(e,t,r,o,i){var s=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return s.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)})},n.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},n}(x),We=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(i,r),Object.defineProperty(i.prototype,"listItemAllFields",{get:function(){return new x(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"versions",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),i.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(i,"approve(comment='"+e+"')").postCore()},i.prototype.cancelUpload=function(e){return this.clone(i,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},i.prototype.checkin=function(t,n){if(void 0===t&&(t=""),void 0===n&&(n=e.CheckinType.Major),t.length>1023)throw new u;return this.clone(i,"checkin(comment='"+t+"',checkintype="+n+")").postCore()},i.prototype.checkout=function(){return this.clone(i,"checkout").postCore()},i.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(i,"copyTo(strnewurl='"+e+"',boverwrite="+t+")").postCore()},i.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(i,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},i.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"deny(comment='"+e+"')").postCore()},i.prototype.getLimitedWebPartManager=function(t){return void 0===t&&(t=e.WebPartsPersonalizationScope.Shared),new he(this,"getLimitedWebPartManager(scope="+t+")")},i.prototype.moveTo=function(t,n){return void 0===n&&(n=e.MoveOperations.Overwrite),this.clone(i,"moveTo(newurl='"+t+"',flags="+n+")").postCore()},i.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"publish(comment='"+e+"')").postCore()},i.prototype.recycle=function(){return this.clone(i,"recycle").postCore()},i.prototype.undoCheckout=function(){return this.clone(i,"undoCheckout").postCore()},i.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"unpublish(comment='"+e+"')").postCore()},i.prototype.getText=function(){return this.clone(i,"$value",!1).get(new o.TextParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBlob=function(){return this.clone(i,"$value",!1).get(new o.BlobParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBuffer=function(){return this.clone(i,"$value",!1).get(new o.BufferParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getJSON=function(){return this.clone(i,"$value",!1).get(new o.JSONParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.setContent=function(e){var t=this;return this.clone(i,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new i(t)})},i.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new ke(f(e)),e)})},i.prototype.setContentChunked=function(e,t,r){var o=this;void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var i=e.size,s=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),a=n.Util.getGUID();t({blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:s});for(var u=this.startUpload(a,e.slice(0,r)),l=function(n){u=u.then(function(u){return t({blockNumber:n,chunkSize:r,currentPointer:u,fileSize:i,stage:"continue",totalBlocks:s}),o.continueUpload(a,u,e.slice(u,u+r))})},p=2;p<s;p++)l(p);return u.then(function(n){return t({blockNumber:s,chunkSize:r,currentPointer:n,fileSize:i,stage:"finishing",totalBlocks:s}),o.finishUpload(a,n,e.slice(n))})},i.prototype.startUpload=function(e,t){return this.clone(i,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:t}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},i.prototype.continueUpload=function(e,t,n){return this.clone(i,"continueUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},i.prototype.finishUpload=function(e,t,n){return this.clone(i,"finishUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return{data:e,file:new i(e.ServerRelativeUrl)}})},i}(ce),Ge=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ke(this);return t.concat("("+e+")"),t},n.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},n.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},n.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},n.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},n.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},n.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()},n}(x),Ke=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n}(_);(ne=e.CheckinType||(e.CheckinType={}))[ne.Minor=0]="Minor",ne[ne.Major=1]="Major",ne[ne.Overwrite=2]="Overwrite",(re=e.WebPartsPersonalizationScope||(e.WebPartsPersonalizationScope={}))[re.User=0]="User",re[re.Shared=1]="Shared",(oe=e.MoveOperations||(e.MoveOperations={}))[oe.Overwrite=1]="Overwrite",oe[oe.AllowBrokenThickets=8]="AllowBrokenThickets",(ie=e.TemplateFileType||(e.TemplateFileType={}))[ie.StandardPage=0]="StandardPage",ie[ie.WikiPage=1]="WikiPage",ie[ie.FormPage=2]="FormPage",ie[ie.ClientSidePage=3]="ClientSidePage";var Xe=function(e){function n(t,n){void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps");var r="";return"string"==typeof t?r=t:void 0!==t&&(r=t.toUrl()),e.call(this,i(r),n)||this}return t.__extends(n,e),n.prototype.getAppById=function(e){return new ze(this,"getById('"+e+"')")},n.prototype.add=function(e,t,r){return void 0===r&&(r=!0),new n(i(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(e){return{data:e,file:new We(c(e))}})},n}(x),ze=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deploy=function(){return this.clone(n,"Deploy").postCore()},n.prototype.retract=function(){return this.clone(n,"Retract").postCore()},n.prototype.install=function(){return this.clone(n,"Install").postCore()},n.prototype.uninstall=function(){return this.clone(n,"Uninstall").postCore()},n.prototype.upgrade=function(){return this.clone(n,"Upgrade").postCore()},n.prototype.remove=function(){return this.clone(n,"Remove").postCore()},n}(_);function $e(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function Ze(e,t){void 0===t&&(t=0);var n=this.substring(t).search(e);return n>=0?n+t:n}function Ye(e,t){var n=new RegExp(t+'="([^"]*?)"',"i").exec(e);return n.length>0?n[1]:null}function et(e,t,n){var r=[];if(void 0===e||null===e)return r;var o=e.replace(/[\t\r\n]/g,""),i=Ze.call(o,t);if(i<0)return r;for(;i>-1;){for(var s=1,a=i+1,u=-1,l=-1;;){if(u=Ze.call(o,/<div[^>]*>/i,a),l=Ze.call(o,/<\/div>/i,a),u<0&&(u=o.length+1),u<l?(s++,a=u+1):l<u&&(s--,a=l+1),0===s){var p=o.substring(i,l+6).trim();r.push(n(p));break}if(s>1e3||s<0)throw new Error("getBoundedDivMarkup exceeded depth parameters.")}i=Ze.call(o,t,l)}return r}function tt(e){for(var t=0;t<e.length;t++)e[t].order=t+1,e[t].hasOwnProperty("columns")?tt(e[t].columns):e[t].hasOwnProperty("controls")&&tt(e[t].controls)}var nt,rt,ot,it=function(r){function o(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=!1);var o=r.call(this,e)||this;return o.sections=t,o.commentsDisabled=n,o}return t.__extends(o,r),o.create=function(t,r,i,s){return void 0===s&&(s="Article"),t.rootFolder.files.select("Name").filter("Name eq '"+r+"'").get().then(function(a){if(a.length>0)throw new Error("A file with the name '"+r+"' already exists in the library '"+t.toUrl()+"'.");return t.rootFolder.select("ServerRelativePath").get().then(function(a){var u=n.Util.combinePaths("/",a.ServerRelativePath.DecodedUrl,r);return t.rootFolder.files.addTemplateFile(u,e.TemplateFileType.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:s,PromotedState:0,Title:i}).then(function(e){return new o(e.item.file,e.item.CommentsDisabled)})})})})})},o.fromFile=function(e){var t=new o(e);return t.load().then(function(e){return t})},o.jsonToEscapedString=function(e){return JSON.stringify(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")},o.escapedStringToJson=function(e){return JSON.parse(e.replace(/&quot;/g,'"').replace(/&#58;/g,":").replace(/&#123;/g,"{").replace(/&#125;/g,"}"))},o.prototype.addSection=function(){var e=new st(this,$e(this.sections));return this.sections.push(e),e},o.prototype.toHtml=function(){tt(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},o.prototype.fromHtml=function(e){var t=this;return this.sections=[],et(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var n=/controlType&quot;&#58;(\d*?),/i.exec(e),r=null;switch(null==n||n.length<2?0:parseInt(n[1],10)){case 0:(r=new ut(null,0)).fromHtml(e),t.mergeColumnToTree(r);break;case 3:(r=new pt("")).fromHtml(e),t.mergeControlToTree(r);break;case 4:(r=new lt).fromHtml(e),t.mergeControlToTree(r)}}),tt(this.sections),this},o.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},o.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},o.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},o.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},o.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},o.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},o.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new ke(t,"SetCommentsDisabled("+!e+")").update({})})},o.prototype.mergeControlToTree=function(e){var t=null,n=null,r=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});r.length<1?(t=new st(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0];var o=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});o.length<1?(n=new ut(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(n)):n=o[0],e.column=n,n.addControl(e)},o.prototype.mergeColumnToTree=function(e){var t=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new st(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0],e.section=t,t.columns.push(e)},o.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(n){return n.update(e,t)})},o}(We),st=function(){function e(e,t,n){void 0===n&&(n=[]),this.page=e,this.order=t,this.columns=n}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new ut(this,$e(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e}(),at=function(){function e(e,t,r,o,i,s){void 0===r&&(r=null),void 0===o&&(o=1),void 0===i&&(i=n.Util.getGUID()),void 0===s&&(s=null),this.controlType=e,this.dataVersion=t,this.column=r,this.order=o,this.id=i,this.controlData=s}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return it.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=it.escapedStringToJson(Ye(e,"data-sp-controldata")),this.dataVersion=Ye(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}(),ut=function(e){function n(t,n,r,o,i){void 0===r&&(r=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var s=e.call(this,0,i)||this;return s.section=t,s.order=n,s.factor=r,s.controls=o,s}return t.__extends(n,e),n.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},n.prototype.getControl=function(e){return this.controls[e]},n.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},n.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=it.escapedStringToJson(Ye(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},n.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},n}(at),lt=function(e){function n(t){void 0===t&&(t="");var n=e.call(this,4,"1.0")||this;return n.text=t,n}return t.__extends(n,e),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),n.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},n.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},n.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>/i.exec(t);this.text=n.length>1?n[1]:""},n}(at),pt=function(e){function n(t,n,r,o,i,s){void 0===n&&(n=""),void 0===r&&(r={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===s&&(s=null);var a=e.call(this,3,"1.0")||this;return a.title=t,a.description=n,a.propertieJson=r,a.webPartId=o,a.htmlProperties=i,a.serverProcessedContent=s,a}return t.__extends(n,e),n.fromComponentDef=function(e){var t=new n("");return t.import(e),t},n.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"");var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},n.prototype.setProperties=function(e){return this.propertieJson=e,this},n.prototype.getProperties=function(){return this.propertieJson},n.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,title:this.title},n=[];return n.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),n.push('<div data-sp-webpart="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+it.jsonToEscapedString(t)+'">'),n.push("<div data-sp-componentid>"),n.push(this.webPartId),n.push("</div>"),n.push('<div data-sp-htmlproperties="">'),n.push(this.renderHtmlProperties()),n.push("</div>"),n.push("</div>"),n.push("</div>"),n.join("")},n.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=it.escapedStringToJson(Ye(t,"data-sp-webpartdata"));this.title=n.title,this.description=n.description,this.webPartId=n.id,this.setProperties(n.properties),void 0!==n.serverProcessedContent&&(this.serverProcessedContent=n.serverProcessedContent);var r=et(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=r.length>0?r[0]:""},n.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},n.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=0;t<this.serverProcessedContent.searchablePlainTexts.length;t++){var n=this.serverProcessedContent.searchablePlainTexts[t];e.push('<div data-sp-prop-name="'+n.Name+'" data-sp-searchableplaintext="true">'),e.push(n.Value),e.push("</div>")}if(void 0!==this.serverProcessedContent.imageSources)for(t=0;t<this.serverProcessedContent.imageSources.length;t++){n=this.serverProcessedContent.imageSources[t];e.push('<img data-sp-prop-name="'+n.Name+'" src="'+n.Value+'" />')}if(void 0!==this.serverProcessedContent.links)for(t=0;t<this.serverProcessedContent.links.length;t++){n=this.serverProcessedContent.links[t];e.push('<a data-sp-prop-name="'+n.Name+'" href="'+n.Value+'"></a>')}}return e.join("")},n.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},n}(at),ct=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new dt(this);return t.concat("("+e+")"),t},n.prototype.add=function(e,t,r){var o=this;void 0===r&&(r=!0);var i=JSON.stringify({IsVisible:r,Title:e,Url:t,__metadata:{type:"SP.NavigationNode"}});return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},n.prototype.moveAfter=function(e,t){var r=JSON.stringify({nodeId:e,previousNodeId:t});return this.clone(n,"MoveAfter").postCore({body:r})},n}(x),dt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"children",{get:function(){return new ct(this,"Children")},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return e.prototype.deleteCore.call(this)},n}(_),ht=function(e){function n(t,n){return void 0===n&&(n="navigation"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"quicklaunch",{get:function(){return new ct(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topNavigationBar",{get:function(){return new ct(this,"topnavigationbar")},enumerable:!0,configurable:!0}),n}(T),ft=function(e){function n(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return t.__extends(n,e),n.prototype.getMenuState=function(e,t,r,o){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===r&&(r=null),void 0===o&&(o=null),new n("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:t,mapProviderName:r,menuNodeKey:e})})},n.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),new n("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:t})})},n}(T),yt=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,n){return void 0===t&&(t=""),void 0===n&&(n={}),new e(t,n)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=n.Util.extend(this._query,e),this},e}(),gt=function(e){function r(t,n){return void 0===n&&(n="_api/search/postquery"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.execute=function(e){var t,r=this;(t=e).SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var o=JSON.stringify({request:n.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:o}).then(function(t){return new mt(t,r.toUrl(),e)})},r.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},r}(_),mt=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,o=n.Util.extend(this._query,{RowLimit:r,StartRow:r*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new gt(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();(nt=e.SortDirection||(e.SortDirection={}))[nt.Ascending=0]="Ascending",nt[nt.Descending=1]="Descending",nt[nt.FQLFormula=2]="FQLFormula",(rt=e.ReorderingRuleMatchType||(e.ReorderingRuleMatchType={}))[rt.ResultContainsKeyword=0]="ResultContainsKeyword",rt[rt.TitleContainsKeyword=1]="TitleContainsKeyword",rt[rt.TitleMatchesKeyword=2]="TitleMatchesKeyword",rt[rt.UrlStartsWith=3]="UrlStartsWith",rt[rt.UrlExactlyMatches=4]="UrlExactlyMatches",rt[rt.ContentTypeIs=5]="ContentTypeIs",rt[rt.FileExtensionMatches=6]="FileExtensionMatches",rt[rt.ResultHasTag=7]="ResultHasTag",rt[rt.ManualCondition=8]="ManualCondition",(ot=e.QueryPropertyValueType||(e.QueryPropertyValueType={}))[ot.None=0]="None",ot[ot.StringType=1]="StringType",ot[ot.Int32TYpe=2]="Int32TYpe",ot[ot.BooleanType=3]="BooleanType",ot[ot.StringArrayType=4]="StringArrayType",ot[ot.UnSupportedType=5]="UnSupportedType";var bt=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),vt=function(e){function n(t,n){return void 0===n&&(n="_api/search/suggest"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new Pt(e)})},n.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},n}(_),Pt=function(){return function(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}}(),wt=function(e){function o(t){var n=e.call(this)||this;return n.baseUrl=t,n}return t.__extends(o,e),o.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],a="--batchresponse_",u=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),l=e.split("\n"),p="batch",c=0;c<l.length;++c){var d=l[c];switch(p){case"batch":if(d.substr(0,a.length)===a)p="batchHeaders";else if(""!==d.trim())throw new s("Invalid response, line "+c);break;case"batchHeaders":""===d.trim()&&(p="status");break;case"status":var h=u.exec(d);if(3!==h.length)throw new s("Invalid status, line "+c);r=parseInt(h[1],10),o=h[2],p="statusHeaders";break;case"statusHeaders":""===d.trim()&&(p="body");break;case"body":i.push(204===r?new Response:new Response(d,{status:r,statusText:o})),p="batch"}}"status"!==p&&n(new s("Unexpected end of input")),t(i)})},o.prototype.executeImpl=function(){var e=this;if(r.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return r.Logger.write("Resolving empty batch.",1),Promise.resolve();var t=new P;return w(this.baseUrl).then(function(i){for(var a=[],u="",l=0;l<e.requests.length;l++){var p=e.requests[l];"GET"===p.method?(u.length>0&&(a.push("--changeset_"+u+"--\n\n"),u=""),a.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=n.Util.getGUID(),a.push("--batch_"+e.batchId+"\n"),a.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),a.push("--changeset_"+u+"\n")),a.push("Content-Type: application/http\n"),a.push("Content-Transfer-Encoding: binary\n\n");var c=new Headers,d=n.Util.isUrlAbsolute(p.url)?p.url:n.Util.combinePaths(i,p.url);if(r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+p.method+" "+d+" to batch.",0),"GET"!==p.method){var h=p.method,f=p.options.headers;p.hasOwnProperty("options")&&p.options.hasOwnProperty("headers")&&void 0!==f["X-HTTP-Method"]&&(h=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),a.push(h+" "+d+" HTTP/1.1\n"),c.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else a.push(p.method+" "+d+" HTTP/1.1\n");n.mergeHeaders(c,g.headers),p.options&&n.mergeHeaders(c,p.options.headers),c.has("Accept")||c.append("Accept","application/json"),c.has("Content-Type")||c.append("Content-Type","application/json;odata=verbose;charset=utf-8"),c.has("X-ClientService-ClientTag")||c.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),c.forEach(function(e,t){a.push(t+": "+e+"\n")}),a.push("\n"),p.options.body&&a.push(p.options.body+"\n\n")}u.length>0&&(a.push("--changeset_"+u+"--\n\n"),u=""),a.push("--batch_"+e.batchId+"--\n");var y={body:a.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch(n.Util.combinePaths(i,"/_api/$batch"),y).then(function(e){return e.text()}).then(o.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw new s("Could not properly parse responses to match requests in batch.");return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,o){var i=e.requests[o];return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",0),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},o}(o.ODataBatch),Ct=function(e){function n(t,n){return void 0===n&&(n="features"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new St(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(n,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},n.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,"remove").postCore({body:JSON.stringify({featureId:e,force:t})})},n}(x),St=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deactivate=function(e){var t=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new n(this).select("DefinitionId").get().then(function(n){var o=t.getParent(Ct,t.parentUrl,"",t.batch).remove(n.DefinitionId,e);return r(),o})},n}(_),Tt=function(e){function n(t,n){return void 0===n&&(n="_api/SP.RelatedItemManager"),e.call(this,t,n)||this}return t.__extends(n,e),n.FromUrl=function(e){if(null===e)return new n("");var t=e.indexOf("_api/");return new n(t>-1?e.substr(0,t):e)},n.prototype.getRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.addSingleLink=function(e,t,r,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(n,null);return u.concat(".AddSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryAddReverseLink:a})})},n.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},n.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},n.prototype.deleteSingleLink=function(e,t,r,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(n,null);return u.concat(".DeleteSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryDeleteReverseLink:a})})},n}(T),xt=function(e){function n(t,n){return void 0===n&&(n="regionalsettings"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"installedLanguages",{get:function(){return new _t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"globalInstalledLanguages",{get:function(){return new _t(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZone",{get:function(){return new It(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZones",{get:function(){return new Ot(this)},enumerable:!0,configurable:!0}),n}(_),_t=function(e){function n(t,n){return void 0===n&&(n="installedlanguages"),e.call(this,t,n)||this}return t.__extends(n,e),n}(x),It=function(e){function r(t,n){return void 0===n&&(n="timezone"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(r,"utctolocaltime('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},r.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:n.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(r,"localtimetoutc('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},r}(_),Ot=function(e){function n(t,n){return void 0===n&&(n="timezones"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},y(It))},n}(x),Ut=function(e){function r(t,n){return void 0===n&&(n="webs"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e,t,o,i,s,a){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===s&&(s=1033),void 0===a&&(a=!0);var u={Description:o,Language:s,Title:e,Url:t,UseSamePermissionsAsParentSite:a,WebTemplate:i},l=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},u)});return this.clone(r,"add").postCore({body:l}).then(function(e){return{data:e,web:new Rt(c(e).replace(/_api\/web\/?/i,""))}})},r}(x),Dt=function(e){function n(t,n){return void 0===n&&(n="webinfos"),e.call(this,t,n)||this}return t.__extends(n,e),n}(x),Rt=function(e){function r(t,n){return void 0===n&&(n="_api/web"),e.call(this,t,n)||this}return t.__extends(r,e),r.fromUrl=function(e,t){return new r(i(e),t)},Object.defineProperty(r.prototype,"webs",{get:function(){return new Ut(this)},enumerable:!0,configurable:!0}),r.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Ut,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(r.prototype,"allProperties",{get:function(){return this.clone(x,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return new Dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lists",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availablefields",{get:function(){return new Oe(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"navigation",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUsers",{get:function(){return new I(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteGroups",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUserInfoList",{get:function(){return new je(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"regionalSettings",{get:function(){return new xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentUser",{get:function(){return new U(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"roleDefinitions",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedItems",{get:function(){return Tt.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new wt(this.parentUrl)},Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new be(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedOwnerGroup",{get:function(){return new z(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedMemberGroup",{get:function(){return new z(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedVisitorGroup",{get:function(){return new z(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),r.prototype.getFolderByServerRelativeUrl=function(e){return new be(this,"getFolderByServerRelativeUrl('"+e+"')")},r.prototype.getFolderByServerRelativePath=function(e){return new be(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},r.prototype.getFileByServerRelativeUrl=function(e){return new We(this,"getFileByServerRelativeUrl('"+e+"')")},r.prototype.getFileByServerRelativePath=function(e){return new We(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},r.prototype.getList=function(e){return new je(this,"getList('"+e+"')")},r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r.prototype.applyTheme=function(e,t,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(r,"applytheme").postCore({body:i})},r.prototype.applyWebTemplate=function(e){var t=this.clone(r,"applywebtemplate");return t.concat("(@t)"),t.query.add("@t",e),t.postCore()},r.prototype.ensureUser=function(e){var t=JSON.stringify({logonName:e});return this.clone(r,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new O(c(e))}})},r.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new x(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},r.prototype.getCatalog=function(e){return this.clone(r,"getcatalog("+e+")").select("Id").get().then(function(e){return new je(c(e))})},r.prototype.getChanges=function(e){var t=JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(r,"getchanges").postCore({body:t})},Object.defineProperty(r.prototype,"customListTemplate",{get:function(){return new x(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),r.prototype.getUserById=function(e){return new O(this,"getUserById("+e+")")},r.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(r,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},r.prototype.getStorageEntity=function(e){return this.clone(r,"getStorageEntity('"+e+"')").get()},r.prototype.getAppCatalog=function(e){return new Xe(e||this)},r.prototype.getClientSideWebParts=function(){return this.clone(x,"GetClientSideWebParts").get()},r.prototype.addClientSidePage=function(e,t,n){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),void 0===n&&(n="Site Pages"),it.create(this.lists.getByTitle(n),e,t)},r}(ue),Ft=function(e){function n(t,n){return void 0===n&&(n="_api/site"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"rootWeb",{get:function(){return new Rt(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"features",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),n.prototype.getContextInfo=function(){return new n(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},n.prototype.getDocumentLibraries=function(e){var t=new T("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},n.prototype.getWebUrlFromPageUrl=function(e){var t=new T("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},n.prototype.createBatch=function(){return new wt(this.parentUrl)},n.prototype.openWebById=function(e){return this.clone(n,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Rt.fromUrl(c(e))}})},n}(_),Lt=function(e){function r(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.profileLoader=new Bt(t),r}return t.__extends(r,e),Object.defineProperty(r.prototype,"editProfileLink",{get:function(){return this.clone(r,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(r,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),r.prototype.amIFollowedBy=function(e){var t=this.clone(r,"amifollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.amIFollowing=function(e){var t=this.clone(r,"amifollowing(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(r,"getfollowedtags("+e+")").get()},r.prototype.getFollowersFor=function(e){var t=this.clone(r,"getfollowersfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"myFollowers",{get:function(){return new x(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"myProperties",{get:function(){return new r(this,"getmyproperties")},enumerable:!0,configurable:!0}),r.prototype.getPeopleFollowedBy=function(e){var t=this.clone(r,"getpeoplefollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getPropertiesFor=function(e){var t=this.clone(r,"getpropertiesfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"trendingTags",{get:function(){var e=this.clone(r,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),r.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(r,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},r.prototype.hideSuggestion=function(e){var t=this.clone(r,"hidesuggestion(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},r.prototype.isFollowing=function(e,t){var n=this.clone(r,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(t)+"'"),n.get()},r.prototype.setMyProfilePic=function(e){var t=this;return new Promise(function(o,i){n.readBlobAsArrayBuffer(e).then(function(e){new r(t,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return o()})}).catch(function(e){return i(e)})})},r.prototype.setSingleValueProfileProperty=function(e,t,n){var o=JSON.stringify({accountName:e,propertyName:t,propertyValue:n});return this.clone(r,"SetSingleValueProfileProperty").postCore({body:o})},r.prototype.setMultiValuedProfileProperty=function(e,t,n){var o=JSON.stringify({accountName:e,propertyName:t,propertyValues:n});return this.clone(r,"SetMultiValuedProfileProperty").postCore({body:o})},r.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},r.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},r}(_),Bt=function(e){function n(t,n){return void 0===n&&(n="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(n.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(n,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userProfile",{get:function(){return this.clone(n,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),n.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},n.prototype.shareAllSocialData=function(e){return this.clone(n,"getuserprofile/shareallsocialdata("+e+")").postCore()},n}(T),Nt=function(e){function r(t,n){return void 0===n&&(n="_api/social.following"),e.call(this,t,n)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"my",{get:function(){return new Et(this)},enumerable:!0,configurable:!0}),r.prototype.getFollowedSitesUri=function(){return this.clone(r,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},r.prototype.getFollowedDocumentsUri=function(){return this.clone(r,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},r.prototype.follow=function(e){return this.clone(r,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.isFollowed=function(e){return this.clone(r,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.stopFollowing=function(e){return this.clone(r,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.createSocialActorInfoRequestBody=function(e){return JSON.stringify({actor:n.Util.extend({Id:null,__metadata:{type:"SP.Social.SocialActorInfo"}},e)})},r}(_),Et=function(e){function n(t,n){return void 0===n&&(n="my"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.followed=function(e){return this.clone(n,"followed(types="+e+")").get().then(function(e){return e.hasOwnProperty("Followed")?e.Followed.results:e})},n.prototype.followedCount=function(e){return this.clone(n,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},n.prototype.followers=function(){return this.clone(n,"followers").get().then(function(e){return e.hasOwnProperty("Followers")?e.Followers.results:e})},n.prototype.suggestions=function(){return this.clone(n,"suggestions").get().then(function(e){return e.hasOwnProperty("Suggestions")?e.Suggestions.results:e})},n}(_),jt=function(e){function r(t,n){return e.call(this,r.getBaseUrl(t),"_api/SP.Utilities.Utility."+n)||this}return t.__extends(r,e),r.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},r.prototype.excute=function(e){return this.postCore({body:JSON.stringify(e)})},r.prototype.sendEmail=function(e){var t={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(t.properties=n.Util.extend(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=n.Util.extend(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=n.Util.extend(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=n.Util.extend(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(r,"SendEmail",!0).excute(t)},r.prototype.getCurrentUserEmailAddresses=function(){return this.clone(r,"GetCurrentUserEmailAddresses",!0).excute({})},r.prototype.resolvePrincipal=function(e,t,n,o,i,s){void 0===s&&(s=!1);var a={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:s,scopes:t,sources:n};return this.clone(r,"ResolvePrincipalInCurrentContext",!0).excute(a)},r.prototype.searchPrincipals=function(e,t,n,o,i){var s={groupName:o,input:e,maxCount:i,scopes:t,sources:n};return this.clone(r,"SearchPrincipalsUsingContextWeb",!0).excute(s)},r.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.clone(r,"CreateEmailBodyForInvitation",!0).excute(t)},r.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t};return this.clone(r,"ExpandGroupsToPrincipals",!0).excute(n)},r.prototype.createWikiPage=function(e){return this.clone(r,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new We(c(e))}})},r}(T),At=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){var t;t=e,n.RuntimeConfig.extend(t)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(vt).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof yt?e.toSearchQuery():e,this.create(gt).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return this.create(Ft)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return this.create(Rt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return this.create(Lt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return this.create(Nt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new ft},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return this.create(jt,"")},enumerable:!0,configurable:!0}),e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),kt=new At;e.spExtractODataId=c,e.spODataEntity=y,e.spODataEntityArray=function(e){return new h(e)},e.SharePointQueryable=T,e.SharePointQueryableInstance=_,e.SharePointQueryableCollection=x,e.SharePointQueryableSecurable=se,e.FileFolderShared=pe,e.SharePointQueryableShareable=ae,e.SharePointQueryableShareableFile=ce,e.SharePointQueryableShareableFolder=de,e.SharePointQueryableShareableItem=le,e.SharePointQueryableShareableWeb=ue,e.AppCatalog=Xe,e.App=ze,e.Field=Ue,e.Fields=Oe,e.File=We,e.Files=Je,e.Folder=be,e.Folders=me,e.SPHttpClient=P,e.Item=ke,e.Items=Ae,e.ItemVersion=qe,e.ItemVersions=Me,e.PagedItemCollection=He,e.NavigationNodes=ct,e.NavigationNode=dt,e.NavigationService=ft,e.List=je,e.Lists=Ee,e.sp=kt,e.SPRest=At,e.RoleDefinitionBindings=te,e.Search=gt,e.SearchQueryBuilder=yt,e.SearchResults=mt,e.SearchBuiltInSourceId=bt,e.SearchSuggest=vt,e.SearchSuggestResult=Pt,e.Site=Ft,e.UtilityMethod=jt,e.WebPartDefinitions=fe,e.WebPartDefinition=ye,e.WebPart=ge,e.Web=Rt,e.ClientSidePage=it,e.CanvasSection=st,e.CanvasControl=at,e.CanvasColumn=ut,e.ClientSideText=lt,e.ClientSideWebpart=pt,e.SocialQuery=Nt,e.MySocialQuery=Et,Object.defineProperty(e,"__esModule",{value:!0})});