Firmin="undefined"==typeof Firmin?{}:Firmin,Firmin.prefix=function(){var i,r,n,t=document.createElement("div"),e=["o","moz","webkit"];for(r=0;r<3;r++)if(i=e[r],t.style.cssText="-"+i+"-transition-property: opacity;","moz"===i?i="Moz":"o"===i&&(i="O"),void 0!==t.style[i+"TransitionProperty"])return t.style.cssText="-"+i.toLowerCase()+"-transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);",n=t.style[i+"Transform"],Firmin.supports3d="string"==typeof n&&0<n.length,i}(),Firmin.Transform=function(i,r){this.ctm=i||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.centre=Firmin.pointToVector(r)||["50%","50%",0]},Firmin.Transform.multiply=function(i,r){var n=[];return n[0]=i[0]*r[0]+i[4]*r[1]+i[8]*r[2]+i[12]*r[3],n[1]=i[1]*r[0]+i[5]*r[1]+i[9]*r[2]+i[13]*r[3],n[2]=i[2]*r[0]+i[6]*r[1]+i[10]*r[2]+i[14]*r[3],n[3]=i[3]*r[0]+i[7]*r[1]+i[11]*r[2]+i[15]*r[3],n[4]=i[0]*r[4]+i[4]*r[5]+i[8]*r[6]+i[12]*r[7],n[5]=i[1]*r[4]+i[5]*r[5]+i[9]*r[6]+i[13]*r[7],n[6]=i[2]*r[4]+i[6]*r[5]+i[10]*r[6]+i[14]*r[7],n[7]=i[3]*r[4]+i[7]*r[5]+i[11]*r[6]+i[15]*r[7],n[8]=i[0]*r[8]+i[4]*r[9]+i[8]*r[10]+i[12]*r[11],n[9]=i[1]*r[8]+i[5]*r[9]+i[9]*r[10]+i[13]*r[11],n[10]=i[2]*r[8]+i[6]*r[9]+i[10]*r[10]+i[14]*r[11],n[11]=i[3]*r[8]+i[7]*r[9]+i[11]*r[10]+i[15]*r[11],n[12]=i[0]*r[12]+i[4]*r[13]+i[8]*r[14]+i[12]*r[15],n[13]=i[1]*r[12]+i[5]*r[13]+i[9]*r[14]+i[13]*r[15],n[14]=i[2]*r[12]+i[6]*r[13]+i[10]*r[14]+i[14]*r[15],n[15]=i[3]*r[12]+i[7]*r[13]+i[11]*r[14]+i[15]*r[15],n},Firmin.Transform.methods=["translate","translateX","translateY","scale","scaleX","scaleY","rotate","skew","skewX","skewY","matrix"],Firmin.Transform.parse=function(i,r){var n,t,e=Firmin.Transform.methods,a={},o=null;for(property in"object"==typeof r&&r.transform&&(n=r.transform.ctm,t=r.transform.centre,o=new Firmin.Transform(n,t)),i)-1!==e.indexOf(property)?(o=o||new Firmin.Transform)[property](i[property]):"origin"===property?(o=o||new Firmin.Transform)[property](i[property]):a[property]=i[property];return{result:o,remainder:a}},Firmin.Transform.prototype.matrix3d=function(i){this.ctm=Firmin.Transform.multiply(this.ctm,i)},Firmin.Transform.prototype.matrix=function(i,r,n,t,e,a){if("object"==typeof i)return this.matrix.apply(this,i);this.matrix3d([i,r,0,0,n,t,0,0,0,0,1,0,e,a,0,1])},Firmin.Transform.prototype.build=function(i){var r,n,t,e=this.centre.join(" "),a=this.ctm;return Firmin.supports3d?r="matrix3d("+a.join(",")+")":(n=a[12],t=a[13],"Moz"===Firmin.prefix&&(n+="px",t+="px"),r="matrix("+[a[0],a[1],a[4],a[5],n,t].join(",")+")"),(i=i||{})[Firmin.prefix+"Transform"]=r,i[Firmin.prefix+"TransformOrigin"]=e,i},Firmin.Transform.prototype.translate=function(i){var r,n,t;"number"==typeof i||"string"==typeof i?n=t=i:(n=(r=Firmin.pointToVector(i))[0],t=r[1],"number"!=typeof n&&(n=parseInt(n,10)||0),"number"!=typeof t&&(t=parseInt(t,10)||0)),this.matrix(1,0,0,1,n,t)},Firmin.Transform.prototype.translateX=function(i){this.translate([i,0])},Firmin.Transform.prototype.translateY=function(i){this.translate([0,i])},Firmin.Transform.prototype.scale=function(i){var r,n,t;"number"==typeof i?n=t=i:("number"!=typeof(n=(r=Firmin.pointToVector(i))[0])&&(n=1),"number"!=typeof(t=r[1])&&(t=1)),this.matrix(n,0,0,t,0,0)},Firmin.Transform.prototype.scaleX=function(i){this.scale([i,1])},Firmin.Transform.prototype.scaleY=function(i){this.scale([1,i])},Firmin.Transform.prototype.skew=function(i){var r,n,t,e=Firmin.Parser.parseAngle,a=Firmin.angleToRadians;"number"==typeof i||"string"==typeof i?n=t=a.apply(null,e(i)):(r=Firmin.pointToVector(i),n=a.apply(null,e(r[0]))||0,t=a.apply(null,e(r[1]))||0),this.matrix(1,Math.tan(t),Math.tan(n),1,0,0)},Firmin.Transform.prototype.skewX=function(i){this.skew([i,0])},Firmin.Transform.prototype.skewY=function(i){this.skew([0,i])},Firmin.Transform.prototype.rotate=function(i){i=Firmin.angleToRadians.apply(null,Firmin.Parser.parseAngle(i)),this.matrix(Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),0,0)},Firmin.Transform.prototype.origin=function(i){var r=Firmin.pointToVector(i);r[0]&&(this.centre[0]=r[0]),r[1]&&(this.centre[1]=r[1]),r[2]&&(this.centre[2]=r[2])},Firmin.Transition=function(){this.properties=["all"],this.duration=["ms",0],this.delay=["ms",0],this.timingFunction="ease"},Firmin.Transition.methods=["properties","timingFunction","duration","delay"],Firmin.Transition.parse=function(i,r){var n,t,e=Firmin.Transition.methods,a={},o=new Firmin.Transition;for(p in i)-1!==e.indexOf(p)?"properties"===p&&"string"==typeof p?o[p]=[i[p]]:"timingFunction"===p&&"string"!=typeof i[p]?o[p]="cubic-bezier("+i[p].join(",")+")":"duration"===p?(n=Firmin.Parser.parseTime(i[p]))&&(o[p]=n):"delay"===p?(t=Firmin.Parser.parseTime(i[p]))&&(o[p]=t):o[p]=i[p]:a[p]=i[p];return{result:o,remainder:a}},Firmin.Transition.prototype.hasDuration=function(){return 0!==this.duration[1]},Firmin.Transition.prototype.getDuration=function(){var i=this.duration;return"s"===i[0]?1e3*i[1]:i[1]},Firmin.Transition.prototype.hasDelay=function(){return 0!==this.delay[1]},Firmin.Transition.prototype.getDelay=function(){var i=this.delay;return"s"===i[0]?1e3*i[1]:i[1]},Firmin.Transition.prototype.build=function(i){return i=i||{},"string"==typeof this.properties?i[Firmin.prefix+"TransitionProperty"]=this.properties:i[Firmin.prefix+"TransitionProperty"]=this.properties.join(", "),i[Firmin.prefix+"TransitionDuration"]=this.duration[1]+this.duration[0],i[Firmin.prefix+"TransitionDelay"]=this.delay[1]+this.delay[0],this.timingFunction&&(i[Firmin.prefix+"TransitionTimingFunction"]=this.timingFunction),i},Firmin.Animation=function(i,r){var n,t;"function"==typeof i.callback&&(this.callback=i.callback),delete i.callback,n=Firmin.Transition.parse(i,r),this.transition=n.result,t=Firmin.Transform.parse(n.remainder,r),this.transform=t.result,this.style=t.remainder},Firmin.Animation.prototype.hasDuration=function(){return this.transition&&this.transition.hasDuration()},Firmin.Animation.prototype.getTotalDuration=function(){return this.transition?this.transition.getDuration()+this.transition.getDelay():0},Firmin.Animation.prototype.exec=function(i){var r,n=this.style;for(r in this.transition&&(n=this.transition.build(n)),this.transform&&(n=this.transform.build(n)),n)i.style[r]=n[r]},Firmin.Animated=function(i){this.element=i,this.operations=[],this.callback=null},Firmin.Animated.prototype.run=function(){var i=this.operations.shift(),r=this;return i?(i.exec(this.element),setTimeout(function(){r.fireCallback(),r.run()},i.getTotalDuration()||1),this.callback=i.callback):this.fired=!0,this},Firmin.Animated.prototype.fireCallback=function(){var i=this.callback;"function"==typeof i&&i.call(null,this.element)},Firmin.Animated.prototype.__animate__=function(i){return this.operations.push(i),this.__lastAnim=i,this.fired&&(this.fired=!1,this.run()),this},Firmin.Animated.prototype.animate=function(i,r,n){return i.duration=r,i.callback=n,this.__animate__(new Firmin.Animation(i))},Firmin.Animated.prototype.animateR=function(i,r,n){return i.duration=r,i.callback=n,this.__animate__(new Firmin.Animation(i,this.__lastAnim))},Firmin.animate=function(i,r,n,t){var e=new Firmin.Animated(i);return e.animate(r,n,t),e.run()},Firmin.animateR=function(i,r,n,t){var e=new Firmin.Animated(i);return e.animateR(r,n,t),e.run()},Firmin.Transform.methods.forEach(function(a){var i=a+"R";Firmin[a]=function(i,r,n,t){var e={};return e[a]=r,Firmin.animate(i,e,n,t)},Firmin[i]=function(i,r,n,t){var e={};return e[a]=r,Firmin.animateR(i,e,n,t)},Firmin.Animated.prototype[a]=function(i,r,n){var t={};return t[a]=i,this.animate(t,r,n)},Firmin.Animated.prototype[i]=function(i,r,n){var t={};return t[a]=i,this.animateR(t,r,n)}}),Firmin.Parser={},Firmin.Parser.NUMBER_PATTERN=/^-?\d+(\.\d+)?/,Firmin.Parser.parseNumeric=function(t,e){return function(r){var i,n;return"number"==typeof r?[e,r]:"string"!=typeof r?null:(i=(n=(r.match(Firmin.Parser.NUMBER_PATTERN)||[""])[0]).length===r.length?e:t.filter(function(i){return r.substr(n.length)===i})[0])&&n?[i,parseFloat(n)]:null}},Firmin.Parser.parseAngle=Firmin.Parser.parseNumeric(["deg","grad","rad","turn"],"deg"),Firmin.Parser.parseTime=Firmin.Parser.parseNumeric(["s","ms"],"s"),Firmin.angleToRadians=function(i,r){var n;switch(i){case"rad":return r;case"deg":n=Math.PI/180;break;case"grad":n=Math.PI/200;break;case"turn":n=2*Math.PI}return n*r},Firmin.pointToVector=function(i){return i?i instanceof Array?i:[i.x,i.y,i.z]:null};