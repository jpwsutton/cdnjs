Firmin={},Firmin.prefix=function(){var r,i,n=document.createElement("div"),t=["o","moz","webkit"];for(i=0;i<3&&(r=t[i],n.style.cssText="-"+r+"-transition-property: opacity;","moz"===r&&(r="Moz"),void 0===n.style[r+"TransitionProperty"]);i++);return r}(),Firmin.CTM=function(r){var i,n;if(this.vector=[1,0,0,1,0,0],"object"==typeof r)for(i=0;i<6;i++)this.vector[i]="number"==typeof(n=r[i])?n:this.vector[i]},Firmin.CTM.KEYS={a:0,b:1,c:2,d:3,e:4,f:5},Firmin.CTM.prototype.get=function(r){return this.vector["string"==typeof r?Firmin.CTM.KEYS[r]:r]},Firmin.CTM.prototype.multiply=function(r){var i=new Array(6),n=this.vector;i[0]=n[0]*r[0]+n[2]*r[1],i[1]=n[1]*r[0]+n[3]*r[1],i[2]=n[0]*r[2]+n[2]*r[3],i[3]=n[1]*r[2]+n[3]*r[3],i[4]=n[0]*r[4]+n[2]*r[5]+n[4],i[5]=n[1]*r[4]+n[3]*r[5]+n[5],this.vector=i},Firmin.CTM.prototype.build=function(){return"matrix("+this.vector.join(",")+")"},Firmin.Transform=function(r,i){this.ctm=new Firmin.CTM(r),this.centre=i||{x:"50%",y:"50%"}},Firmin.Transform.methods=["translate","translateX","translateY","scale","scaleX","scaleY","rotate","skew","skewX","skewY","matrix"],Firmin.Transform.parse=function(r,i){var n,t,e=Firmin.Transform.methods,o={},s=null;for(property in i.transform&&(n=i.transform.toVector(),t=i.transform.getOrigin(),s=new Firmin.Transform(n,t)),r)-1!==e.indexOf(property)?(s=s||new Firmin.Transform)[property](r[property]):"origin"===property?(s=s||new Firmin.Transform)[property](r[property]):o[property]=r[property];return{result:s,remainder:o}},Firmin.Transform.prototype.matrix=function(r){this.ctm.multiply(r)},Firmin.Transform.prototype.toVector=function(){return this.ctm.vector},Firmin.Transform.prototype.getOrigin=function(){return this.centre.x+" "+this.centre.y},Firmin.Transform.prototype.build=function(r){return(r=r||{})[Firmin.prefix+"Transform"]=this.ctm.build(),r[Firmin.prefix+"TransformOrigin"]=this.getOrigin(),r},Firmin.Transform.prototype.translate=function(r){var i,n;"number"==typeof r||"string"==typeof r?n=i=r:(i=r.x,n=r.y,"number"!=typeof i&&(i=parseInt(i,10)||0),"number"!=typeof n&&(n=parseInt(n,10)||0)),this.matrix([1,0,0,1,i,n])},Firmin.Transform.prototype.translateX=function(r){this.translate({x:r})},Firmin.Transform.prototype.translateY=function(r){this.translate({y:r})},Firmin.Transform.prototype.scale=function(r){var i,n;"number"==typeof r?n=i=r:("number"!=typeof(i=r.x)&&(i=1),"number"!=typeof(n=r.y)&&(n=1)),this.matrix([i,0,0,n,0,0])},Firmin.Transform.prototype.scaleX=function(r){this.scale({x:r})},Firmin.Transform.prototype.scaleY=function(r){this.scale({y:r})},Firmin.Transform.prototype.skew=function(r){var i=Firmin.Parser.parseAngle,n=Firmin.angleToRadians,t=0,e=0;"number"!=typeof r.x&&"string"!=typeof r.x||(t=n.apply(null,i(r.x))),"number"!=typeof r.y&&"string"!=typeof r.y||(e=n.apply(null,i(r.y))),this.matrix([1,Math.tan(e),Math.tan(t),1,0,0])},Firmin.Transform.prototype.skewX=function(r){this.skew({x:r})},Firmin.Transform.prototype.skewY=function(r){this.skew({y:r})},Firmin.Transform.prototype.rotate=function(r){r=Firmin.angleToRadians.apply(null,Firmin.Parser.parseAngle(r)),this.matrix([Math.cos(r),Math.sin(r),-Math.sin(r),Math.cos(r),0,0])},Firmin.Transform.prototype.origin=function(r){r.x&&(this.centre.x=r.x),r.y&&(this.centre.y=r.y)},Firmin.Transition=function(){this.properties=["all"],this.duration=["s",0],this.delay=["s",0],this.timingFunction="ease"},Firmin.Transition.methods=["properties","timingFunction","duration","delay"],Firmin.Transition.parse=function(r,i){var n,t,e=Firmin.Transition.methods,o={},s=new Firmin.Transition;for(p in r)-1!==e.indexOf(p)?"properties"===p&&"string"==typeof p?s[p]=[r[p]]:"timingFunction"===p&&"string"!=typeof r[p]?s[p]="cubic-bezier("+r[p].join(",")+")":"duration"===p?(n=Firmin.Parser.parseTime(r[p]))&&(s[p]=n):"delay"===p?(t=Firmin.Parser.parseTime(r[p]))&&(s[p]=t):s[p]=r[p]:o[p]=r[p];return{result:s,remainder:o}},Firmin.Transition.prototype.hasDuration=function(){return 0!==this.duration[1]},Firmin.Transition.prototype.getDuration=function(){var r=this.duration;return 0===r[1]?0:r.reverse().join("")},Firmin.Transition.prototype.hasDelay=function(){return 0!==this.delay[1]},Firmin.Transition.prototype.getDelay=function(){return 0===this.delay[1]?0:duration.reverse().join("")},Firmin.Transition.prototype.build=function(r){return r=r||{},"string"==typeof this.properties?r[Firmin.prefix+"TransitionProperty"]=this.properties:r[Firmin.prefix+"TransitionProperty"]=this.properties.join(", "),r[Firmin.prefix+"TransitionDuration"]=this.getDuration(),r[Firmin.prefix+"TransitionDelay"]=this.getDelay(),this.timingFunction&&(r[Firmin.prefix+"TransitionTimingFunction"]=this.timingFunction),r},Firmin.Animation=function(r,i){var n,t;n=Firmin.Transition.parse(r,i),this.transition=n.result,t=Firmin.Transform.parse(n.remainder,i),this.transform=t.result,this.style=t.remainder},Firmin.Animation.prototype.hasDuration=function(){return this.transition&&this.transition.hasDuration()},Firmin.Animation.prototype.exec=function(r){var i,n=this.style;for(i in this.transition&&(n=this.transition.build(n)),this.transform&&(n=this.transform.build(n)),n)r.style[i]=n[i]},Firmin.Animated=function(r){var i=this;this.element=r,this.operations=[],this.index=0,this.element.addEventListener(Firmin.prefix+"TransitionEnd",function(){i.index<i.operations.length&&i.run()},!1)},Firmin.Animated.prototype.run=function(){var r=this.operations[this.index++],i=this.operations[this.index],n=this;return r.exec(this.element),i&&!r.hasDuration()&&setTimeout(function(){n.run()},1),this},Firmin.Animated.prototype.animate=function(r,i){var n=this.operations[this.operations.length-1]||{};return-1===["string","number"].indexOf(typeof r.duration)&&(r.duration=i),this.operations.push(new Firmin.Animation(r,n)),this},Firmin.animate=function(r,i,n){var t=new Firmin.Animated(r);return-1===["string","number"].indexOf(typeof i.duration)&&(i.duration=n),t.animate(i),t.run()},Firmin.Transform.methods.forEach(function(e){Firmin[e]=function(r,i,n){var t={};return t[e]=i,Firmin.animate(r,t,n)},Firmin.Animated.prototype[e]=function(r,i){var n={};return n[e]=r,this.animate(n,i)}}),Firmin.Parser={},Firmin.Parser.NUMBER_PATTERN=/^-?\d+(\.\d+)?/,Firmin.Parser.parseNumeric=function(t,e){return function(i){var r,n;return"number"==typeof i?[e,i]:"string"!=typeof i?null:(r=(n=(i.match(Firmin.Parser.NUMBER_PATTERN)||[""])[0]).length===i.length?e:t.filter(function(r){return i.substr(n.length)===r})[0])&&n?[r,parseFloat(n)]:null}},Firmin.Parser.parseAngle=Firmin.Parser.parseNumeric(["deg","grad","rad","turn"],"deg"),Firmin.Parser.parseTime=Firmin.Parser.parseNumeric(["s","ms"],"s"),Firmin.angleToRadians=function(r,i){var n;switch(r){case"rad":return i;case"deg":n=Math.PI/180;break;case"grad":n=Math.PI/200;break;case"turn":n=2*Math.PI}return n*i};